---
title: "Preprocessing Data"
author:
- Lourdes Sofía Elizondo Guajardo
- Daniela Diaz Delgado
- Bernardo Ortega Chávez
- Gabriel González Bataller
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
    toc_depth: 4
    number_sections: yes
  html_document:
    toc: yes
    toc_depth: '4'
    df_print: paged
    always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("gmodels")
library("ggplot2")
library("pROC")
library("rpart")
library("rattle")
library("rpart.plot")
library("tinytex")
library("kableExtra")
library("ROSE")
library("tibble")
library("bitops")
library("tidyquant")
library("knitr")
library("plotly")
library("Sim.DiffProc")
library("readxl")
library("usethis")
library("curl")
library("dplyr")
library("tidyr")
library("scales")
library("RColorBrewer")
library("forcats")
library("ggrepel")
library("gridExtra")
library('tseries')
library("quantmod")
library("urca")
library("fpp2")
library('feasts')
library('features')
library('fabletools')
```

# National Data Set

## Loading and visualizing the data

```{r}
BDT2 <- read_excel("BDF NACIONAL.xlsx")
DATA.ts <- ts(BDT2, start = c(2005, 2), frequency = 4)

CV <- DATA.ts[ ,1]
INPC_AB <- DATA.ts[ ,2]
INPC_SERV <- DATA.ts[ ,3]
INPC_T<- DATA.ts[ ,4]
INPC_E <- DATA.ts[ ,5]
IPV <- DATA.ts[ ,6]
IPC_SUB <- DATA.ts[ ,7]
REMESAS <- DATA.ts[ ,8]
INT <- DATA.ts[ ,9]
CONF <- DATA.ts[ ,10]
M1 <- DATA.ts[ ,11]
DEBT <- DATA.ts[ ,12]
EX <- DATA.ts[ ,13]
PIB <- DATA.ts[,14]
DESEMPLEO <- DATA.ts[,15]
IGAE <- DATA.ts[,16]

head(DATA.ts)

# PLOTS
INPC_to_IPC_SUB <- ts(cbind(CV,INPC_AB,INPC_SERV,INPC_T,INPC_E,IPC_SUB),start=c(2005,2),frequency=4)
IPV_to_EX <- ts(cbind(CV, IPV, REMESAS, INT, CONF, M1, DEBT, EX),start=c(2005,2),frequency=4)
DESEMPLEO_PIB_IGAE <- ts(cbind(CV, DESEMPLEO, PIB, IGAE),start=c(2005,2),frequency=4)
plot(INPC_to_IPC_SUB, cex.lab=0.7)
plot(IPV_to_EX, cex.lab=0.7)
plot(DESEMPLEO_PIB_IGAE, cex.lab=0.7)
```

## Correlation

```{r}
# Matrix
round(cor(DATA.ts), 2)
```

We filtered the coefficients to only get those greater than 0.5:

```{r}
# Filtered data
cor_mat <- cor(DATA.ts)
cor_mat[!lower.tri(cor_mat)] <- NA # remove diagonal and redundant values
data.frame( cor_mat) %>%
              rownames_to_column() %>%
              gather(key="variable", value="correlation", -rowname) %>%
              filter(abs(correlation) > 0.5)
```
We will have to choose the variables that minimize the AIC further on.

## Stationarity

With a standard dickey fuller test we checked for stationary and for all cases the test-statistic is smaller than the critical value at a 99% confidence level. This means that all variables are stationary. This was expected given that all variables are variations and given the time series graphs analyzed before.

```{r}
CV.DF=ur.df(CV, type="trend",lags=0)
summary(CV.DF)

INPC_AB.DF=ur.df(INPC_AB, type = "trend", lags = 0)
summary(INPC_AB.DF)

INPC_SERV.DF=ur.df(INPC_SERV, type = "trend", lags = 0)
summary(INPC_SERV.DF)

INPC_T.DF=ur.df(INPC_T, type = "trend", lags = 0)
summary(INPC_T.DF)

INPC_E.DF=ur.df(INPC_E, type = "trend", lags = 0)
summary(INPC_E.DF)

IPV.DF=ur.df(IPV, type = "trend", lags = 0)
summary(IPV.DF)

IPC_SUB.DF=ur.df(IPC_SUB, type = "trend", lags = 0)
summary(IPC_SUB.DF)

REMESAS.DF=ur.df(REMESAS, type = "trend", lags = 0)
summary(REMESAS.DF)

INT.DF=ur.df(INT, type = "trend", lags = 0)
summary(INT.DF)

CONF.DF=ur.df(CONF, type = "trend", lags = 0)
summary(CONF.DF)

M1.DF=ur.df(M1, type = "trend", lags = 0)
summary(M1.DF)

DEBT.DF=ur.df(DEBT, type = "trend", lags = 0)
summary(DEBT.DF)

EX.DF=ur.df(EX, type = "trend", lags = 0)
summary(EX.DF)

PIB.DF=ur.df(PIB, type="trend",lags=0)
summary(PIB.DF)

DESEMPLEO.DF=ur.df(DESEMPLEO, type = "trend", lags = 0)
summary(DESEMPLEO.DF)

IGAE.DF=ur.df(IGAE, type = "trend", lags = 0)
summary(IGAE.DF)
```

# Estimating lags 

Given that each variable may have a different lagged effect on the default rate (CV) we perform individual ARIMAs of each stationary variable with CV with different *lags*, to determine which amount of lags gives us the minimum AIC. We do not, however, compute an ARIMA with zero lags, because one would not have the necessary inputs to run the ARIMA and forecast. Thus the comparison below is between: AIC with 1 lags, with 2 lags and with 3 lags.

We  chose the right amount of lags for each case, minimizing AIC.

```{r}
# INPC_AB
INPC_AB_v<-as.vector(INPC_AB)
CV_v<-as.vector(CV)
INPC_AB_v2<-cbind(INPC_AB_v,CV_v)
colnames(INPC_AB_v2)<-c("INPC_AB","CV")
a<- lag(INPC_AB_v,0)
x<- lag(INPC_AB_v,1)
y<- lag(INPC_AB_v,2)
z<- lag(INPC_AB_v,3)
INPC_AB_lags <- cbind(x,y,z)

fitINPC_AB1 <- auto.arima(INPC_AB_v2[4: 63,2], xreg=INPC_AB_lags[4: 63,1], d=0)
fitINPC_AB2 <- auto.arima(INPC_AB_v2[4: 63,2], xreg=INPC_AB_lags[4: 63,1:2], d=0)
fitINPC_AB3 <- auto.arima(INPC_AB_v2[4: 63,2], xreg=INPC_AB_lags[4: 63,1:3], d=0)
AIC_INPC_AB <- cbind(fitINPC_AB1$aic,fitINPC_AB2$aic,fitINPC_AB3$aic)
colnames(AIC_INPC_AB)<-c("1 lag","2 lags", "3 lags")

# INPC_SERV
INPC_SERV_v<-as.vector(INPC_SERV)
CV_v<-as.vector(CV)
INPC_SERV_v2<-cbind(INPC_SERV_v,CV_v)
colnames(INPC_SERV_v2)<-c("INPC_SERV","CV")
a<- lag(INPC_SERV_v,0)
x<- lag(INPC_SERV_v,1)
y<- lag(INPC_SERV_v,2)
z<- lag(INPC_SERV_v,3)
INPC_SERV_lags <- cbind(x,y,z)
fitINPC_SERV1 <- auto.arima(INPC_SERV_v2[4: 63,2], xreg=INPC_SERV_lags[4: 63,1], d=0)
fitINPC_SERV2 <- auto.arima(INPC_SERV_v2[4: 63,2], xreg=INPC_SERV_lags[4: 63,1:2], d=0)
fitINPC_SERV3 <- auto.arima(INPC_SERV_v2[4: 63,2], xreg=INPC_SERV_lags[4: 63,1:3], d=0)
AIC_INPC_SERV <- cbind(fitINPC_SERV1$aic,fitINPC_SERV2$aic,fitINPC_SERV3$aic)
colnames(AIC_INPC_SERV)<-c("1 lag","2 lags", "3 lags")

# INPC_T
INPC_T_v<-as.vector(INPC_T)
CV_v<-as.vector(CV)
INPC_T_v2<-cbind(INPC_T_v,CV_v)
colnames(INPC_T_v2)<-c("INPC_T","CV")
a<- lag(INPC_T_v,0)
x<- lag(INPC_T_v,1)
y<- lag(INPC_T_v,2)
z<- lag(INPC_T_v,3)
INPC_T_lags <- cbind(x,y,z)
fitINPC_T1 <- auto.arima(INPC_T_v2[4: 63,2], xreg=INPC_T_lags[4: 63,1], d=0)
fitINPC_T2 <- auto.arima(INPC_T_v2[4: 63,2], xreg=INPC_T_lags[4: 63,1:2], d=0)
fitINPC_T3 <- auto.arima(INPC_T_v2[4: 63,2], xreg=INPC_T_lags[4: 63,1:3], d=0)
AIC_INPC_T <- cbind(fitINPC_T1$aic,fitINPC_T2$aic,fitINPC_T3$aic)
colnames(AIC_INPC_T)<-c("1 lag","2 lags", "3 lags")

# INPC_E
INPC_E_v<-as.vector(INPC_E)
CV_v<-as.vector(CV)
INPC_E_v2<-cbind(INPC_E_v,CV_v)
colnames(INPC_E_v2)<-c("INPC_E","CV")
a<- lag(INPC_E_v,0)
x<- lag(INPC_E_v,1)
y<- lag(INPC_E_v,2)
z<- lag(INPC_E_v,3)
INPC_E_lags <- cbind(x,y,z)
fitINPC_E1 <- auto.arima(INPC_E_v2[4: 63,2], xreg=INPC_E_lags[4: 63,1], d=0)
fitINPC_E2 <- auto.arima(INPC_E_v2[4: 63,2], xreg=INPC_E_lags[4: 63,1:2], d=0)
fitINPC_E3 <- auto.arima(INPC_E_v2[4: 63,2], xreg=INPC_E_lags[4: 63,1:3], d=0)
AIC_INPC_E <- cbind(fitINPC_E1$aic,fitINPC_E2$aic,fitINPC_E3$aic)
colnames(AIC_INPC_E)<-c("1 lag","2 lags", "3 lags")

# IPV
IPV_v<-as.vector(IPV)
CV_v<-as.vector(CV)
IPV_v2<-cbind(IPV_v,CV_v)
colnames(IPV_v2)<-c("IPV","CV")
a<- lag(IPV_v,0)
x<- lag(IPV_v,1)
y<- lag(IPV_v,2)
z<- lag(IPV_v,3)
IPV_lags <- cbind(x,y,z)
fitIPV1 <- auto.arima(IPV_v2[4: 63,2], xreg=IPV_lags[4: 63,1], d=0)
fitIPV2 <- auto.arima(IPV_v2[4: 63,2], xreg=IPV_lags[4: 63,1:2], d=0)
fitIPV3 <- auto.arima(IPV_v2[4: 63,2], xreg=IPV_lags[4: 63,1:3], d=0)
AIC_IPV <- cbind(fitIPV1$aic,fitIPV2$aic,fitIPV3$aic)
colnames(AIC_IPV)<-c("1 lag","2 lags", "3 lags")

# IPC_SUB
IPC_SUB_v<-as.vector(IPC_SUB)
CV_v<-as.vector(CV)
IPC_SUB_v2<-cbind(IPC_SUB_v,CV_v)
colnames(IPC_SUB_v2)<-c("IPC_SUB","CV")
a<- lag(IPC_SUB_v,0)
x<- lag(IPC_SUB_v,1)
y<- lag(IPC_SUB_v,2)
z<- lag(IPC_SUB_v,3)
IPC_SUB_lags <- cbind(x,y,z)
fitIPC_SUB1 <- auto.arima(IPC_SUB_v2[4: 63,2], xreg=IPC_SUB_lags[4: 63,1], d=0)
fitIPC_SUB2 <- auto.arima(IPC_SUB_v2[4: 63,2], xreg=IPC_SUB_lags[4: 63,1:2], d=0)
fitIPC_SUB3 <- auto.arima(IPC_SUB_v2[4: 63,2], xreg=IPC_SUB_lags[4: 63,1:3], d=0)
AIC_IPC_SUB <- cbind(fitIPC_SUB1$aic,fitIPC_SUB2$aic,fitIPC_SUB3$aic)
colnames(AIC_IPC_SUB)<-c("1 lag","2 lags", "3 lags")

# REMESAS
REMESAS_v<-as.vector(REMESAS)
CV_v<-as.vector(CV)
REMESAS_v2<-cbind(REMESAS_v,CV_v)
colnames(REMESAS_v2)<-c("REMESAS","CV")
a<- lag(REMESAS_v,0)
x<- lag(REMESAS_v,1)
y<- lag(REMESAS_v,2)
z<- lag(REMESAS_v,3)
REMESAS_lags <- cbind(x,y,z)
fitREMESAS1 <- auto.arima(REMESAS_v2[4: 63,2], xreg=REMESAS_lags[4: 63,1], d=0)
fitREMESAS2 <- auto.arima(REMESAS_v2[4: 63,2], xreg=REMESAS_lags[4: 63,1:2], d=0)
fitREMESAS3 <- auto.arima(REMESAS_v2[4: 63,2], xreg=REMESAS_lags[4: 63,1:3], d=0)
AIC_REMESAS <- cbind(fitREMESAS1$aic,fitREMESAS2$aic,fitREMESAS3$aic)
colnames(AIC_REMESAS)<-c("1 lag","2 lags", "3 lags")

# INT
INT_v<-as.vector(INT)
CV_v<-as.vector(CV)
INT_v2<-cbind(INT_v,CV_v)
colnames(INT_v2)<-c("INT","CV")
a<- lag(INT_v,0)
x<- lag(INT_v,1)
y<- lag(INT_v,2)
z<- lag(INT_v,3)
INT_lags <- cbind(x,y,z)
fitINT1 <- auto.arima(INT_v2[4: 63,2], xreg=INT_lags[4: 63,1], d=0)
fitINT2 <- auto.arima(INT_v2[4: 63,2], xreg=INT_lags[4: 63,1:2], d=0)
fitINT3 <- auto.arima(INT_v2[4: 63,2], xreg=INT_lags[4: 63,1:3], d=0)
AIC_INT <- cbind(fitINT1$aic,fitINT2$aic,fitINT3$aic)
colnames(AIC_INT)<-c("1 lag","2 lags", "3 lags")

# CONF
CONF_v<-as.vector(CONF)
CV_v<-as.vector(CV)
CONF_v2<-cbind(CONF_v,CV_v)
colnames(CONF_v2)<-c("CONF","CV")
a<- lag(CONF_v,0)
x<- lag(CONF_v,1)
y<- lag(CONF_v,2)
z<- lag(CONF_v,3)
CONF_lags <- cbind(x,y,z)
fitCONF1 <- auto.arima(CONF_v2[4: 63,2], xreg=CONF_lags[4: 63,1], d=0)
fitCONF2 <- auto.arima(CONF_v2[4: 63,2], xreg=CONF_lags[4: 63,1:2], d=0)
fitCONF3 <- auto.arima(CONF_v2[4: 63,2], xreg=CONF_lags[4: 63,1:3], d=0)
AIC_CONF <- cbind(fitCONF1$aic,fitCONF2$aic,fitCONF3$aic)
colnames(AIC_CONF)<-c("1 lag","2 lags", "3 lags")

# M1
M1_v<-as.vector(M1)
CV_v<-as.vector(CV)
M1_v2<-cbind(M1_v,CV_v)
colnames(M1_v2)<-c("M1","CV")
a<- lag(M1_v,0)
x<- lag(M1_v,1)
y<- lag(M1_v,2)
z<- lag(M1_v,3)
M1_lags <- cbind(x,y,z)
fitM11 <- auto.arima(M1_v2[4: 63,2], xreg=M1_lags[4: 63,1], d=0)
fitM12 <- auto.arima(M1_v2[4: 63,2], xreg=M1_lags[4: 63,1:2], d=0)
fitM13 <- auto.arima(M1_v2[4: 63,2], xreg=M1_lags[4: 63,1:3], d=0)
AIC_M1 <- cbind(fitM11$aic,fitM12$aic,fitM13$aic)
colnames(AIC_M1)<-c("1 lag","2 lags", "3 lags")

# DEBT
DEBT_v<-as.vector(DEBT)
CV_v<-as.vector(CV)
DEBT_v2<-cbind(DEBT_v,CV_v)
colnames(DEBT_v2)<-c("DEBT","CV")
a<- lag(DEBT_v,0)
x<- lag(DEBT_v,1)
y<- lag(DEBT_v,2)
z<- lag(DEBT_v,3)
DEBT_lags <- cbind(x,y,z)
fitDEBT1 <- auto.arima(DEBT_v2[4: 63,2], xreg=DEBT_lags[4: 63,1], d=0)
fitDEBT2 <- auto.arima(DEBT_v2[4: 63,2], xreg=DEBT_lags[4: 63,1:2], d=0)
fitDEBT3 <- auto.arima(DEBT_v2[4: 63,2], xreg=DEBT_lags[4: 63,1:3], d=0)
AIC_DEBT <- cbind(fitDEBT1$aic,fitDEBT2$aic,fitDEBT3$aic)
colnames(AIC_DEBT)<-c("1 lag","2 lags", "3 lags")

# EX
EX_v<-as.vector(EX)
CV_v<-as.vector(CV)
EX_v2<-cbind(EX_v,CV_v)
colnames(EX_v2)<-c("EX","CV")
a<- lag(EX_v,0)
x<- lag(EX_v,1)
y<- lag(EX_v,2)
z<- lag(EX_v,3)
EX_lags <- cbind(x,y,z)
fitEX1 <- auto.arima(EX_v2[4: 63,2], xreg=EX_lags[4: 63,1], d=0)
fitEX2 <- auto.arima(EX_v2[4: 63,2], xreg=EX_lags[4: 63,1:2], d=0)
fitEX3 <- auto.arima(EX_v2[4: 63,2], xreg=EX_lags[4: 63,1:3], d=0)
AIC_EX <- cbind(fitEX1$aic,fitEX2$aic,fitEX3$aic)
colnames(AIC_EX)<-c("1 lag","2 lags", "3 lags")

# PIB
PIB_v<-as.vector(PIB)
CV_v<-as.vector(CV)
PIB_v2<-cbind(PIB_v,CV_v)
colnames(PIB_v2)<-c("PIB","CV")
a<- lag(PIB_v,0)
x<- lag(PIB_v,1)
y<- lag(PIB_v,2)
z<- lag(PIB_v,3)
PIB_lags <- cbind(x,y,z)
fitPIB1 <- auto.arima(PIB_v2[4: 63,2], xreg=PIB_lags[4: 63,1], d=0)
fitPIB2 <- auto.arima(PIB_v2[4: 63,2], xreg=PIB_lags[4: 63,1:2], d=0)
fitPIB3 <- auto.arima(PIB_v2[4: 63,2], xreg=PIB_lags[4: 63,1:3], d=0)
AIC_PIB <- cbind(fitPIB1$aic,fitPIB2$aic,fitPIB3$aic)
colnames(AIC_PIB)<-c("1 lag","2 lags", "3 lags")

# DESEMPLEO
DESEMPLEO_v<-as.vector(DESEMPLEO)
CV_v<-as.vector(CV)
DESEMPLEO_v2<-cbind(DESEMPLEO_v,CV_v)
colnames(DESEMPLEO_v2)<-c("DESEMPLEO","CV")
a<- lag(DESEMPLEO_v,0)
x<- lag(DESEMPLEO_v,1)
y<- lag(DESEMPLEO_v,2)
z<- lag(DESEMPLEO_v,3)
DESEMPLEO_lags <- cbind(x,y,z)
fitDESEMPLEO1 <- auto.arima(DESEMPLEO_v2[4: 63,2], xreg=DESEMPLEO_lags[4: 63,1], d=0)
fitDESEMPLEO2 <- auto.arima(DESEMPLEO_v2[4: 63,2], xreg=DESEMPLEO_lags[4: 63,1:2], d=0)
fitDESEMPLEO3 <- auto.arima(DESEMPLEO_v2[4: 63,2], xreg=DESEMPLEO_lags[4: 63,1:3], d=0)
AIC_DESEMPLEO <- cbind(fitDESEMPLEO1$aic,fitDESEMPLEO2$aic,fitDESEMPLEO3$aic)
colnames(AIC_DESEMPLEO)<-c("1 lag","2 lags", "3 lags")

# IGAE
IGAE_v<-as.vector(IGAE)
CV_v<-as.vector(CV)
IGAE_v2<-cbind(IGAE_v,CV_v)
colnames(IGAE_v2)<-c("IGAE","CV")
a<- lag(IGAE_v,0)
x<- lag(IGAE_v,1)
y<- lag(IGAE_v,2)
z<- lag(IGAE_v,3)
IGAE_lags <- cbind(x,y,z)
fitIGAE1 <- auto.arima(IGAE_v2[4: 63,2], xreg=IGAE_lags[4: 63,1], d=0)
fitIGAE2 <- auto.arima(IGAE_v2[4: 63,2], xreg=IGAE_lags[4: 63,1:2], d=0)
fitIGAE3 <- auto.arima(IGAE_v2[4: 63,2], xreg=IGAE_lags[4: 63,1:3], d=0)
AIC_IGAE <- cbind(fitIGAE1$aic,fitIGAE2$aic,fitIGAE3$aic)
colnames(AIC_IGAE)<-c("1 lag","2 lags", "3 lags")
```

```{r}
AICs<-rbind(AIC_INPC_AB, AIC_INPC_SERV, AIC_INPC_T, AIC_INPC_E, AIC_IPV, AIC_IPC_SUB, AIC_REMESAS, AIC_INT, AIC_CONF, AIC_M1, AIC_DEBT, AIC_EX, AIC_PIB, AIC_DESEMPLEO, AIC_IGAE)
rownames(AICs)<-c("INPC_AB", "INPC_SERV", "INPC_T", "INPC_E", "IPV", "IPC_SUB", "REMESAS", "INT", "CONF", "M1", "DEBT", "EX", "PIB", "DESEMPLEO", "IGAE")
AICs
```

Analyzing the results above, we created a new excel file (called BDF2) where for each variable we included:

1. The variable with 1 lag
2. The subsequent lagged variables until the minimum AIC is reached

For example, for INPC_AB, the number of lags that minimizes AIC is three. In this case, we include INPC_AB (1 lag), INPC_AB_2 (2 lags) and INPC_AB_3 (3 lags). Like so:

```{r}
BDF2 <- read_excel("BDF NACIONAL LAGS.xlsx")
BDF2 <- ts(BDF2, start = c(2006,1),frequency = 4)
head(BDF2)
```

# Models & hypothesis

Now, with all variables stationary and with the right amount of lags, we test *different combinations of variables*, to remove those that do not contribute to the minimization of AIC. (Note that the significance of the coefficients is not very relevant for the forecast model and for the scope of this investigation)

We did this in accordance to the next hypothesis and in line with what literature in similar studies has done:

## Hypothesis

### Borrower's ability to pay

(explain) 

### Willingness of consumers to pay their mortgage

(explain) 

### Confidence and cost indicators for home purchase

(explain)

```{r}
training_set<-ts(BDF2[1:59,],start = c(2006,1),frequency=4)
```

## Testing models

**H1**
23:24 PIB
26: IGAE

**H2**
2:7 INPC_AB a T 
8: INPC_E
10:12 IPC_SUB

**CONSTANT**
13:15 REMESAS
9: IPV
25: DESEMPLEO

**VARIABLE**
18:20 M1
17: CONF
27: EX
21:22 DEBT
16: INT

Model 1: 25,13:15,9, 23:24,  2:7      + variable
Model 2: 25,13:15,9, 23:24,  8,10:12  + variable
Model 3: 25,13:15,9, 26,     2:7      + variable
Model 4: 25,13:15,9, 26,     8,10:12  + variable

```{r}
# Modelo 1
modelo_1.1 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 27, 21:22, 16)])
modelo_1.2 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 27, 21:22)])
modelo_1.3 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 27, 16)])
modelo_1.4 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 27)])
modelo_1.5 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 21:22, 16)])
modelo_1.6 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 21:22)])
modelo_1.7 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17, 16)])
modelo_1.8 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 17)])
modelo_1.9 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 27, 21:22, 16)])
modelo_1.10 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 27, 21:22)])
modelo_1.11 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 27, 16)])
modelo_1.12 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 27)])
modelo_1.13 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 21:22, 16)])
modelo_1.14 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 21:22)])
modelo_1.15 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20, 16)])
modelo_1.16 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 18:20)])
modelo_1.17 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 27, 21:22, 16)])
modelo_1.18 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 27, 21:22)])
modelo_1.19 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 27, 16)])
modelo_1.20 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 27)])
modelo_1.21 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 21:22, 16)])
modelo_1.22 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 21:22)])
modelo_1.23 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17, 16)])
modelo_1.24 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 17)])
modelo_1.25 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 27, 21:22, 16)])
modelo_1.26 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 27, 21:22)])
modelo_1.27 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 27, 16)])
modelo_1.28 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 27)])
modelo_1.29 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 21:22, 16)])
modelo_1.30 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 21:22)])
modelo_1.31 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7, 16)])
modelo_1.32 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  2:7)])
```

```{r}
# Modelo 2
modelo_2.1 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 27, 21:22, 16)])
modelo_2.2 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 27, 21:22)])
modelo_2.3 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 27, 16)])
modelo_2.4 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 27)])
modelo_2.5 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 21:22, 16)])
modelo_2.6 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 21:22)])
modelo_2.7 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17, 16)])
modelo_2.8 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17)])
modelo_2.9 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 27, 21:22, 16)])
modelo_2.10 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 27, 21:22)])
modelo_2.11 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 27, 16)])
modelo_2.12 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 27)])
modelo_2.13 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 21:22, 16)])
modelo_2.14 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 21:22)])
modelo_2.15 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 16)])
modelo_2.16 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 18:20)])
modelo_2.17 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 27, 21:22, 16)])
modelo_2.18 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 27, 21:22)])
modelo_2.19 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 27, 16)])
modelo_2.20 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 27)])
modelo_2.21 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 21:22, 16)])
modelo_2.22 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 21:22)])
modelo_2.23 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17, 16)])
modelo_2.24 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 17)])
modelo_2.25 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 27, 21:22, 16)])
modelo_2.26 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 27, 21:22)])
modelo_2.27 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 27, 16)])
modelo_2.28 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 27)])
modelo_2.29 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 21:22, 16)])
modelo_2.30 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 21:22)])
modelo_2.31 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12, 16)])
modelo_2.32 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 23:24,  8, 10:12)])
```

```{r}
# Modelo 3
modelo_3.1 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 27, 21:22, 16)])
modelo_3.2 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 27, 21:22)])
modelo_3.3 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 27, 16)])
modelo_3.4 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 27)])
modelo_3.5 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 21:22, 16)])
modelo_3.6 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 21:22)])
modelo_3.7 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17, 16)])
modelo_3.8 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 17)])
modelo_3.9 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 27, 21:22, 16)])
modelo_3.10 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 27, 21:22)])
modelo_3.11 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 27, 16)])
modelo_3.12 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 27)])
modelo_3.13 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 21:22, 16)])
modelo_3.14 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 21:22)])
modelo_3.15 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20, 16)])
modelo_3.16 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 18:20)])
modelo_3.17 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 27, 21:22, 16)])
modelo_3.18 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 27, 21:22)])
modelo_3.19 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 27, 16)])
modelo_3.20 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 27)])
modelo_3.21 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 21:22, 16)])
modelo_3.22 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 21:22)])
modelo_3.23 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17, 16)])
modelo_3.24 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 17)])
modelo_3.25 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 27, 21:22, 16)])
modelo_3.26 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 27, 21:22)])
modelo_3.27 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 27, 16)])
modelo_3.28 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 27)])
modelo_3.29 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 21:22, 16)])
modelo_3.30 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 21:22)])
modelo_3.31 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7, 16)])
modelo_3.32 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  2:7)])
```

```{r}
# Modelo 4
modelo_4.1 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 27, 21:22, 16)])
modelo_4.2 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 27, 21:22)])
modelo_4.3 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 27, 16)])
modelo_4.4 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 27)])
modelo_4.5 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 21:22, 16)])
modelo_4.6 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 21:22)])
modelo_4.7 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17, 16)])
modelo_4.8 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 17)])
modelo_4.9 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 27, 21:22, 16)])
modelo_4.10 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 27, 21:22)])
modelo_4.11 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 27, 16)])
modelo_4.12 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 27)])
modelo_4.13 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 21:22, 16)])
modelo_4.14 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 21:22)])
modelo_4.15 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20, 16)])
modelo_4.16 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 18:20)])
modelo_4.17 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 27, 21:22, 16)])
modelo_4.18 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 27, 21:22)])
modelo_4.19 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 27, 16)])
modelo_4.20 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 27)])
modelo_4.21 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 21:22, 16)])
modelo_4.22 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 21:22)])
modelo_4.23 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17, 16)])
modelo_4.24 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 17)])
modelo_4.25 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 27, 21:22, 16)])
modelo_4.26 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 27, 21:22)])
modelo_4.27 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 27, 16)])
modelo_4.28 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 27)])
modelo_4.29 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 21:22, 16)])
modelo_4.30 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 21:22)])
modelo_4.31 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12, 16)])
modelo_4.32 <- auto.arima(training_set[,"CV"],
                         xreg=training_set[,c(25,13:15,9, 26,  8, 10:12)])
```

```{r}
#AIC comparison
AICs_modelo1<-rbind(modelo_1.1$aic,modelo_1.2$aic,modelo_1.3$aic,modelo_1.4$aic,modelo_1.5$aic,modelo_1.6$aic,modelo_1.7$aic,modelo_1.8$aic,modelo_1.9$aic,modelo_1.10$aic,modelo_1.11$aic,modelo_1.12$aic,modelo_1.13$aic,modelo_1.14$aic,modelo_1.15$aic,modelo_1.16$aic,modelo_1.17$aic,modelo_1.18$aic,modelo_1.19$aic,modelo_1.20$aic,modelo_1.21$aic,modelo_1.22$aic,modelo_1.23$aic,modelo_1.24$aic,modelo_1.25$aic,modelo_1.26$aic,modelo_1.27$aic,modelo_1.28$aic,modelo_1.29$aic,modelo_1.30$aic,modelo_1.31$aic,modelo_1.32$aic)

AICs_modelo2<-rbind(modelo_2.1$aic,modelo_2.2$aic,modelo_2.3$aic,modelo_2.4$aic,modelo_2.5$aic,modelo_2.6$aic,modelo_2.7$aic,modelo_2.8$aic,modelo_2.9$aic,modelo_2.10$aic,modelo_2.11$aic,modelo_2.12$aic,modelo_2.13$aic,modelo_2.14$aic,modelo_2.15$aic,modelo_2.16$aic,modelo_2.17$aic,modelo_2.18$aic,modelo_2.19$aic,modelo_2.20$aic,modelo_2.21$aic,modelo_2.22$aic,modelo_2.23$aic,modelo_2.24$aic,modelo_2.25$aic,modelo_2.26$aic,modelo_2.27$aic,modelo_2.28$aic,modelo_2.29$aic,modelo_2.30$aic,modelo_2.31$aic,modelo_2.32$aic)

AICs_modelo3<-rbind(modelo_3.1$aic,modelo_3.2$aic,modelo_3.3$aic,modelo_3.4$aic,modelo_3.5$aic,modelo_3.6$aic,modelo_3.7$aic,modelo_3.8$aic,modelo_3.9$aic,modelo_3.10$aic,modelo_3.11$aic,modelo_3.12$aic,modelo_3.13$aic,modelo_3.14$aic,modelo_3.15$aic,modelo_3.16$aic,modelo_3.17$aic,modelo_3.18$aic,modelo_3.19$aic,modelo_3.20$aic,modelo_3.21$aic,modelo_3.22$aic,modelo_3.23$aic,modelo_3.24$aic,modelo_3.25$aic,modelo_3.26$aic,modelo_3.27$aic,modelo_3.28$aic,modelo_3.29$aic,modelo_3.30$aic,modelo_3.31$aic,modelo_3.32$aic)

AICs_modelo4<-rbind(modelo_4.1$aic,modelo_4.2$aic,modelo_4.3$aic,modelo_4.4$aic,modelo_4.5$aic,modelo_4.6$aic,modelo_4.7$aic,modelo_4.8$aic,modelo_4.9$aic,modelo_4.10$aic,modelo_4.11$aic,modelo_4.12$aic,modelo_4.13$aic,modelo_4.14$aic,modelo_4.15$aic,modelo_4.16$aic,modelo_4.17$aic,modelo_4.18$aic,modelo_4.19$aic,modelo_4.20$aic,modelo_4.21$aic,modelo_4.22$aic,modelo_4.23$aic,modelo_4.24$aic,modelo_4.25$aic,modelo_4.26$aic,modelo_4.27$aic,modelo_4.28$aic,modelo_4.29$aic,modelo_4.30$aic,modelo_4.31$aic,modelo_4.32$aic)

AICs_modelos<-cbind(AICs_modelo1,AICs_modelo2,AICs_modelo3,AICs_modelo4)
colnames(AICs_modelos)<-c("Modelo 1","Modelo 2", "Modelo 3", "Modelo 4")
rownames(AICs_modelos)<-c(1:32)

AICs_modelos
```

## Best model

```{r}
min(AICs_modelos)
```

## Testing model_2.8 with "Ljuan-Box"

White noise test, model validation (must be greater than 0.5 to be good)
(mean equal to zero, constant variance and no significant correlation

```{r}
Box.test(residuals(modelo_2.8), type = "Ljung-Box")
```

The model with the lowest AIC is **model_2.8** with AIC = -64.52464 and a Ljuan-Box p-value > 0.5. This model includes:

1. Borrower's ability to pay: (A) PIB instead of IGAE and (B) Unemployment and Remittances.
2. Willingness of consumers to pay their mortgage: (A) INPC_E and IPC_SUB instead of the disaggregated INPC and (B) M1.
3. Confidence and cost indicators for home purchase: IPV and consumer's confidence (CONF).

The selected model is an ARIMA(2,0,3):

```{r}
summary(modelo_2.8)

plot(modelo_2.8$x,col="blue")
lines(fitted(modelo_2.8),col="red")
```

Forecast for last 2 quarters:

```{r}
test_set1<-as.matrix(BDF2[60:61,c(25,13:15,9, 23:24,  8, 10:12, 18:20, 17)])
test_set<-t(test_set1)

library("forecast")
forecast_cv<-forecast(modelo_2.8,xreg=test_set1)
autoplot(forecast_cv)
```

```{r}
forecast_cv
```
```{r}
forecast_2<-c("3.478257","3.524858")
comparison<-as.data.frame(cbind(tail(DATA.ts[63:64,"CV"]),forecast_2))
colnames(comparison)<-c("Actual CV","Forecasted CV")
rownames(comparison)<-c("2020 Q4","2021 Q1")
comparison
```
## Data Analysis

```{r}
# (por poner, HTML format)
```

# State Data Set

Now we intend to follow a very similar methodology for the state level data.

## Loading and visualizing the data: 32 states

```{r}
AGS<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 1)), start=c(2005,2), end=c(2020,4),  frequency=4)
BC<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 2)), start=c(2005,2), end=c(2020,4),   frequency=4)
BCS<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 3)), start=c(2005,2), end=c(2020,4),   frequency=4)
CAMP<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 4)), start=c(2005,2), end=c(2020,4),   frequency=4)
CDMX<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 5)), start=c(2005,2), end=c(2020,4),   frequency=4)
CHIH<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 6)), start=c(2005,2), end=c(2020,4),   frequency=4)
CHIS<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 7)), start=c(2005,2), end=c(2020,4),   frequency=4)
COAH<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 8)), start=c(2005,2), end=c(2020,4),   frequency=4)
COL<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 9)), start=c(2005,2), end=c(2020,4),   frequency=4)
DGO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 10)), start=c(2005,2), end=c(2020,4),   frequency=4)
GRO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 11)), start=c(2005,2), end=c(2020,4),   frequency=4)
GTO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 12)), start=c(2005,2), end=c(2020,4),   frequency=4)
HGO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 13)), start=c(2005,2), end=c(2020,4),   frequency=4)
JAL<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 14)), start=c(2005,2), end=c(2020,4),   frequency=4)
MEX<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 15)), start=c(2005,2), end=c(2020,4),   frequency=4)
MICH<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 16)), start=c(2005,2), end=c(2020,4),   frequency=4)
MOR<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 17)), start=c(2005,2), end=c(2020,4),   frequency=4)
NAY<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 18)), start=c(2005,2), end=c(2020,4),   frequency=4)
NL<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 19)), start=c(2005,2),  end=c(2020,4),  frequency=4)
OAXACA<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 20)), start=c(2005,2), end=c(2020,4),   frequency=4)
PUE<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 21)), start=c(2005,2), end=c(2020,4),   frequency=4)
Q_ROO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 22)), start=c(2005,2), end=c(2020,4),   frequency=4)
QRO<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 23)), start=c(2005,2), end=c(2020,4),   frequency=4)
SIN<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 24)), start=c(2005,2), end=c(2020,4),   frequency=4)
SLP<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 25)), start=c(2005,2), end=c(2020,4),   frequency=4)
SON<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 26)), start=c(2005,2), end=c(2020,4),   frequency=4)
TAB<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 27)), start=c(2005,2), end=c(2020,4),   frequency=4)
TAMPS<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 28)), start=c(2005,2), end=c(2020,4),    frequency=4)
TLAX<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 29)), start=c(2005,2), end=c(2020,4),   frequency=4)
VER<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 30)), start=c(2005,2), end=c(2020,4),   frequency=4)
YUC<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 31)), start=c(2005,2), end=c(2020,4),   frequency=4)
ZAC<-ts(data=(read_excel("ESTADOS.xlsx", sheet = 32)), start=c(2005,2), end=c(2020,4),   frequency=4)

CV_AGS <- AGS[ ,1]
IPV_AGS <- AGS[ ,2]
GDP_AGS <- AGS[,5]
REM_AGS <- AGS[,4]
UNEMP_AGS <- AGS[,3]
INPC_SUB_AGS <- AGS[,6]
INPC_E_AGS <- AGS[,7]
M1_AGS <- AGS[,8]
CONF_AGS <- AGS[,9]

plot_AGS<-ts(cbind(CV_AGS,IPV_AGS,GDP_AGS,REM_AGS,UNEMP_AGS),start=c(2005,2),frequency=4)
plot(plot_AGS)

CV_BC <- BC[ ,1]
IPV_BC <- BC[ ,2]
GDP_BC <- BC[,5]
REM_BC <- BC[,4]
UNEMP_BC <- BC[,3]
INPC_SUB_BC<- BC[,6]
INPC_E_BC <- BC[,7]
M1_BC <- BC[,8]
CONF_BC <- BC[,9]
plot_BC<-ts(cbind(CV_BC,IPV_BC,GDP_BC,REM_BC,UNEMP_BC),start=c(2005,2),frequency=4)
plot(plot_BC)

CV_BCS <- BCS[ ,1]
IPV_BCS <- BCS[ ,2]
GDP_BCS <- BCS[,5]
REM_BCS <- BCS[,4]
UNEMP_BCS <- BCS[,3]
INPC_SUB_BCS <- BCS[,6]
INPC_E_BCS <- BCS[,7]
M1_BCS <- BCS[,8]
CONF_BCS <- BCS[,9]
plot_BCS<-ts(cbind(CV_BCS,IPV_BCS,GDP_BCS,REM_BCS,UNEMP_BCS),start=c(2005,2),frequency=4)
plot(plot_BCS)

CV_CAMP <- CAMP[ ,1]
IPV_CAMP <- CAMP[ ,2]
GDP_CAMP <- CAMP[,5]
REM_CAMP <- CAMP[,4]
UNEMP_CAMP <- CAMP[,3]
INPC_SUB_CAMP <- CAMP[,6]
INPC_E_CAMP <- CAMP[,7]
M1_CAMP <- CAMP[,8]
CONF_CAMP <- CAMP[,9]
plot_CAMP<-ts(cbind(CV_CAMP,IPV_CAMP,GDP_CAMP,REM_CAMP,UNEMP_CAMP),start=c(2005,2),frequency=4)
plot(plot_CAMP)

CV_CHIS <- CHIS[ ,1]
IPV_CHIS <- CHIS[ ,2]
GDP_CHIS <- CHIS[,5]
REM_CHIS <- CHIS[,4]
UNEMP_CHIS <- CHIS[,3]
INPC_SUB_CHIS <- CHIS[,6]
INPC_E_CHIS <- CHIS[,7]
M1_CHIS <- CHIS[,8]
CONF_CHIS <- CHIS[,9]
plot_CHIS<-ts(cbind(CV_CHIS,IPV_CHIS,GDP_CHIS,REM_CHIS,UNEMP_CHIS),start=c(2005,2),frequency=4)
plot(plot_CHIS)

CV_CHIH <- CHIH[ ,1]
IPV_CHIH <- CHIH[ ,2]
GDP_CHIH <- CHIH[,5]
REM_CHIH <- CHIH[,4]
UNEMP_CHIH <- CHIH[,3]
INPC_SUB_CHIH <- CHIH[,6]
INPC_E_CHIH <- CHIH[,7]
M1_CHIH <- CHIH[,8]
CONF_CHIH <- CHIH[,9]
plot_CHIH<-ts(cbind(CV_CHIH,IPV_CHIH,GDP_CHIH,REM_CHIH,UNEMP_CHIH),start=c(2005,2),frequency=4)
plot(plot_CHIH)

CV_CDMX <- CDMX[ ,1]
IPV_CDMX <- CDMX[ ,2]
GDP_CDMX <- CDMX[,5]
REM_CDMX <- CDMX[,4]
UNEMP_CDMX <- CDMX[,3]
INPC_SUB_CDMX <- CDMX[,6]
INPC_E_CDMX <- CDMX[,7]
M1_CDMX <- CDMX[,8]
CONF_CDMX <- CDMX[,9]
plot_CDMX<-ts(cbind(CV_CDMX,IPV_CDMX,GDP_CDMX,REM_CDMX,UNEMP_CDMX),start=c(2005,2),frequency=4)
plot(plot_CDMX)

CV_COAH <- COAH[ ,1]
IPV_COAH <- COAH[ ,2]
GDP_COAH <- COAH[,5]
REM_COAH <- COAH[,4]
UNEMP_COAH <- COAH[,3]
INPC_SUB_COAH <- COAH[,6]
INPC_E_COAH <- COAH[,7]
M1_COAH <- COAH[,8]
CONF_COAH <- COAH[,9]
plot_COAH<-ts(cbind(CV_COAH,IPV_COAH,GDP_COAH,REM_COAH,UNEMP_COAH),start=c(2005,2),frequency=4)
plot(plot_COAH)

CV_COL <- COL[ ,1]
IPV_COL <- COL[ ,2]
GDP_COL <- COL[,5]
REM_COL <- COL[,4]
UNEMP_COL <- COL[,3]
INPC_SUB_COL <- COL[,6]
INPC_E_COL <- COL[,7]
M1_COL <- COL[,8]
CONF_COL <- COL[,9]
plot_COL<-ts(cbind(CV_COL,IPV_COL,GDP_COL,REM_COL,UNEMP_COL),start=c(2005,2),frequency=4)
plot(plot_COL)

CV_DGO <- DGO[ ,1]
IPV_DGO <- DGO[ ,2]
GDP_DGO <- DGO[,5]
REM_DGO <- DGO[,4]
UNEMP_DGO <- DGO[,3]
INPC_SUB_DGO <- DGO[,6]
INPC_E_DGO <- DGO[,7]
M1_DGO <- DGO[,8]
CONF_DGO <- DGO[,9]
plot_DGO<-ts(cbind(CV_DGO,IPV_DGO,GDP_DGO,REM_DGO,UNEMP_DGO),start=c(2005,2),frequency=4)
plot(plot_DGO)

CV_GTO <- GTO[ ,1]
IPV_GTO <- GTO[ ,2]
GDP_GTO <- GTO[,5]
REM_GTO <- GTO[,4]
UNEMP_GTO <- GTO[,3]
INPC_SUB_GTO <- GTO[,6]
INPC_E_GTO <- GTO[,7]
M1_GTO <- GTO[,8]
CONF_GTO <- GTO[,9]
plot_GTO<-ts(cbind(CV_GTO,IPV_GTO,GDP_GTO,REM_GTO,UNEMP_GTO),start=c(2005,2),frequency=4)
plot(plot_GTO)

CV_GRO <- GRO[ ,1]
IPV_GRO <- GRO[ ,2]
GDP_GRO <- GRO[,5]
REM_GRO <- GRO[,4]
UNEMP_GRO <- GRO[,3]
INPC_SUB_GRO <- GRO[,6]
INPC_E_GRO <- GRO[,7]
M1_GRO <- GRO[,8]
CONF_GRO <- GRO[,9]
plot_GRO<-ts(cbind(CV_GRO,IPV_GRO,GDP_GRO,REM_GRO,UNEMP_GRO),start=c(2005,2),frequency=4)
plot(plot_GRO)

CV_HGO <- HGO[ ,1]
IPV_HGO <- HGO[ ,2]
GDP_HGO <- HGO[,5]
REM_HGO <- HGO[,4]
UNEMP_HGO <- HGO[,3]
INPC_SUB_HGO <- HGO[,6]
INPC_E_HGO <- HGO[,7]
M1_HGO <- HGO[,8]
CONF_HGO <- HGO[,9]
plot_HGO<-ts(cbind(CV_HGO,IPV_HGO,GDP_HGO,REM_HGO,UNEMP_HGO),start=c(2005,2),frequency=4)
plot(plot_HGO)

CV_JAL <- JAL[ ,1]
IPV_JAL <- JAL[ ,2]
GDP_JAL <- JAL[,5]
REM_JAL <- JAL[,4]
UNEMP_JAL <- JAL[,3]
INPC_SUB_JAL <- JAL[,6]
INPC_E_JAL <- JAL[,7]
M1_JAL <- JAL[,8]
CONF_JAL <- JAL[,9]
plot_JAL<-ts(cbind(CV_JAL,IPV_JAL,GDP_JAL,REM_JAL,UNEMP_JAL),start=c(2005,2),frequency=4)
plot(plot_JAL)

CV_MEX <- MEX[ ,1]
IPV_MEX <- MEX[ ,2]
GDP_MEX <- MEX[,5]
REM_MEX <- MEX[,4]
UNEMP_MEX <- MEX[,3]
INPC_SUB_MEX <- MEX[,6]
INPC_E_MEX <- MEX[,7]
M1_MEX <- MEX[,8]
CONF_MEX <- MEX[,9]
plot_MEX<-ts(cbind(CV_MEX,IPV_MEX,GDP_MEX,REM_MEX,UNEMP_MEX),start=c(2005,2),frequency=4)
plot(plot_MEX)

CV_MICH <- MICH[ ,1]
IPV_MICH <- MICH[ ,2]
GDP_MICH <- MICH[,5]
REM_MICH <- MICH[,4]
UNEMP_MICH <- MICH[,3]
INPC_SUB_MICH <- MICH[,6]
INPC_E_MICH <- MICH[,7]
M1_MICH <- MICH[,8]
CONF_MICH <- MICH[,9]
plot_MICH<-ts(cbind(CV_MICH,IPV_MICH,GDP_MICH,REM_MICH,UNEMP_MICH),start=c(2005,2),frequency=4)
plot(plot_MICH)

CV_MOR <- MOR[ ,1]
IPV_MOR <- MOR[ ,2]
GDP_MOR <- MOR[,5]
REM_MOR <- MOR[,4]
UNEMP_MOR <- MOR[,3]
INPC_SUB_MOR <- MOR[,6]
INPC_E_MOR <- MOR[,7]
M1_MOR <- MOR[,8]
CONF_MOR <- MOR[,9]
plot_MOR<-ts(cbind(CV_MOR,IPV_MOR,GDP_MOR,REM_MOR,UNEMP_MOR),start=c(2005,2),frequency=4)
plot(plot_MOR)

CV_NAY <- NAY[ ,1]
IPV_NAY <- NAY[ ,2]
GDP_NAY <- NAY[,5]
REM_NAY <- NAY[,4]
UNEMP_NAY <- NAY[,3]
INPC_SUB_NAY <- NAY[,6]
INPC_E_NAY <- NAY[,7]
M1_NAY <- NAY[,8]
CONF_NAY <- NAY[,9]
plot_NAY<-ts(cbind(CV_NAY,IPV_NAY,GDP_NAY,REM_NAY,UNEMP_NAY),start=c(2005,2),frequency=4)
plot(plot_NAY)

CV_NL <- NL[ ,1]
IPV_NL <- NL[ ,2]
GDP_NL <- NL[,5]
REM_NL <- NL[,4]
UNEMP_NL <- NL[,3]
INPC_SUB_NL <- NL[,6]
INPC_E_NL <- NL[,7]
M1_NL <- NL[,8]
CONF_NL <- NL[,9]
plot_NL<-ts(cbind(CV_NL,IPV_NL,GDP_NL,REM_NL,UNEMP_NL),start=c(2005,2),frequency=4)
plot(plot_NL)

CV_OAXACA <- OAXACA[ ,1]
IPV_OAXACA <- OAXACA[ ,2]
GDP_OAXACA <- OAXACA[,5]
REM_OAXACA <- OAXACA[,4]
UNEMP_OAXACA <- OAXACA[,3]
INPC_SUB_OAXACA <- OAXACA[,6]
INPC_E_OAXACA <- OAXACA[,7]
M1_OAXACA <- OAXACA[,8]
CONF_OAXACA <- OAXACA[,9]
plot_OAXACA<-ts(cbind(CV_OAXACA,IPV_OAXACA,GDP_OAXACA,REM_OAXACA,UNEMP_OAXACA),start=c(2005,2),frequency=4)
plot(plot_OAXACA)

CV_PUE <- PUE[ ,1]
IPV_PUE <- PUE[ ,2]
GDP_PUE <- PUE[,5]
REM_PUE <- PUE[,4]
UNEMP_PUE <- PUE[,3]
INPC_SUB_PUE <- PUE[,6]
INPC_E_PUE <- PUE[,7]
M1_PUE <- PUE[,8]
CONF_PUE <- PUE[,9]
plot_PUE<-ts(cbind(CV_PUE,IPV_PUE,GDP_PUE,REM_PUE,UNEMP_PUE),start=c(2005,2),frequency=4)
plot(plot_PUE)

CV_QRO <- QRO[ ,1]
IPV_QRO <- QRO[ ,2]
GDP_QRO <- QRO[,5]
REM_QRO <- QRO[,4]
UNEMP_QRO <- QRO[,3]
INPC_SUB_QRO <- QRO[,6]
INPC_E_QRO <- QRO[,7]
M1_QRO <- QRO[,8]
CONF_QRO <- QRO[,9]
plot_QRO<-ts(cbind(CV_QRO,IPV_QRO,GDP_QRO,REM_QRO,UNEMP_QRO),start=c(2005,2),frequency=4)
plot(plot_QRO)

CV_Q_ROO <- Q_ROO[ ,1]
IPV_Q_ROO <- Q_ROO[ ,2]
GDP_Q_ROO <- Q_ROO[,5]
REM_Q_ROO <- Q_ROO[,4]
UNEMP_Q_ROO <- Q_ROO[,3]
INPC_SUB_Q_ROO <- Q_ROO[,6]
INPC_E_Q_ROO <- Q_ROO[,7]
M1_Q_ROO <- Q_ROO[,8]
CONF_Q_ROO <- Q_ROO[,9]
plot_Q_ROO<-ts(cbind(CV_Q_ROO,IPV_Q_ROO,GDP_Q_ROO,REM_Q_ROO,UNEMP_Q_ROO),start=c(2005,2),frequency=4)
plot(plot_Q_ROO)

CV_SLP <- SLP[ ,1]
IPV_SLP <- SLP[ ,2]
GDP_SLP <- SLP[,5]
REM_SLP <- SLP[,4]
UNEMP_SLP <- SLP[,3]
INPC_SUB_SLP <- SLP[,6]
INPC_E_SLP <- SLP[,7]
M1_SLP <- SLP[,8]
CONF_SLP <- SLP[,9]
plot_SLP<-ts(cbind(CV_SLP,IPV_SLP,GDP_SLP,REM_SLP,UNEMP_SLP),start=c(2005,2),frequency=4)
plot(plot_SLP)

CV_SIN <- SIN[ ,1]
IPV_SIN <- SIN[ ,2]
GDP_SIN <- SIN[,5]
REM_SIN <- SIN[,4]
UNEMP_SIN <- SIN[,3]
INPC_SUB_SIN <- SIN[,6]
INPC_E_SIN <- SIN[,7]
M1_SIN <- SIN[,8]
CONF_SIN <- SIN[,9]
plot_SIN<-ts(cbind(CV_SIN,IPV_SIN,GDP_SIN,REM_SIN,UNEMP_SIN),start=c(2005,2),frequency=4)
plot(plot_SIN)

CV_SON <- SON[ ,1]
IPV_SON <- SON[ ,2]
GDP_SON <- SON[,5]
REM_SON <- SON[,4]
UNEMP_SON <- SON[,3]
INPC_SUB_SON <- SON[,6]
INPC_E_SON <- SON[,7]
M1_SON <- SON[,8]
CONF_SON <- SON[,9]
plot_SON<-ts(cbind(CV_SON,IPV_SON,GDP_SON,REM_SON,UNEMP_SON),start=c(2005,2),frequency=4)
plot(plot_SON)

CV_TAB <- TAB[ ,1]
IPV_TAB <- TAB[ ,2]
GDP_TAB <- TAB[,5]
REM_TAB <- TAB[,4]
UNEMP_TAB <- TAB[,3]
INPC_SUB_TAB <- TAB[,6]
INPC_E_TAB <- TAB[,7]
M1_TAB <- TAB[,8]
CONF_TAB <- TAB[,9]
plot_TAB<-ts(cbind(CV_TAB,IPV_TAB,GDP_TAB,REM_TAB,UNEMP_TAB),start=c(2005,2),frequency=4)
plot(plot_TAB)

CV_TAMPS <- TAMPS[ ,1]
IPV_TAMPS <- TAMPS[ ,2]
GDP_TAMPS <- TAMPS[,5]
REM_TAMPS <- TAMPS[,4]
UNEMP_TAMPS <- TAMPS[,3]
INPC_SUB_TAMPS <- TAMPS[,6]
INPC_E_TAMPS <- TAMPS[,7]
M1_TAMPS <- TAMPS[,8]
CONF_TAMPS <- TAMPS[,9]
plot_TAMPS<-ts(cbind(CV_TAMPS,IPV_TAMPS,GDP_TAMPS,REM_TAMPS,UNEMP_TAMPS),start=c(2005,2),frequency=4)
plot(plot_TAMPS)

CV_TLAX <- TLAX[ ,1]
IPV_TLAX <- TLAX[ ,2]
GDP_TLAX <- TLAX[,5]
REM_TLAX <- TLAX[,4]
UNEMP_TLAX <- TLAX[,3]
INPC_SUB_TLAX <- TLAX[,6]
INPC_E_TLAX <- TLAX[,7]
M1_TLAX <- TLAX[,8]
CONF_TLAX <- TLAX[,9]
plot_TLAX<-ts(cbind(CV_TLAX,IPV_TLAX,GDP_TLAX,REM_TLAX,UNEMP_TLAX),start=c(2005,2),frequency=4)
plot(plot_TLAX)

CV_VER <- VER[ ,1]
IPV_VER <- VER[ ,2]
GDP_VER <- VER[,5]
REM_VER <- VER[,4]
UNEMP_VER <- VER[,3]
INPC_SUB_VER <- VER[,6]
INPC_E_VER <- VER[,7]
M1_VER <- VER[,8]
CONF_VER <- VER[,9]
plot_VER<-ts(cbind(CV_VER,IPV_VER,GDP_VER,REM_VER,UNEMP_VER),start=c(2005,2),frequency=4)
plot(plot_VER)

CV_YUC <- YUC[ ,1]
IPV_YUC <- YUC[ ,2]
GDP_YUC <- YUC[,5]
REM_YUC <- YUC[,4]
UNEMP_YUC <- YUC[,3]
INPC_SUB_YUC <- YUC[,6]
INPC_E_YUC <- YUC[,7]
M1_YUC <- YUC[,8]
CONF_YUC <- YUC[,9]
plot_YUC<-ts(cbind(CV_YUC,IPV_YUC,GDP_YUC,REM_YUC,UNEMP_YUC),start=c(2005,2),frequency=4)
plot(plot_YUC)

CV_ZAC <- ZAC[ ,1]
IPV_ZAC <- ZAC[ ,2]
GDP_ZAC <- ZAC[,5]
REM_ZAC <- ZAC[,4]
UNEMP_ZAC <- ZAC[,3]
INPC_SUB_ZAC <- ZAC[,6]
INPC_E_ZAC <- ZAC[,7]
M1_ZAC <- ZAC[,8]
CONF_ZAC <- ZAC[,9]
plot_ZAC<-ts(cbind(CV_ZAC,IPV_ZAC,GDP_ZAC,REM_ZAC,UNEMP_ZAC),start=c(2005,2),frequency=4)
plot(plot_ZAC)
```

## Correlation
```{r}
round(cor(plot_AGS),2)
round(cor(plot_BC),2)
round(cor(plot_BCS),2)
round(cor(plot_CAMP),2)
round(cor(plot_CHIS),2)
round(cor(plot_CHIH),2)
round(cor(plot_CDMX),2)
round(cor(plot_COAH),2)
round(cor(plot_COL),2)
round(cor(plot_DGO),2)
round(cor(plot_GTO),2)
round(cor(plot_GRO),2)
round(cor(plot_HGO),2)
round(cor(plot_JAL),2)
round(cor(plot_MEX),2)
round(cor(plot_MICH),2)
round(cor(plot_MOR),2)
round(cor(plot_NAY),2)
round(cor(plot_NL),2)
round(cor(plot_OAXACA),2)
round(cor(plot_PUE),2)
round(cor(plot_QRO),2)
round(cor(plot_Q_ROO),2)
round(cor(plot_SLP),2)
round(cor(plot_SIN),2)
round(cor(plot_SON),2)
round(cor(plot_TAB),2)
round(cor(plot_TAMPS),2)
round(cor(plot_TLAX),2)
round(cor(plot_VER),2)
round(cor(plot_YUC),2)
round(cor(plot_ZAC),2)
```

## Data Analysis

### Delincquency rates by State

```{r}
library("ellipsis")
library("cli")
library("devtools")
library("mxmaps")

CV_STATES<-cbind(CV_AGS,CV_BC,CV_BCS,CV_CAMP,CV_CDMX,CV_CHIH,CV_CHIS,CV_COAH,CV_COL,CV_DGO,CV_GRO,CV_GTO,CV_HGO,CV_JAL,CV_MEX,CV_MICH,CV_MOR,CV_NAY,CV_NL,CV_OAXACA,CV_PUE,CV_Q_ROO,CV_QRO,CV_SIN,CV_SLP,CV_SON,CV_TAB,CV_TAMPS,CV_TLAX,CV_VER,CV_YUC,CV_ZAC)

KEY<-c(01,	02,	03,	04,	09,	08,	07,	05,	06,	10,	12,	11,	13,	14,	15,	16,	17,	18,	19,	20,	21,	23,	22,	25,	24,	26,	27,	28,	29,	30,	31,	32)

CV_2020<-CV_STATES[60:63,]

CV_2020_MEAN<-c(mean(CV_2020[,1]),mean(CV_2020[,2]),mean(CV_2020[,3]),mean(CV_2020[,4]),mean(CV_2020[,5]),mean(CV_2020[,6]),mean(CV_2020[,7]),mean(CV_2020[,8]),mean(CV_2020[,9]),mean(CV_2020[,10]),mean(CV_2020[,11]),mean(CV_2020[,12]),mean(CV_2020[,13]),mean(CV_2020[,14]),mean(CV_2020[,15]),mean(CV_2020[,16]),mean(CV_2020[,17]),mean(CV_2020[,18]),mean(CV_2020[,19]),mean(CV_2020[,20]),mean(CV_2020[,21]),mean(CV_2020[,22]),mean(CV_2020[,23]),mean(CV_2020[,24]),mean(CV_2020[,25]),mean(CV_2020[,26]),mean(CV_2020[,27]),mean(CV_2020[,28]),mean(CV_2020[,29]),mean(CV_2020[,30]),mean(CV_2020[,31]),mean(CV_2020[,32]))

MAPCV2020<-as.data.frame(t(rbind(CV_2020_MEAN,KEY)))
colnames(MAPCV2020)<-c("value","region")

MAP <- mxstate_choropleth(MAPCV2020, num_colors=1, title="Average delincquency rate by state (2020)")
MAP
```

# Stationarity

*(development of state level models is still pending)*

```{r, include = FALSE}
summary(ur.df(CV_AGS,lags = 0))
summary(ur.df(IPV_AGS,lags=0))
summary(ur.df(GDP_AGS,lags=0))
summary(ur.df(REM_AGS,lags=0))
summary(ur.df(UNEMP_AGS,lags=0))

summary(ur.df(CV_MOR,lags=0))
CV_MOR_diff1<-diff(CV_MOR)
summary(ur.df(CV_MOR_diff1,lags=0))
plot(ts(cbind(CV_MOR,CV_MOR_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_MOR,lags=0))
summary(ur.df(GDP_MOR,lags=0))
summary(ur.df(REM_MOR,lags=0))
summary(ur.df(UNEMP_MOR,lags=0))

summary(ur.df(CV_NAY,lags=0))
CV_NAY_diff1<-diff(CV_NAY)
summary(ur.df(CV_NAY_diff1,lags=0))
plot(ts(cbind(CV_NAY,CV_NAY_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_NAY,lags=0))
summary(ur.df(GDP_NAY,lags=0))
summary(ur.df(REM_NAY,lags=0))
summary(ur.df(UNEMP_NAY,lags=0))

summary(ur.df(CV_NL,lags=0))
CV_NL_diff1<-diff(CV_NL)
summary(ur.df(CV_NL_diff1,lags=0))
plot(ts(cbind(CV_NL,CV_NL_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_NL,lags=0))
summary(ur.df(GDP_NL,lags=0))
summary(ur.df(REM_NL,lags=0))
summary(ur.df(UNEMP_NL,lags=0))

summary(ur.df(CV_OAXACA,lags=0))
CV_OAXACA_diff1<-diff(CV_OAXACA)
summary(ur.df(CV_OAXACA_diff1,lags=0))
plot(ts(cbind(CV_OAXACA,CV_OAXACA_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_OAXACA,lags=0))
summary(ur.df(GDP_OAXACA,lags=0))
summary(ur.df(REM_OAXACA,lags=0))
summary(ur.df(UNEMP_OAXACA,lags=0))

summary(ur.df(CV_PUE,lags=0))
CV_PUE_diff1<-diff(CV_PUE)
summary(ur.df(CV_PUE_diff1,lags=0))
plot(ts(cbind(CV_PUE,CV_PUE_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_PUE,lags=0))
summary(ur.df(GDP_PUE,lags=0))
summary(ur.df(REM_PUE,lags=0))
summary(ur.df(UNEMP_PUE,lags=0))

summary(ur.df(CV_QRO,lags=0))
CV_QRO_diff1<-diff(CV_QRO)
summary(ur.df(CV_QRO_diff1,lags=0))
plot(ts(cbind(CV_QRO,CV_QRO_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_QRO,lags=0))
summary(ur.df(GDP_QRO,lags=0))
summary(ur.df(REM_QRO,lags=0))
summary(ur.df(UNEMP_QRO,lags=0))

summary(ur.df(CV_Q_ROO,lags=0))
CV_Q_ROO_diff1<-diff(CV_Q_ROO)
summary(ur.df(CV_Q_ROO_diff1,lags=0))
plot(ts(cbind(CV_Q_ROO,CV_Q_ROO_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_Q_ROO,lags=0))
summary(ur.df(GDP_Q_ROO,lags=0))
summary(ur.df(REM_Q_ROO,lags=0))
summary(ur.df(UNEMP_Q_ROO,lags=0))

summary(ur.df(CV_SIN,lags=0))
CV_SIN_diff1<-diff(CV_SIN)
summary(ur.df(CV_SIN_diff1,lags=0))
plot(ts(cbind(CV_SIN,CV_SIN_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_SIN,lags=0))
summary(ur.df(GDP_SIN,lags=0))
summary(ur.df(REM_SIN,lags=0))
summary(ur.df(UNEMP_SIN,lags=0))

summary(ur.df(CV_TAB,lags=0))
CV_TAB_diff1<-diff(CV_TAB)
summary(ur.df(CV_TAB_diff1,lags=0))
plot(ts(cbind(CV_TAB,CV_TAB_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_TAB,lags=0))
summary(ur.df(GDP_TAB,lags=0))
summary(ur.df(REM_TAB,lags=0))
summary(ur.df(UNEMP_TAB,lags=0))

summary(ur.df(CV_TAMPS,lags=0))
CV_TAMPS_diff1<-diff(CV_TAMPS)
summary(ur.df(CV_TAMPS_diff1,lags=0))
plot(ts(cbind(CV_TAMPS,CV_TAMPS_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_TAMPS,lags=0))
summary(ur.df(GDP_TAMPS,lags=0))
summary(ur.df(REM_TAMPS,lags=0))
summary(ur.df(UNEMP_TAMPS,lags=0))

summary(ur.df(CV_VER,lags=0))
CV_VER_diff1<-diff(CV_VER)
summary(ur.df(CV_VER_diff1,lags=0))
plot(ts(cbind(CV_VER,CV_VER_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_VER,lags=0))
summary(ur.df(GDP_VER,lags=0))
summary(ur.df(REM_VER,lags=0))
summary(ur.df(UNEMP_VER,lags=0))

summary(ur.df(CV_YUC,lags=0))
CV_YUC_diff1<-diff(CV_YUC)
summary(ur.df(CV_YUC_diff1,lags=0))
plot(ts(cbind(CV_YUC,CV_YUC_diff1),start=c(2005,2),frequency=4))

summary(ur.df(IPV_YUC,lags=0))
summary(ur.df(GDP_YUC,lags=0))
summary(ur.df(REM_YUC,lags=0))
summary(ur.df(UNEMP_YUC,lags=0))

```
# Estimating lags NACIONAL

```{r}
# AGS
# IPV - AGS
IPV_AGS_v<-as.vector(IPV_AGS)
CV_AGS_v<-as.vector(CV_AGS)
IPV_AGS_v2<-cbind(IPV_AGS_v,CV_AGS_v)
colnames(IPV_AGS_v2)<-c("IPV_AGS","CV_AGS")
a<- lag(IPV_AGS_v,0)
x<- lag(IPV_AGS_v,1)
y<- lag(IPV_AGS_v,2)
z<- lag(IPV_AGS_v,3)
IPV_AGS_lags <- cbind(x,y,z)

fitIPV_AGS1 <- auto.arima(IPV_AGS_v2[4: 63,2], xreg=IPV_AGS_lags[4: 63,1], d=0)
fitIPV_AGS2 <- auto.arima(IPV_AGS_v2[4: 63,2], xreg=IPV_AGS_lags[4: 63,1:2], d=0)
fitIPV_AGS3 <- auto.arima(IPV_AGS_v2[4: 63,2], xreg=IPV_AGS_lags[4: 63,1:3], d=0)
AIC_IPV_AGS <- cbind(fitIPV_AGS1$aic,fitIPV_AGS2$aic,fitIPV_AGS3$aic)
colnames(AIC_IPV_AGS)<-c("1 lag","2 lags", "3 lags")
# UNEMP - AGS
UNEMP_AGS_v<-as.vector(UNEMP_AGS)
CV_AGS_v<-as.vector(CV_AGS)
UNEMP_AGS_v2<-cbind(UNEMP_AGS_v,CV_AGS_v)
colnames(UNEMP_AGS_v2)<-c("UNEMP_AGS","CV_AGS")
a<- lag(UNEMP_AGS_v,0)
x<- lag(UNEMP_AGS_v,1)
y<- lag(UNEMP_AGS_v,2)
z<- lag(UNEMP_AGS_v,3)
UNEMP_AGS_lags <- cbind(x,y,z)

fitUNEMP_AGS1 <- auto.arima(UNEMP_AGS_v2[4: 63,2], xreg=UNEMP_AGS_lags[4: 63,1], d=0)
fitUNEMP_AGS2 <- auto.arima(UNEMP_AGS_v2[4: 63,2], xreg=UNEMP_AGS_lags[4: 63,1:2], d=0)
fitUNEMP_AGS3 <- auto.arima(UNEMP_AGS_v2[4: 63,2], xreg=UNEMP_AGS_lags[4: 63,1:3], d=0)
AIC_UNEMP_AGS <- cbind(fitUNEMP_AGS1$aic,fitUNEMP_AGS2$aic,fitUNEMP_AGS3$aic)
colnames(AIC_UNEMP_AGS)<-c("1 lag","2 lags", "3 lags")
# REM - AGS
REM_AGS_v<-as.vector(REM_AGS)
CV_AGS_v<-as.vector(CV_AGS)
REM_AGS_v2<-cbind(REM_AGS_v,CV_AGS_v)
colnames(REM_AGS_v2)<-c("REM_AGS","CV_AGS")
a<- lag(REM_AGS_v,0)
x<- lag(REM_AGS_v,1)
y<- lag(REM_AGS_v,2)
z<- lag(REM_AGS_v,3)
REM_AGS_lags <- cbind(x,y,z)

fitREM_AGS1 <- auto.arima(REM_AGS_v2[4: 63,2], xreg=REM_AGS_lags[4: 63,1], d=0)
fitREM_AGS2 <- auto.arima(REM_AGS_v2[4: 63,2], xreg=REM_AGS_lags[4: 63,1:2], d=0)
fitREM_AGS3 <- auto.arima(REM_AGS_v2[4: 63,2], xreg=REM_AGS_lags[4: 63,1:3], d=0)
AIC_REM_AGS <- cbind(fitREM_AGS1$aic,fitREM_AGS2$aic,fitREM_AGS3$aic)
colnames(AIC_REM_AGS)<-c("1 lag","2 lags", "3 lags")
# GDP - AGS
GDP_AGS_v<-as.vector(GDP_AGS)
CV_AGS_v<-as.vector(CV_AGS)
GDP_AGS_v2<-cbind(GDP_AGS_v,CV_AGS_v)
colnames(GDP_AGS_v2)<-c("GDP_AGS","CV_AGS")
a<- lag(GDP_AGS_v,0)
x<- lag(GDP_AGS_v,1)
y<- lag(GDP_AGS_v,2)
z<- lag(GDP_AGS_v,3)
GDP_AGS_lags <- cbind(x,y,z)

fitGDP_AGS1 <- auto.arima(GDP_AGS_v2[4: 63,2], xreg=GDP_AGS_lags[4: 63,1], d=0)
fitGDP_AGS2 <- auto.arima(GDP_AGS_v2[4: 63,2], xreg=GDP_AGS_lags[4: 63,1:2], d=0)
fitGDP_AGS3 <- auto.arima(GDP_AGS_v2[4: 63,2], xreg=GDP_AGS_lags[4: 63,1:3], d=0)
AIC_GDP_AGS <- cbind(fitGDP_AGS1$aic,fitGDP_AGS2$aic,fitGDP_AGS3$aic)
colnames(AIC_GDP_AGS)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - AGS
INPC_SUB_AGS_v<-as.vector(INPC_SUB_AGS)
CV_AGS_v<-as.vector(CV_AGS)
INPC_SUB_AGS_v2<-cbind(INPC_SUB_AGS_v,CV_AGS_v)
colnames(INPC_SUB_AGS_v2)<-c("INPC_SUB_AGS","CV_AGS")
a<- lag(INPC_SUB_AGS_v,0)
x<- lag(INPC_SUB_AGS_v,1)
y<- lag(INPC_SUB_AGS_v,2)
z<- lag(INPC_SUB_AGS_v,3)
INPC_SUB_AGS_lags <- cbind(x,y,z)

fitINPC_SUB_AGS1 <- auto.arima(INPC_SUB_AGS_v2[4: 63,2], xreg=INPC_SUB_AGS_lags[4: 63,1], d=0)
fitINPC_SUB_AGS2 <- auto.arima(INPC_SUB_AGS_v2[4: 63,2], xreg=INPC_SUB_AGS_lags[4: 63,1:2], d=0)
fitINPC_SUB_AGS3 <- auto.arima(INPC_SUB_AGS_v2[4: 63,2], xreg=INPC_SUB_AGS_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_AGS <- cbind(fitINPC_SUB_AGS1$aic,fitINPC_SUB_AGS2$aic,fitINPC_SUB_AGS3$aic)
colnames(AIC_INPC_SUB_AGS)<-c("1 lag","2 lags", "3 lags")
# INPC_E - AGS
INPC_E_AGS_v<-as.vector(INPC_E_AGS)
CV_AGS_v<-as.vector(CV_AGS)
INPC_E_AGS_v2<-cbind(INPC_E_AGS_v,CV_AGS_v)
colnames(INPC_E_AGS_v2)<-c("INPC_E_AGS","CV_AGS")
a<- lag(INPC_E_AGS_v,0)
x<- lag(INPC_E_AGS_v,1)
y<- lag(INPC_E_AGS_v,2)
z<- lag(INPC_E_AGS_v,3)
INPC_E_AGS_lags <- cbind(x,y,z)

fitINPC_E_AGS1 <- auto.arima(INPC_E_AGS_v2[4: 63,2], xreg=INPC_E_AGS_lags[4: 63,1], d=0)
fitINPC_E_AGS2 <- auto.arima(INPC_E_AGS_v2[4: 63,2], xreg=INPC_E_AGS_lags[4: 63,1:2], d=0)
fitINPC_E_AGS3 <- auto.arima(INPC_E_AGS_v2[4: 63,2], xreg=INPC_E_AGS_lags[4: 63,1:3], d=0)
AIC_INPC_E_AGS <- cbind(fitINPC_E_AGS1$aic,fitINPC_E_AGS2$aic,fitINPC_E_AGS3$aic)
colnames(AIC_INPC_E_AGS)<-c("1 lag","2 lags", "3 lags")
# M1 - AGS
M1_AGS_v<-as.vector(M1_AGS)
CV_AGS_v<-as.vector(CV_AGS)
M1_AGS_v2<-cbind(M1_AGS_v,CV_AGS_v)
colnames(M1_AGS_v2)<-c("M1_AGS","CV_AGS")
a<- lag(M1_AGS_v,0)
x<- lag(M1_AGS_v,1)
y<- lag(M1_AGS_v,2)
z<- lag(M1_AGS_v,3)
M1_AGS_lags <- cbind(x,y,z)

fitM1_AGS1 <- auto.arima(M1_AGS_v2[4: 63,2], xreg=M1_AGS_lags[4: 63,1], d=0)
fitM1_AGS2 <- auto.arima(M1_AGS_v2[4: 63,2], xreg=M1_AGS_lags[4: 63,1:2], d=0)
fitM1_AGS3 <- auto.arima(M1_AGS_v2[4: 63,2], xreg=M1_AGS_lags[4: 63,1:3], d=0)
AIC_M1_AGS <- cbind(fitM1_AGS1$aic,fitM1_AGS2$aic,fitM1_AGS3$aic)
colnames(AIC_M1_AGS)<-c("1 lag","2 lags", "3 lags")
# CONF - AGS
CONF_AGS_v<-as.vector(CONF_AGS)
CV_AGS_v<-as.vector(CV_AGS)
CONF_AGS_v2<-cbind(CONF_AGS_v,CV_AGS_v)
colnames(CONF_AGS_v2)<-c("CONF_AGS","CV_AGS")
a<- lag(CONF_AGS_v,0)
x<- lag(CONF_AGS_v,1)
y<- lag(CONF_AGS_v,2)
z<- lag(CONF_AGS_v,3)
CONF_AGS_lags <- cbind(x,y,z)

fitCONF_AGS1 <- auto.arima(CONF_AGS_v2[4: 63,2], xreg=CONF_AGS_lags[4: 63,1], d=0)
fitCONF_AGS2 <- auto.arima(CONF_AGS_v2[4: 63,2], xreg=CONF_AGS_lags[4: 63,1:2], d=0)
fitCONF_AGS3 <- auto.arima(CONF_AGS_v2[4: 63,2], xreg=CONF_AGS_lags[4: 63,1:3], d=0)
AIC_CONF_AGS <- cbind(fitCONF_AGS1$aic,fitCONF_AGS2$aic,fitCONF_AGS3$aic)
colnames(AIC_CONF_AGS)<-c("1 lag","2 lags", "3 lags")

AICs_AGS<-rbind(AIC_IPV_AGS,AIC_UNEMP_AGS,AIC_REM_AGS,AIC_GDP_AGS,AIC_INPC_SUB_AGS,AIC_INPC_E_AGS,AIC_M1_AGS,AIC_CONF_AGS)
rownames(AICs_AGS)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_AGS
```
```{r}
# BC
# IPV - BC
IPV_BC_v<-as.vector(IPV_BC)
CV_BC_v<-as.vector(CV_BC)
IPV_BC_v2<-cbind(IPV_BC_v,CV_BC_v)
colnames(IPV_BC_v2)<-c("IPV_BC","CV_BC")
a<- lag(IPV_BC_v,0)
x<- lag(IPV_BC_v,1)
y<- lag(IPV_BC_v,2)
z<- lag(IPV_BC_v,3)
IPV_BC_lags <- cbind(x,y,z)

fitIPV_BC1 <- auto.arima(IPV_BC_v2[4: 63,2], xreg=IPV_BC_lags[4: 63,1], d=0)
fitIPV_BC2 <- auto.arima(IPV_BC_v2[4: 63,2], xreg=IPV_BC_lags[4: 63,1:2], d=0)
fitIPV_BC3 <- auto.arima(IPV_BC_v2[4: 63,2], xreg=IPV_BC_lags[4: 63,1:3], d=0)
AIC_IPV_BC <- cbind(fitIPV_BC1$aic,fitIPV_BC2$aic,fitIPV_BC3$aic)
colnames(AIC_IPV_BC)<-c("1 lag","2 lags", "3 lags")
# UNEMP - BC
UNEMP_BC_v<-as.vector(UNEMP_BC)
CV_BC_v<-as.vector(CV_BC)
UNEMP_BC_v2<-cbind(UNEMP_BC_v,CV_BC_v)
colnames(UNEMP_BC_v2)<-c("UNEMP_BC","CV_BC")
a<- lag(UNEMP_BC_v,0)
x<- lag(UNEMP_BC_v,1)
y<- lag(UNEMP_BC_v,2)
z<- lag(UNEMP_BC_v,3)
UNEMP_BC_lags <- cbind(x,y,z)

fitUNEMP_BC1 <- auto.arima(UNEMP_BC_v2[4: 63,2], xreg=UNEMP_BC_lags[4: 63,1], d=0)
fitUNEMP_BC2 <- auto.arima(UNEMP_BC_v2[4: 63,2], xreg=UNEMP_BC_lags[4: 63,1:2], d=0)
fitUNEMP_BC3 <- auto.arima(UNEMP_BC_v2[4: 63,2], xreg=UNEMP_BC_lags[4: 63,1:3], d=0)
AIC_UNEMP_BC <- cbind(fitUNEMP_BC1$aic,fitUNEMP_BC2$aic,fitUNEMP_BC3$aic)
colnames(AIC_UNEMP_BC)<-c("1 lag","2 lags", "3 lags")
# REM - BC
REM_BC_v<-as.vector(REM_BC)
CV_BC_v<-as.vector(CV_BC)
REM_BC_v2<-cbind(REM_BC_v,CV_BC_v)
colnames(REM_BC_v2)<-c("REM_BC","CV_BC")
a<- lag(REM_BC_v,0)
x<- lag(REM_BC_v,1)
y<- lag(REM_BC_v,2)
z<- lag(REM_BC_v,3)
REM_BC_lags <- cbind(x,y,z)

fitREM_BC1 <- auto.arima(REM_BC_v2[4: 63,2], xreg=REM_BC_lags[4: 63,1], d=0)
fitREM_BC2 <- auto.arima(REM_BC_v2[4: 63,2], xreg=REM_BC_lags[4: 63,1:2], d=0)
fitREM_BC3 <- auto.arima(REM_BC_v2[4: 63,2], xreg=REM_BC_lags[4: 63,1:3], d=0)
AIC_REM_BC <- cbind(fitREM_BC1$aic,fitREM_BC2$aic,fitREM_BC3$aic)
colnames(AIC_REM_BC)<-c("1 lag","2 lags", "3 lags")
# GDP - BC
GDP_BC_v<-as.vector(GDP_BC)
CV_BC_v<-as.vector(CV_BC)
GDP_BC_v2<-cbind(GDP_BC_v,CV_BC_v)
colnames(GDP_BC_v2)<-c("GDP_BC","CV_BC")
a<- lag(GDP_BC_v,0)
x<- lag(GDP_BC_v,1)
y<- lag(GDP_BC_v,2)
z<- lag(GDP_BC_v,3)
GDP_BC_lags <- cbind(x,y,z)

fitGDP_BC1 <- auto.arima(GDP_BC_v2[4: 63,2], xreg=GDP_BC_lags[4: 63,1], d=0)
fitGDP_BC2 <- auto.arima(GDP_BC_v2[4: 63,2], xreg=GDP_BC_lags[4: 63,1:2], d=0)
fitGDP_BC3 <- auto.arima(GDP_BC_v2[4: 63,2], xreg=GDP_BC_lags[4: 63,1:3], d=0)
AIC_GDP_BC <- cbind(fitGDP_BC1$aic,fitGDP_BC2$aic,fitGDP_BC3$aic)
colnames(AIC_GDP_BC)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - BC
INPC_SUB_BC_v<-as.vector(INPC_SUB_BC)
CV_BC_v<-as.vector(CV_BC)
INPC_SUB_BC_v2<-cbind(INPC_SUB_BC_v,CV_BC_v)
colnames(INPC_SUB_BC_v2)<-c("INPC_SUB_BC","CV_BC")
a<- lag(INPC_SUB_BC_v,0)
x<- lag(INPC_SUB_BC_v,1)
y<- lag(INPC_SUB_BC_v,2)
z<- lag(INPC_SUB_BC_v,3)
INPC_SUB_BC_lags <- cbind(x,y,z)

fitINPC_SUB_BC1 <- auto.arima(INPC_SUB_BC_v2[4: 63,2], xreg=INPC_SUB_BC_lags[4: 63,1], d=0)
fitINPC_SUB_BC2 <- auto.arima(INPC_SUB_BC_v2[4: 63,2], xreg=INPC_SUB_BC_lags[4: 63,1:2], d=0)
fitINPC_SUB_BC3 <- auto.arima(INPC_SUB_BC_v2[4: 63,2], xreg=INPC_SUB_BC_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_BC <- cbind(fitINPC_SUB_BC1$aic,fitINPC_SUB_BC2$aic,fitINPC_SUB_BC3$aic)
colnames(AIC_INPC_SUB_BC)<-c("1 lag","2 lags", "3 lags")
# INPC_E - BC
INPC_E_BC_v<-as.vector(INPC_E_BC)
CV_BC_v<-as.vector(CV_BC)
INPC_E_BC_v2<-cbind(INPC_E_BC_v,CV_BC_v)
colnames(INPC_E_BC_v2)<-c("INPC_E_BC","CV_BC")
a<- lag(INPC_E_BC_v,0)
x<- lag(INPC_E_BC_v,1)
y<- lag(INPC_E_BC_v,2)
z<- lag(INPC_E_BC_v,3)
INPC_E_BC_lags <- cbind(x,y,z)

fitINPC_E_BC1 <- auto.arima(INPC_E_BC_v2[4: 63,2], xreg=INPC_E_BC_lags[4: 63,1], d=0)
fitINPC_E_BC2 <- auto.arima(INPC_E_BC_v2[4: 63,2], xreg=INPC_E_BC_lags[4: 63,1:2], d=0)
fitINPC_E_BC3 <- auto.arima(INPC_E_BC_v2[4: 63,2], xreg=INPC_E_BC_lags[4: 63,1:3], d=0)
AIC_INPC_E_BC <- cbind(fitINPC_E_BC1$aic,fitINPC_E_BC2$aic,fitINPC_E_BC3$aic)
colnames(AIC_INPC_E_BC)<-c("1 lag","2 lags", "3 lags")
# M1 - BC
M1_BC_v<-as.vector(M1_BC)
CV_BC_v<-as.vector(CV_BC)
M1_BC_v2<-cbind(M1_BC_v,CV_BC_v)
colnames(M1_BC_v2)<-c("M1_BC","CV_BC")
a<- lag(M1_BC_v,0)
x<- lag(M1_BC_v,1)
y<- lag(M1_BC_v,2)
z<- lag(M1_BC_v,3)
M1_BC_lags <- cbind(x,y,z)

fitM1_BC1 <- auto.arima(M1_BC_v2[4: 63,2], xreg=M1_BC_lags[4: 63,1], d=0)
fitM1_BC2 <- auto.arima(M1_BC_v2[4: 63,2], xreg=M1_BC_lags[4: 63,1:2], d=0)
fitM1_BC3 <- auto.arima(M1_BC_v2[4: 63,2], xreg=M1_BC_lags[4: 63,1:3], d=0)
AIC_M1_BC <- cbind(fitM1_BC1$aic,fitM1_BC2$aic,fitM1_BC3$aic)
colnames(AIC_M1_BC)<-c("1 lag","2 lags", "3 lags")
# CONF - BC
CONF_BC_v<-as.vector(CONF_BC)
CV_BC_v<-as.vector(CV_BC)
CONF_BC_v2<-cbind(CONF_BC_v,CV_BC_v)
colnames(CONF_BC_v2)<-c("CONF_BC","CV_BC")
a<- lag(CONF_BC_v,0)
x<- lag(CONF_BC_v,1)
y<- lag(CONF_BC_v,2)
z<- lag(CONF_BC_v,3)
CONF_BC_lags <- cbind(x,y,z)

fitCONF_BC1 <- auto.arima(CONF_BC_v2[4: 63,2], xreg=CONF_BC_lags[4: 63,1], d=0)
fitCONF_BC2 <- auto.arima(CONF_BC_v2[4: 63,2], xreg=CONF_BC_lags[4: 63,1:2], d=0)
fitCONF_BC3 <- auto.arima(CONF_BC_v2[4: 63,2], xreg=CONF_BC_lags[4: 63,1:3], d=0)
AIC_CONF_BC <- cbind(fitCONF_BC1$aic,fitCONF_BC2$aic,fitCONF_BC3$aic)
colnames(AIC_CONF_BC)<-c("1 lag","2 lags", "3 lags")

AICs_BC<-rbind(AIC_IPV_BC,AIC_UNEMP_BC,AIC_REM_BC,AIC_GDP_BC,AIC_INPC_SUB_BC,AIC_INPC_E_BC,AIC_M1_BC,AIC_CONF_BC)
rownames(AICs_BC)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_BC
```

```{r}
# BCS
# IPV - BCS
IPV_BCS_v<-as.vector(IPV_BCS)
CV_BCS_v<-as.vector(CV_BCS)
IPV_BCS_v2<-cbind(IPV_BCS_v,CV_BCS_v)
colnames(IPV_BCS_v2)<-c("IPV_BCS","CV_BCS")
a<- lag(IPV_BCS_v,0)
x<- lag(IPV_BCS_v,1)
y<- lag(IPV_BCS_v,2)
z<- lag(IPV_BCS_v,3)
IPV_BCS_lags <- cbind(x,y,z)

fitIPV_BCS1 <- auto.arima(IPV_BCS_v2[4: 63,2], xreg=IPV_BCS_lags[4: 63,1], d=0)
fitIPV_BCS2 <- auto.arima(IPV_BCS_v2[4: 63,2], xreg=IPV_BCS_lags[4: 63,1:2], d=0)
fitIPV_BCS3 <- auto.arima(IPV_BCS_v2[4: 63,2], xreg=IPV_BCS_lags[4: 63,1:3], d=0)
AIC_IPV_BCS <- cbind(fitIPV_BCS1$aic,fitIPV_BCS2$aic,fitIPV_BCS3$aic)
colnames(AIC_IPV_BCS)<-c("1 lag","2 lags", "3 lags")
# UNEMP - BCS
UNEMP_BCS_v<-as.vector(UNEMP_BCS)
CV_BCS_v<-as.vector(CV_BCS)
UNEMP_BCS_v2<-cbind(UNEMP_BCS_v,CV_BCS_v)
colnames(UNEMP_BCS_v2)<-c("UNEMP_BCS","CV_BCS")
a<- lag(UNEMP_BCS_v,0)
x<- lag(UNEMP_BCS_v,1)
y<- lag(UNEMP_BCS_v,2)
z<- lag(UNEMP_BCS_v,3)
UNEMP_BCS_lags <- cbind(x,y,z)

fitUNEMP_BCS1 <- auto.arima(UNEMP_BCS_v2[4: 63,2], xreg=UNEMP_BCS_lags[4: 63,1], d=0)
fitUNEMP_BCS2 <- auto.arima(UNEMP_BCS_v2[4: 63,2], xreg=UNEMP_BCS_lags[4: 63,1:2], d=0)
fitUNEMP_BCS3 <- auto.arima(UNEMP_BCS_v2[4: 63,2], xreg=UNEMP_BCS_lags[4: 63,1:3], d=0)
AIC_UNEMP_BCS <- cbind(fitUNEMP_BCS1$aic,fitUNEMP_BCS2$aic,fitUNEMP_BCS3$aic)
colnames(AIC_UNEMP_BCS)<-c("1 lag","2 lags", "3 lags")
# REM - BCS
REM_BCS_v<-as.vector(REM_BCS)
CV_BCS_v<-as.vector(CV_BCS)
REM_BCS_v2<-cbind(REM_BCS_v,CV_BCS_v)
colnames(REM_BCS_v2)<-c("REM_BCS","CV_BCS")
a<- lag(REM_BCS_v,0)
x<- lag(REM_BCS_v,1)
y<- lag(REM_BCS_v,2)
z<- lag(REM_BCS_v,3)
REM_BCS_lags <- cbind(x,y,z)

fitREM_BCS1 <- auto.arima(REM_BCS_v2[4: 63,2], xreg=REM_BCS_lags[4: 63,1], d=0)
fitREM_BCS2 <- auto.arima(REM_BCS_v2[4: 63,2], xreg=REM_BCS_lags[4: 63,1:2], d=0)
fitREM_BCS3 <- auto.arima(REM_BCS_v2[4: 63,2], xreg=REM_BCS_lags[4: 63,1:3], d=0)
AIC_REM_BCS <- cbind(fitREM_BCS1$aic,fitREM_BCS2$aic,fitREM_BCS3$aic)
colnames(AIC_REM_BCS)<-c("1 lag","2 lags", "3 lags")
# GDP - BCS
GDP_BCS_v<-as.vector(GDP_BCS)
CV_BCS_v<-as.vector(CV_BCS)
GDP_BCS_v2<-cbind(GDP_BCS_v,CV_BCS_v)
colnames(GDP_BCS_v2)<-c("GDP_BCS","CV_BCS")
a<- lag(GDP_BCS_v,0)
x<- lag(GDP_BCS_v,1)
y<- lag(GDP_BCS_v,2)
z<- lag(GDP_BCS_v,3)
GDP_BCS_lags <- cbind(x,y,z)

fitGDP_BCS1 <- auto.arima(GDP_BCS_v2[4: 63,2], xreg=GDP_BCS_lags[4: 63,1], d=0)
fitGDP_BCS2 <- auto.arima(GDP_BCS_v2[4: 63,2], xreg=GDP_BCS_lags[4: 63,1:2], d=0)
fitGDP_BCS3 <- auto.arima(GDP_BCS_v2[4: 63,2], xreg=GDP_BCS_lags[4: 63,1:3], d=0)
AIC_GDP_BCS <- cbind(fitGDP_BCS1$aic,fitGDP_BCS2$aic,fitGDP_BCS3$aic)
colnames(AIC_GDP_BCS)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - BCS
INPC_SUB_BCS_v<-as.vector(INPC_SUB_BCS)
CV_BCS_v<-as.vector(CV_BCS)
INPC_SUB_BCS_v2<-cbind(INPC_SUB_BCS_v,CV_BCS_v)
colnames(INPC_SUB_BCS_v2)<-c("INPC_SUB_BCS","CV_BCS")
a<- lag(INPC_SUB_BCS_v,0)
x<- lag(INPC_SUB_BCS_v,1)
y<- lag(INPC_SUB_BCS_v,2)
z<- lag(INPC_SUB_BCS_v,3)
INPC_SUB_BCS_lags <- cbind(x,y,z)

fitINPC_SUB_BCS1 <- auto.arima(INPC_SUB_BCS_v2[4: 63,2], xreg=INPC_SUB_BCS_lags[4: 63,1], d=0)
fitINPC_SUB_BCS2 <- auto.arima(INPC_SUB_BCS_v2[4: 63,2], xreg=INPC_SUB_BCS_lags[4: 63,1:2], d=0)
fitINPC_SUB_BCS3 <- auto.arima(INPC_SUB_BCS_v2[4: 63,2], xreg=INPC_SUB_BCS_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_BCS <- cbind(fitINPC_SUB_BCS1$aic,fitINPC_SUB_BCS2$aic,fitINPC_SUB_BCS3$aic)
colnames(AIC_INPC_SUB_BCS)<-c("1 lag","2 lags", "3 lags")
# INPC_E - BCS
INPC_E_BCS_v<-as.vector(INPC_E_BCS)
CV_BCS_v<-as.vector(CV_BCS)
INPC_E_BCS_v2<-cbind(INPC_E_BCS_v,CV_BCS_v)
colnames(INPC_E_BCS_v2)<-c("INPC_E_BCS","CV_BCS")
a<- lag(INPC_E_BCS_v,0)
x<- lag(INPC_E_BCS_v,1)
y<- lag(INPC_E_BCS_v,2)
z<- lag(INPC_E_BCS_v,3)
INPC_E_BCS_lags <- cbind(x,y,z)

fitINPC_E_BCS1 <- auto.arima(INPC_E_BCS_v2[4: 63,2], xreg=INPC_E_BCS_lags[4: 63,1], d=0)
fitINPC_E_BCS2 <- auto.arima(INPC_E_BCS_v2[4: 63,2], xreg=INPC_E_BCS_lags[4: 63,1:2], d=0)
fitINPC_E_BCS3 <- auto.arima(INPC_E_BCS_v2[4: 63,2], xreg=INPC_E_BCS_lags[4: 63,1:3], d=0)
AIC_INPC_E_BCS <- cbind(fitINPC_E_BCS1$aic,fitINPC_E_BCS2$aic,fitINPC_E_BCS3$aic)
colnames(AIC_INPC_E_BCS)<-c("1 lag","2 lags", "3 lags")
# M1 - BCS
M1_BCS_v<-as.vector(M1_BCS)
CV_BCS_v<-as.vector(CV_BCS)
M1_BCS_v2<-cbind(M1_BCS_v,CV_BCS_v)
colnames(M1_BCS_v2)<-c("M1_BCS","CV_BCS")
a<- lag(M1_BCS_v,0)
x<- lag(M1_BCS_v,1)
y<- lag(M1_BCS_v,2)
z<- lag(M1_BCS_v,3)
M1_BCS_lags <- cbind(x,y,z)

fitM1_BCS1 <- auto.arima(M1_BCS_v2[4: 63,2], xreg=M1_BCS_lags[4: 63,1], d=0)
fitM1_BCS2 <- auto.arima(M1_BCS_v2[4: 63,2], xreg=M1_BCS_lags[4: 63,1:2], d=0)
fitM1_BCS3 <- auto.arima(M1_BCS_v2[4: 63,2], xreg=M1_BCS_lags[4: 63,1:3], d=0)
AIC_M1_BCS <- cbind(fitM1_BCS1$aic,fitM1_BCS2$aic,fitM1_BCS3$aic)
colnames(AIC_M1_BCS)<-c("1 lag","2 lags", "3 lags")
# CONF - BCS
CONF_BCS_v<-as.vector(CONF_BCS)
CV_BCS_v<-as.vector(CV_BCS)
CONF_BCS_v2<-cbind(CONF_BCS_v,CV_BCS_v)
colnames(CONF_BCS_v2)<-c("CONF_BCS","CV_BCS")
a<- lag(CONF_BCS_v,0)
x<- lag(CONF_BCS_v,1)
y<- lag(CONF_BCS_v,2)
z<- lag(CONF_BCS_v,3)
CONF_BCS_lags <- cbind(x,y,z)

fitCONF_BCS1 <- auto.arima(CONF_BCS_v2[4: 63,2], xreg=CONF_BCS_lags[4: 63,1], d=0)
fitCONF_BCS2 <- auto.arima(CONF_BCS_v2[4: 63,2], xreg=CONF_BCS_lags[4: 63,1:2], d=0)
fitCONF_BCS3 <- auto.arima(CONF_BCS_v2[4: 63,2], xreg=CONF_BCS_lags[4: 63,1:3], d=0)
AIC_CONF_BCS <- cbind(fitCONF_BCS1$aic,fitCONF_BCS2$aic,fitCONF_BCS3$aic)
colnames(AIC_CONF_BCS)<-c("1 lag","2 lags", "3 lags")

AICs_BCS<-rbind(AIC_IPV_BCS,AIC_UNEMP_BCS,AIC_REM_BCS,AIC_GDP_BCS,AIC_INPC_SUB_BCS,AIC_INPC_E_BCS,AIC_M1_BCS,AIC_CONF_BCS)
rownames(AICs_BCS)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_BCS
```

```{r}
# CAMP
# IPV - CAMP
IPV_CAMP_v<-as.vector(IPV_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
IPV_CAMP_v2<-cbind(IPV_CAMP_v,CV_CAMP_v)
colnames(IPV_CAMP_v2)<-c("IPV_CAMP","CV_CAMP")
a<- lag(IPV_CAMP_v,0)
x<- lag(IPV_CAMP_v,1)
y<- lag(IPV_CAMP_v,2)
z<- lag(IPV_CAMP_v,3)
IPV_CAMP_lags <- cbind(x,y,z)

fitIPV_CAMP1 <- auto.arima(IPV_CAMP_v2[4: 63,2], xreg=IPV_CAMP_lags[4: 63,1], d=0)
fitIPV_CAMP2 <- auto.arima(IPV_CAMP_v2[4: 63,2], xreg=IPV_CAMP_lags[4: 63,1:2], d=0)
fitIPV_CAMP3 <- auto.arima(IPV_CAMP_v2[4: 63,2], xreg=IPV_CAMP_lags[4: 63,1:3], d=0)
AIC_IPV_CAMP <- cbind(fitIPV_CAMP1$aic,fitIPV_CAMP2$aic,fitIPV_CAMP3$aic)
colnames(AIC_IPV_CAMP)<-c("1 lag","2 lags", "3 lags")
# UNEMP - CAMP
UNEMP_CAMP_v<-as.vector(UNEMP_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
UNEMP_CAMP_v2<-cbind(UNEMP_CAMP_v,CV_CAMP_v)
colnames(UNEMP_CAMP_v2)<-c("UNEMP_CAMP","CV_CAMP")
a<- lag(UNEMP_CAMP_v,0)
x<- lag(UNEMP_CAMP_v,1)
y<- lag(UNEMP_CAMP_v,2)
z<- lag(UNEMP_CAMP_v,3)
UNEMP_CAMP_lags <- cbind(x,y,z)

fitUNEMP_CAMP1 <- auto.arima(UNEMP_CAMP_v2[4: 63,2], xreg=UNEMP_CAMP_lags[4: 63,1], d=0)
fitUNEMP_CAMP2 <- auto.arima(UNEMP_CAMP_v2[4: 63,2], xreg=UNEMP_CAMP_lags[4: 63,1:2], d=0)
fitUNEMP_CAMP3 <- auto.arima(UNEMP_CAMP_v2[4: 63,2], xreg=UNEMP_CAMP_lags[4: 63,1:3], d=0)
AIC_UNEMP_CAMP <- cbind(fitUNEMP_CAMP1$aic,fitUNEMP_CAMP2$aic,fitUNEMP_CAMP3$aic)
colnames(AIC_UNEMP_CAMP)<-c("1 lag","2 lags", "3 lags")
# REM - CAMP
REM_CAMP_v<-as.vector(REM_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
REM_CAMP_v2<-cbind(REM_CAMP_v,CV_CAMP_v)
colnames(REM_CAMP_v2)<-c("REM_CAMP","CV_CAMP")
a<- lag(REM_CAMP_v,0)
x<- lag(REM_CAMP_v,1)
y<- lag(REM_CAMP_v,2)
z<- lag(REM_CAMP_v,3)
REM_CAMP_lags <- cbind(x,y,z)

fitREM_CAMP1 <- auto.arima(REM_CAMP_v2[4: 63,2], xreg=REM_CAMP_lags[4: 63,1], d=0)
fitREM_CAMP2 <- auto.arima(REM_CAMP_v2[4: 63,2], xreg=REM_CAMP_lags[4: 63,1:2], d=0)
fitREM_CAMP3 <- auto.arima(REM_CAMP_v2[4: 63,2], xreg=REM_CAMP_lags[4: 63,1:3], d=0)
AIC_REM_CAMP <- cbind(fitREM_CAMP1$aic,fitREM_CAMP2$aic,fitREM_CAMP3$aic)
colnames(AIC_REM_CAMP)<-c("1 lag","2 lags", "3 lags")
# GDP - CAMP
GDP_CAMP_v<-as.vector(GDP_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
GDP_CAMP_v2<-cbind(GDP_CAMP_v,CV_CAMP_v)
colnames(GDP_CAMP_v2)<-c("GDP_CAMP","CV_CAMP")
a<- lag(GDP_CAMP_v,0)
x<- lag(GDP_CAMP_v,1)
y<- lag(GDP_CAMP_v,2)
z<- lag(GDP_CAMP_v,3)
GDP_CAMP_lags <- cbind(x,y,z)

fitGDP_CAMP1 <- auto.arima(GDP_CAMP_v2[4: 63,2], xreg=GDP_CAMP_lags[4: 63,1], d=0)
fitGDP_CAMP2 <- auto.arima(GDP_CAMP_v2[4: 63,2], xreg=GDP_CAMP_lags[4: 63,1:2], d=0)
fitGDP_CAMP3 <- auto.arima(GDP_CAMP_v2[4: 63,2], xreg=GDP_CAMP_lags[4: 63,1:3], d=0)
AIC_GDP_CAMP <- cbind(fitGDP_CAMP1$aic,fitGDP_CAMP2$aic,fitGDP_CAMP3$aic)
colnames(AIC_GDP_CAMP)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - CAMP
INPC_SUB_CAMP_v<-as.vector(INPC_SUB_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
INPC_SUB_CAMP_v2<-cbind(INPC_SUB_CAMP_v,CV_CAMP_v)
colnames(INPC_SUB_CAMP_v2)<-c("INPC_SUB_CAMP","CV_CAMP")
a<- lag(INPC_SUB_CAMP_v,0)
x<- lag(INPC_SUB_CAMP_v,1)
y<- lag(INPC_SUB_CAMP_v,2)
z<- lag(INPC_SUB_CAMP_v,3)
INPC_SUB_CAMP_lags <- cbind(x,y,z)

fitINPC_SUB_CAMP1 <- auto.arima(INPC_SUB_CAMP_v2[4: 63,2], xreg=INPC_SUB_CAMP_lags[4: 63,1], d=0)
fitINPC_SUB_CAMP2 <- auto.arima(INPC_SUB_CAMP_v2[4: 63,2], xreg=INPC_SUB_CAMP_lags[4: 63,1:2], d=0)
fitINPC_SUB_CAMP3 <- auto.arima(INPC_SUB_CAMP_v2[4: 63,2], xreg=INPC_SUB_CAMP_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_CAMP <- cbind(fitINPC_SUB_CAMP1$aic,fitINPC_SUB_CAMP2$aic,fitINPC_SUB_CAMP3$aic)
colnames(AIC_INPC_SUB_CAMP)<-c("1 lag","2 lags", "3 lags")
# INPC_E - CAMP
INPC_E_CAMP_v<-as.vector(INPC_E_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
INPC_E_CAMP_v2<-cbind(INPC_E_CAMP_v,CV_CAMP_v)
colnames(INPC_E_CAMP_v2)<-c("INPC_E_CAMP","CV_CAMP")
a<- lag(INPC_E_CAMP_v,0)
x<- lag(INPC_E_CAMP_v,1)
y<- lag(INPC_E_CAMP_v,2)
z<- lag(INPC_E_CAMP_v,3)
INPC_E_CAMP_lags <- cbind(x,y,z)

fitINPC_E_CAMP1 <- auto.arima(INPC_E_CAMP_v2[4: 63,2], xreg=INPC_E_CAMP_lags[4: 63,1], d=0)
fitINPC_E_CAMP2 <- auto.arima(INPC_E_CAMP_v2[4: 63,2], xreg=INPC_E_CAMP_lags[4: 63,1:2], d=0)
fitINPC_E_CAMP3 <- auto.arima(INPC_E_CAMP_v2[4: 63,2], xreg=INPC_E_CAMP_lags[4: 63,1:3], d=0)
AIC_INPC_E_CAMP <- cbind(fitINPC_E_CAMP1$aic,fitINPC_E_CAMP2$aic,fitINPC_E_CAMP3$aic)
colnames(AIC_INPC_E_CAMP)<-c("1 lag","2 lags", "3 lags")
# M1 - CAMP
M1_CAMP_v<-as.vector(M1_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
M1_CAMP_v2<-cbind(M1_CAMP_v,CV_CAMP_v)
colnames(M1_CAMP_v2)<-c("M1_CAMP","CV_CAMP")
a<- lag(M1_CAMP_v,0)
x<- lag(M1_CAMP_v,1)
y<- lag(M1_CAMP_v,2)
z<- lag(M1_CAMP_v,3)
M1_CAMP_lags <- cbind(x,y,z)

fitM1_CAMP1 <- auto.arima(M1_CAMP_v2[4: 63,2], xreg=M1_CAMP_lags[4: 63,1], d=0)
fitM1_CAMP2 <- auto.arima(M1_CAMP_v2[4: 63,2], xreg=M1_CAMP_lags[4: 63,1:2], d=0)
fitM1_CAMP3 <- auto.arima(M1_CAMP_v2[4: 63,2], xreg=M1_CAMP_lags[4: 63,1:3], d=0)
AIC_M1_CAMP <- cbind(fitM1_CAMP1$aic,fitM1_CAMP2$aic,fitM1_CAMP3$aic)
colnames(AIC_M1_CAMP)<-c("1 lag","2 lags", "3 lags")
# CONF - CAMP
CONF_CAMP_v<-as.vector(CONF_CAMP)
CV_CAMP_v<-as.vector(CV_CAMP)
CONF_CAMP_v2<-cbind(CONF_CAMP_v,CV_CAMP_v)
colnames(CONF_CAMP_v2)<-c("CONF_CAMP","CV_CAMP")
a<- lag(CONF_CAMP_v,0)
x<- lag(CONF_CAMP_v,1)
y<- lag(CONF_CAMP_v,2)
z<- lag(CONF_CAMP_v,3)
CONF_CAMP_lags <- cbind(x,y,z)

fitCONF_CAMP1 <- auto.arima(CONF_CAMP_v2[4: 63,2], xreg=CONF_CAMP_lags[4: 63,1], d=0)
fitCONF_CAMP2 <- auto.arima(CONF_CAMP_v2[4: 63,2], xreg=CONF_CAMP_lags[4: 63,1:2], d=0)
fitCONF_CAMP3 <- auto.arima(CONF_CAMP_v2[4: 63,2], xreg=CONF_CAMP_lags[4: 63,1:3], d=0)
AIC_CONF_CAMP <- cbind(fitCONF_CAMP1$aic,fitCONF_CAMP2$aic,fitCONF_CAMP3$aic)
colnames(AIC_CONF_CAMP)<-c("1 lag","2 lags", "3 lags")

AICs_CAMP<-rbind(AIC_IPV_CAMP,AIC_UNEMP_CAMP,AIC_REM_CAMP,AIC_GDP_CAMP,AIC_INPC_SUB_CAMP,AIC_INPC_E_CAMP,AIC_M1_CAMP,AIC_CONF_CAMP)
rownames(AICs_CAMP)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_CAMP
```

```{r}
# CDMX
# IPV - CDMX
IPV_CDMX_v<-as.vector(IPV_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
IPV_CDMX_v2<-cbind(IPV_CDMX_v,CV_CDMX_v)
colnames(IPV_CDMX_v2)<-c("IPV_CDMX","CV_CDMX")
a<- lag(IPV_CDMX_v,0)
x<- lag(IPV_CDMX_v,1)
y<- lag(IPV_CDMX_v,2)
z<- lag(IPV_CDMX_v,3)
IPV_CDMX_lags <- cbind(x,y,z)

fitIPV_CDMX1 <- auto.arima(IPV_CDMX_v2[4: 63,2], xreg=IPV_CDMX_lags[4: 63,1], d=0)
fitIPV_CDMX2 <- auto.arima(IPV_CDMX_v2[4: 63,2], xreg=IPV_CDMX_lags[4: 63,1:2], d=0)
fitIPV_CDMX3 <- auto.arima(IPV_CDMX_v2[4: 63,2], xreg=IPV_CDMX_lags[4: 63,1:3], d=0)
AIC_IPV_CDMX <- cbind(fitIPV_CDMX1$aic,fitIPV_CDMX2$aic,fitIPV_CDMX3$aic)
colnames(AIC_IPV_CDMX)<-c("1 lag","2 lags", "3 lags")
# UNEMP - CDMX
UNEMP_CDMX_v<-as.vector(UNEMP_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
UNEMP_CDMX_v2<-cbind(UNEMP_CDMX_v,CV_CDMX_v)
colnames(UNEMP_CDMX_v2)<-c("UNEMP_CDMX","CV_CDMX")
a<- lag(UNEMP_CDMX_v,0)
x<- lag(UNEMP_CDMX_v,1)
y<- lag(UNEMP_CDMX_v,2)
z<- lag(UNEMP_CDMX_v,3)
UNEMP_CDMX_lags <- cbind(x,y,z)

fitUNEMP_CDMX1 <- auto.arima(UNEMP_CDMX_v2[4: 63,2], xreg=UNEMP_CDMX_lags[4: 63,1], d=0)
fitUNEMP_CDMX2 <- auto.arima(UNEMP_CDMX_v2[4: 63,2], xreg=UNEMP_CDMX_lags[4: 63,1:2], d=0)
fitUNEMP_CDMX3 <- auto.arima(UNEMP_CDMX_v2[4: 63,2], xreg=UNEMP_CDMX_lags[4: 63,1:3], d=0)
AIC_UNEMP_CDMX <- cbind(fitUNEMP_CDMX1$aic,fitUNEMP_CDMX2$aic,fitUNEMP_CDMX3$aic)
colnames(AIC_UNEMP_CDMX)<-c("1 lag","2 lags", "3 lags")
# REM - CDMX
REM_CDMX_v<-as.vector(REM_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
REM_CDMX_v2<-cbind(REM_CDMX_v,CV_CDMX_v)
colnames(REM_CDMX_v2)<-c("REM_CDMX","CV_CDMX")
a<- lag(REM_CDMX_v,0)
x<- lag(REM_CDMX_v,1)
y<- lag(REM_CDMX_v,2)
z<- lag(REM_CDMX_v,3)
REM_CDMX_lags <- cbind(x,y,z)

fitREM_CDMX1 <- auto.arima(REM_CDMX_v2[4: 63,2], xreg=REM_CDMX_lags[4: 63,1], d=0)
fitREM_CDMX2 <- auto.arima(REM_CDMX_v2[4: 63,2], xreg=REM_CDMX_lags[4: 63,1:2], d=0)
fitREM_CDMX3 <- auto.arima(REM_CDMX_v2[4: 63,2], xreg=REM_CDMX_lags[4: 63,1:3], d=0)
AIC_REM_CDMX <- cbind(fitREM_CDMX1$aic,fitREM_CDMX2$aic,fitREM_CDMX3$aic)
colnames(AIC_REM_CDMX)<-c("1 lag","2 lags", "3 lags")
# GDP - CDMX
GDP_CDMX_v<-as.vector(GDP_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
GDP_CDMX_v2<-cbind(GDP_CDMX_v,CV_CDMX_v)
colnames(GDP_CDMX_v2)<-c("GDP_CDMX","CV_CDMX")
a<- lag(GDP_CDMX_v,0)
x<- lag(GDP_CDMX_v,1)
y<- lag(GDP_CDMX_v,2)
z<- lag(GDP_CDMX_v,3)
GDP_CDMX_lags <- cbind(x,y,z)

fitGDP_CDMX1 <- auto.arima(GDP_CDMX_v2[4: 63,2], xreg=GDP_CDMX_lags[4: 63,1], d=0)
fitGDP_CDMX2 <- auto.arima(GDP_CDMX_v2[4: 63,2], xreg=GDP_CDMX_lags[4: 63,1:2], d=0)
fitGDP_CDMX3 <- auto.arima(GDP_CDMX_v2[4: 63,2], xreg=GDP_CDMX_lags[4: 63,1:3], d=0)
AIC_GDP_CDMX <- cbind(fitGDP_CDMX1$aic,fitGDP_CDMX2$aic,fitGDP_CDMX3$aic)
colnames(AIC_GDP_CDMX)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - CDMX
INPC_SUB_CDMX_v<-as.vector(INPC_SUB_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
INPC_SUB_CDMX_v2<-cbind(INPC_SUB_CDMX_v,CV_CDMX_v)
colnames(INPC_SUB_CDMX_v2)<-c("INPC_SUB_CDMX","CV_CDMX")
a<- lag(INPC_SUB_CDMX_v,0)
x<- lag(INPC_SUB_CDMX_v,1)
y<- lag(INPC_SUB_CDMX_v,2)
z<- lag(INPC_SUB_CDMX_v,3)
INPC_SUB_CDMX_lags <- cbind(x,y,z)

fitINPC_SUB_CDMX1 <- auto.arima(INPC_SUB_CDMX_v2[4: 63,2], xreg=INPC_SUB_CDMX_lags[4: 63,1], d=0)
fitINPC_SUB_CDMX2 <- auto.arima(INPC_SUB_CDMX_v2[4: 63,2], xreg=INPC_SUB_CDMX_lags[4: 63,1:2], d=0)
fitINPC_SUB_CDMX3 <- auto.arima(INPC_SUB_CDMX_v2[4: 63,2], xreg=INPC_SUB_CDMX_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_CDMX <- cbind(fitINPC_SUB_CDMX1$aic,fitINPC_SUB_CDMX2$aic,fitINPC_SUB_CDMX3$aic)
colnames(AIC_INPC_SUB_CDMX)<-c("1 lag","2 lags", "3 lags")
# INPC_E - CDMX
INPC_E_CDMX_v<-as.vector(INPC_E_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
INPC_E_CDMX_v2<-cbind(INPC_E_CDMX_v,CV_CDMX_v)
colnames(INPC_E_CDMX_v2)<-c("INPC_E_CDMX","CV_CDMX")
a<- lag(INPC_E_CDMX_v,0)
x<- lag(INPC_E_CDMX_v,1)
y<- lag(INPC_E_CDMX_v,2)
z<- lag(INPC_E_CDMX_v,3)
INPC_E_CDMX_lags <- cbind(x,y,z)

fitINPC_E_CDMX1 <- auto.arima(INPC_E_CDMX_v2[4: 63,2], xreg=INPC_E_CDMX_lags[4: 63,1], d=0)
fitINPC_E_CDMX2 <- auto.arima(INPC_E_CDMX_v2[4: 63,2], xreg=INPC_E_CDMX_lags[4: 63,1:2], d=0)
fitINPC_E_CDMX3 <- auto.arima(INPC_E_CDMX_v2[4: 63,2], xreg=INPC_E_CDMX_lags[4: 63,1:3], d=0)
AIC_INPC_E_CDMX <- cbind(fitINPC_E_CDMX1$aic,fitINPC_E_CDMX2$aic,fitINPC_E_CDMX3$aic)
colnames(AIC_INPC_E_CDMX)<-c("1 lag","2 lags", "3 lags")
# M1 - CDMX
M1_CDMX_v<-as.vector(M1_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
M1_CDMX_v2<-cbind(M1_CDMX_v,CV_CDMX_v)
colnames(M1_CDMX_v2)<-c("M1_CDMX","CV_CDMX")
a<- lag(M1_CDMX_v,0)
x<- lag(M1_CDMX_v,1)
y<- lag(M1_CDMX_v,2)
z<- lag(M1_CDMX_v,3)
M1_CDMX_lags <- cbind(x,y,z)

fitM1_CDMX1 <- auto.arima(M1_CDMX_v2[4: 63,2], xreg=M1_CDMX_lags[4: 63,1], d=0)
fitM1_CDMX2 <- auto.arima(M1_CDMX_v2[4: 63,2], xreg=M1_CDMX_lags[4: 63,1:2], d=0)
fitM1_CDMX3 <- auto.arima(M1_CDMX_v2[4: 63,2], xreg=M1_CDMX_lags[4: 63,1:3], d=0)
AIC_M1_CDMX <- cbind(fitM1_CDMX1$aic,fitM1_CDMX2$aic,fitM1_CDMX3$aic)
colnames(AIC_M1_CDMX)<-c("1 lag","2 lags", "3 lags")
# CONF - CDMX
CONF_CDMX_v<-as.vector(CONF_CDMX)
CV_CDMX_v<-as.vector(CV_CDMX)
CONF_CDMX_v2<-cbind(CONF_CDMX_v,CV_CDMX_v)
colnames(CONF_CDMX_v2)<-c("CONF_CDMX","CV_CDMX")
a<- lag(CONF_CDMX_v,0)
x<- lag(CONF_CDMX_v,1)
y<- lag(CONF_CDMX_v,2)
z<- lag(CONF_CDMX_v,3)
CONF_CDMX_lags <- cbind(x,y,z)

fitCONF_CDMX1 <- auto.arima(CONF_CDMX_v2[4: 63,2], xreg=CONF_CDMX_lags[4: 63,1], d=0)
fitCONF_CDMX2 <- auto.arima(CONF_CDMX_v2[4: 63,2], xreg=CONF_CDMX_lags[4: 63,1:2], d=0)
fitCONF_CDMX3 <- auto.arima(CONF_CDMX_v2[4: 63,2], xreg=CONF_CDMX_lags[4: 63,1:3], d=0)
AIC_CONF_CDMX <- cbind(fitCONF_CDMX1$aic,fitCONF_CDMX2$aic,fitCONF_CDMX3$aic)
colnames(AIC_CONF_CDMX)<-c("1 lag","2 lags", "3 lags")

AICs_CDMX<-rbind(AIC_IPV_CDMX,AIC_UNEMP_CDMX,AIC_REM_CDMX,AIC_GDP_CDMX,AIC_INPC_SUB_CDMX,AIC_INPC_E_CDMX,AIC_M1_CDMX,AIC_CONF_CDMX)
rownames(AICs_CDMX)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_CDMX
```

```{r}
# CHIH
# IPV - CHIH
IPV_CHIH_v<-as.vector(IPV_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
IPV_CHIH_v2<-cbind(IPV_CHIH_v,CV_CHIH_v)
colnames(IPV_CHIH_v2)<-c("IPV_CHIH","CV_CHIH")
a<- lag(IPV_CHIH_v,0)
x<- lag(IPV_CHIH_v,1)
y<- lag(IPV_CHIH_v,2)
z<- lag(IPV_CHIH_v,3)
IPV_CHIH_lags <- cbind(x,y,z)

fitIPV_CHIH1 <- auto.arima(IPV_CHIH_v2[4: 63,2], xreg=IPV_CHIH_lags[4: 63,1], d=0)
fitIPV_CHIH2 <- auto.arima(IPV_CHIH_v2[4: 63,2], xreg=IPV_CHIH_lags[4: 63,1:2], d=0)
fitIPV_CHIH3 <- auto.arima(IPV_CHIH_v2[4: 63,2], xreg=IPV_CHIH_lags[4: 63,1:3], d=0)
AIC_IPV_CHIH <- cbind(fitIPV_CHIH1$aic,fitIPV_CHIH2$aic,fitIPV_CHIH3$aic)
colnames(AIC_IPV_CHIH)<-c("1 lag","2 lags", "3 lags")
# UNEMP - CHIH
UNEMP_CHIH_v<-as.vector(UNEMP_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
UNEMP_CHIH_v2<-cbind(UNEMP_CHIH_v,CV_CHIH_v)
colnames(UNEMP_CHIH_v2)<-c("UNEMP_CHIH","CV_CHIH")
a<- lag(UNEMP_CHIH_v,0)
x<- lag(UNEMP_CHIH_v,1)
y<- lag(UNEMP_CHIH_v,2)
z<- lag(UNEMP_CHIH_v,3)
UNEMP_CHIH_lags <- cbind(x,y,z)

fitUNEMP_CHIH1 <- auto.arima(UNEMP_CHIH_v2[4: 63,2], xreg=UNEMP_CHIH_lags[4: 63,1], d=0)
fitUNEMP_CHIH2 <- auto.arima(UNEMP_CHIH_v2[4: 63,2], xreg=UNEMP_CHIH_lags[4: 63,1:2], d=0)
fitUNEMP_CHIH3 <- auto.arima(UNEMP_CHIH_v2[4: 63,2], xreg=UNEMP_CHIH_lags[4: 63,1:3], d=0)
AIC_UNEMP_CHIH <- cbind(fitUNEMP_CHIH1$aic,fitUNEMP_CHIH2$aic,fitUNEMP_CHIH3$aic)
colnames(AIC_UNEMP_CHIH)<-c("1 lag","2 lags", "3 lags")
# REM - CHIH
REM_CHIH_v<-as.vector(REM_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
REM_CHIH_v2<-cbind(REM_CHIH_v,CV_CHIH_v)
colnames(REM_CHIH_v2)<-c("REM_CHIH","CV_CHIH")
a<- lag(REM_CHIH_v,0)
x<- lag(REM_CHIH_v,1)
y<- lag(REM_CHIH_v,2)
z<- lag(REM_CHIH_v,3)
REM_CHIH_lags <- cbind(x,y,z)

fitREM_CHIH1 <- auto.arima(REM_CHIH_v2[4: 63,2], xreg=REM_CHIH_lags[4: 63,1], d=0)
fitREM_CHIH2 <- auto.arima(REM_CHIH_v2[4: 63,2], xreg=REM_CHIH_lags[4: 63,1:2], d=0)
fitREM_CHIH3 <- auto.arima(REM_CHIH_v2[4: 63,2], xreg=REM_CHIH_lags[4: 63,1:3], d=0)
AIC_REM_CHIH <- cbind(fitREM_CHIH1$aic,fitREM_CHIH2$aic,fitREM_CHIH3$aic)
colnames(AIC_REM_CHIH)<-c("1 lag","2 lags", "3 lags")
# GDP - CHIH
GDP_CHIH_v<-as.vector(GDP_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
GDP_CHIH_v2<-cbind(GDP_CHIH_v,CV_CHIH_v)
colnames(GDP_CHIH_v2)<-c("GDP_CHIH","CV_CHIH")
a<- lag(GDP_CHIH_v,0)
x<- lag(GDP_CHIH_v,1)
y<- lag(GDP_CHIH_v,2)
z<- lag(GDP_CHIH_v,3)
GDP_CHIH_lags <- cbind(x,y,z)

fitGDP_CHIH1 <- auto.arima(GDP_CHIH_v2[4: 63,2], xreg=GDP_CHIH_lags[4: 63,1], d=0)
fitGDP_CHIH2 <- auto.arima(GDP_CHIH_v2[4: 63,2], xreg=GDP_CHIH_lags[4: 63,1:2], d=0)
fitGDP_CHIH3 <- auto.arima(GDP_CHIH_v2[4: 63,2], xreg=GDP_CHIH_lags[4: 63,1:3], d=0)
AIC_GDP_CHIH <- cbind(fitGDP_CHIH1$aic,fitGDP_CHIH2$aic,fitGDP_CHIH3$aic)
colnames(AIC_GDP_CHIH)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - CHIH
INPC_SUB_CHIH_v<-as.vector(INPC_SUB_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
INPC_SUB_CHIH_v2<-cbind(INPC_SUB_CHIH_v,CV_CHIH_v)
colnames(INPC_SUB_CHIH_v2)<-c("INPC_SUB_CHIH","CV_CHIH")
a<- lag(INPC_SUB_CHIH_v,0)
x<- lag(INPC_SUB_CHIH_v,1)
y<- lag(INPC_SUB_CHIH_v,2)
z<- lag(INPC_SUB_CHIH_v,3)
INPC_SUB_CHIH_lags <- cbind(x,y,z)

fitINPC_SUB_CHIH1 <- auto.arima(INPC_SUB_CHIH_v2[4: 63,2], xreg=INPC_SUB_CHIH_lags[4: 63,1], d=0)
fitINPC_SUB_CHIH2 <- auto.arima(INPC_SUB_CHIH_v2[4: 63,2], xreg=INPC_SUB_CHIH_lags[4: 63,1:2], d=0)
fitINPC_SUB_CHIH3 <- auto.arima(INPC_SUB_CHIH_v2[4: 63,2], xreg=INPC_SUB_CHIH_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_CHIH <- cbind(fitINPC_SUB_CHIH1$aic,fitINPC_SUB_CHIH2$aic,fitINPC_SUB_CHIH3$aic)
colnames(AIC_INPC_SUB_CHIH)<-c("1 lag","2 lags", "3 lags")
# INPC_E - CHIH
INPC_E_CHIH_v<-as.vector(INPC_E_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
INPC_E_CHIH_v2<-cbind(INPC_E_CHIH_v,CV_CHIH_v)
colnames(INPC_E_CHIH_v2)<-c("INPC_E_CHIH","CV_CHIH")
a<- lag(INPC_E_CHIH_v,0)
x<- lag(INPC_E_CHIH_v,1)
y<- lag(INPC_E_CHIH_v,2)
z<- lag(INPC_E_CHIH_v,3)
INPC_E_CHIH_lags <- cbind(x,y,z)

fitINPC_E_CHIH1 <- auto.arima(INPC_E_CHIH_v2[4: 63,2], xreg=INPC_E_CHIH_lags[4: 63,1], d=0)
fitINPC_E_CHIH2 <- auto.arima(INPC_E_CHIH_v2[4: 63,2], xreg=INPC_E_CHIH_lags[4: 63,1:2], d=0)
fitINPC_E_CHIH3 <- auto.arima(INPC_E_CHIH_v2[4: 63,2], xreg=INPC_E_CHIH_lags[4: 63,1:3], d=0)
AIC_INPC_E_CHIH <- cbind(fitINPC_E_CHIH1$aic,fitINPC_E_CHIH2$aic,fitINPC_E_CHIH3$aic)
colnames(AIC_INPC_E_CHIH)<-c("1 lag","2 lags", "3 lags")
# M1 - CHIH
M1_CHIH_v<-as.vector(M1_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
M1_CHIH_v2<-cbind(M1_CHIH_v,CV_CHIH_v)
colnames(M1_CHIH_v2)<-c("M1_CHIH","CV_CHIH")
a<- lag(M1_CHIH_v,0)
x<- lag(M1_CHIH_v,1)
y<- lag(M1_CHIH_v,2)
z<- lag(M1_CHIH_v,3)
M1_CHIH_lags <- cbind(x,y,z)

fitM1_CHIH1 <- auto.arima(M1_CHIH_v2[4: 63,2], xreg=M1_CHIH_lags[4: 63,1], d=0)
fitM1_CHIH2 <- auto.arima(M1_CHIH_v2[4: 63,2], xreg=M1_CHIH_lags[4: 63,1:2], d=0)
fitM1_CHIH3 <- auto.arima(M1_CHIH_v2[4: 63,2], xreg=M1_CHIH_lags[4: 63,1:3], d=0)
AIC_M1_CHIH <- cbind(fitM1_CHIH1$aic,fitM1_CHIH2$aic,fitM1_CHIH3$aic)
colnames(AIC_M1_CHIH)<-c("1 lag","2 lags", "3 lags")
# CONF - CHIH
CONF_CHIH_v<-as.vector(CONF_CHIH)
CV_CHIH_v<-as.vector(CV_CHIH)
CONF_CHIH_v2<-cbind(CONF_CHIH_v,CV_CHIH_v)
colnames(CONF_CHIH_v2)<-c("CONF_CHIH","CV_CHIH")
a<- lag(CONF_CHIH_v,0)
x<- lag(CONF_CHIH_v,1)
y<- lag(CONF_CHIH_v,2)
z<- lag(CONF_CHIH_v,3)
CONF_CHIH_lags <- cbind(x,y,z)

fitCONF_CHIH1 <- auto.arima(CONF_CHIH_v2[4: 63,2], xreg=CONF_CHIH_lags[4: 63,1], d=0)
fitCONF_CHIH2 <- auto.arima(CONF_CHIH_v2[4: 63,2], xreg=CONF_CHIH_lags[4: 63,1:2], d=0)
fitCONF_CHIH3 <- auto.arima(CONF_CHIH_v2[4: 63,2], xreg=CONF_CHIH_lags[4: 63,1:3], d=0)
AIC_CONF_CHIH <- cbind(fitCONF_CHIH1$aic,fitCONF_CHIH2$aic,fitCONF_CHIH3$aic)
colnames(AIC_CONF_CHIH)<-c("1 lag","2 lags", "3 lags")

AICs_CHIH<-rbind(AIC_IPV_CHIH,AIC_UNEMP_CHIH,AIC_REM_CHIH,AIC_GDP_CHIH,AIC_INPC_SUB_CHIH,AIC_INPC_E_CHIH,AIC_M1_CHIH,AIC_CONF_CHIH)
rownames(AICs_CHIH)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_CHIH
```

```{r}
# CHIS
# IPV - CHIS
IPV_CHIS_v<-as.vector(IPV_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
IPV_CHIS_v2<-cbind(IPV_CHIS_v,CV_CHIS_v)
colnames(IPV_CHIS_v2)<-c("IPV_CHIS","CV_CHIS")
a<- lag(IPV_CHIS_v,0)
x<- lag(IPV_CHIS_v,1)
y<- lag(IPV_CHIS_v,2)
z<- lag(IPV_CHIS_v,3)
IPV_CHIS_lags <- cbind(x,y,z)

fitIPV_CHIS1 <- auto.arima(IPV_CHIS_v2[4: 63,2], xreg=IPV_CHIS_lags[4: 63,1], d=0)
fitIPV_CHIS2 <- auto.arima(IPV_CHIS_v2[4: 63,2], xreg=IPV_CHIS_lags[4: 63,1:2], d=0)
fitIPV_CHIS3 <- auto.arima(IPV_CHIS_v2[4: 63,2], xreg=IPV_CHIS_lags[4: 63,1:3], d=0)
AIC_IPV_CHIS <- cbind(fitIPV_CHIS1$aic,fitIPV_CHIS2$aic,fitIPV_CHIS3$aic)
colnames(AIC_IPV_CHIS)<-c("1 lag","2 lags", "3 lags")
# UNEMP - CHIS
UNEMP_CHIS_v<-as.vector(UNEMP_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
UNEMP_CHIS_v2<-cbind(UNEMP_CHIS_v,CV_CHIS_v)
colnames(UNEMP_CHIS_v2)<-c("UNEMP_CHIS","CV_CHIS")
a<- lag(UNEMP_CHIS_v,0)
x<- lag(UNEMP_CHIS_v,1)
y<- lag(UNEMP_CHIS_v,2)
z<- lag(UNEMP_CHIS_v,3)
UNEMP_CHIS_lags <- cbind(x,y,z)

fitUNEMP_CHIS1 <- auto.arima(UNEMP_CHIS_v2[4: 63,2], xreg=UNEMP_CHIS_lags[4: 63,1], d=0)
fitUNEMP_CHIS2 <- auto.arima(UNEMP_CHIS_v2[4: 63,2], xreg=UNEMP_CHIS_lags[4: 63,1:2], d=0)
fitUNEMP_CHIS3 <- auto.arima(UNEMP_CHIS_v2[4: 63,2], xreg=UNEMP_CHIS_lags[4: 63,1:3], d=0)
AIC_UNEMP_CHIS <- cbind(fitUNEMP_CHIS1$aic,fitUNEMP_CHIS2$aic,fitUNEMP_CHIS3$aic)
colnames(AIC_UNEMP_CHIS)<-c("1 lag","2 lags", "3 lags")
# REM - CHIS
REM_CHIS_v<-as.vector(REM_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
REM_CHIS_v2<-cbind(REM_CHIS_v,CV_CHIS_v)
colnames(REM_CHIS_v2)<-c("REM_CHIS","CV_CHIS")
a<- lag(REM_CHIS_v,0)
x<- lag(REM_CHIS_v,1)
y<- lag(REM_CHIS_v,2)
z<- lag(REM_CHIS_v,3)
REM_CHIS_lags <- cbind(x,y,z)

fitREM_CHIS1 <- auto.arima(REM_CHIS_v2[4: 63,2], xreg=REM_CHIS_lags[4: 63,1], d=0)
fitREM_CHIS2 <- auto.arima(REM_CHIS_v2[4: 63,2], xreg=REM_CHIS_lags[4: 63,1:2], d=0)
fitREM_CHIS3 <- auto.arima(REM_CHIS_v2[4: 63,2], xreg=REM_CHIS_lags[4: 63,1:3], d=0)
AIC_REM_CHIS <- cbind(fitREM_CHIS1$aic,fitREM_CHIS2$aic,fitREM_CHIS3$aic)
colnames(AIC_REM_CHIS)<-c("1 lag","2 lags", "3 lags")
# GDP - CHIS
GDP_CHIS_v<-as.vector(GDP_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
GDP_CHIS_v2<-cbind(GDP_CHIS_v,CV_CHIS_v)
colnames(GDP_CHIS_v2)<-c("GDP_CHIS","CV_CHIS")
a<- lag(GDP_CHIS_v,0)
x<- lag(GDP_CHIS_v,1)
y<- lag(GDP_CHIS_v,2)
z<- lag(GDP_CHIS_v,3)
GDP_CHIS_lags <- cbind(x,y,z)

fitGDP_CHIS1 <- auto.arima(GDP_CHIS_v2[4: 63,2], xreg=GDP_CHIS_lags[4: 63,1], d=0)
fitGDP_CHIS2 <- auto.arima(GDP_CHIS_v2[4: 63,2], xreg=GDP_CHIS_lags[4: 63,1:2], d=0)
fitGDP_CHIS3 <- auto.arima(GDP_CHIS_v2[4: 63,2], xreg=GDP_CHIS_lags[4: 63,1:3], d=0)
AIC_GDP_CHIS <- cbind(fitGDP_CHIS1$aic,fitGDP_CHIS2$aic,fitGDP_CHIS3$aic)
colnames(AIC_GDP_CHIS)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - CHIS
INPC_SUB_CHIS_v<-as.vector(INPC_SUB_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
INPC_SUB_CHIS_v2<-cbind(INPC_SUB_CHIS_v,CV_CHIS_v)
colnames(INPC_SUB_CHIS_v2)<-c("INPC_SUB_CHIS","CV_CHIS")
a<- lag(INPC_SUB_CHIS_v,0)
x<- lag(INPC_SUB_CHIS_v,1)
y<- lag(INPC_SUB_CHIS_v,2)
z<- lag(INPC_SUB_CHIS_v,3)
INPC_SUB_CHIS_lags <- cbind(x,y,z)

fitINPC_SUB_CHIS1 <- auto.arima(INPC_SUB_CHIS_v2[4: 63,2], xreg=INPC_SUB_CHIS_lags[4: 63,1], d=0)
fitINPC_SUB_CHIS2 <- auto.arima(INPC_SUB_CHIS_v2[4: 63,2], xreg=INPC_SUB_CHIS_lags[4: 63,1:2], d=0)
fitINPC_SUB_CHIS3 <- auto.arima(INPC_SUB_CHIS_v2[4: 63,2], xreg=INPC_SUB_CHIS_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_CHIS <- cbind(fitINPC_SUB_CHIS1$aic,fitINPC_SUB_CHIS2$aic,fitINPC_SUB_CHIS3$aic)
colnames(AIC_INPC_SUB_CHIS)<-c("1 lag","2 lags", "3 lags")
# INPC_E - CHIS
INPC_E_CHIS_v<-as.vector(INPC_E_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
INPC_E_CHIS_v2<-cbind(INPC_E_CHIS_v,CV_CHIS_v)
colnames(INPC_E_CHIS_v2)<-c("INPC_E_CHIS","CV_CHIS")
a<- lag(INPC_E_CHIS_v,0)
x<- lag(INPC_E_CHIS_v,1)
y<- lag(INPC_E_CHIS_v,2)
z<- lag(INPC_E_CHIS_v,3)
INPC_E_CHIS_lags <- cbind(x,y,z)

fitINPC_E_CHIS1 <- auto.arima(INPC_E_CHIS_v2[4: 63,2], xreg=INPC_E_CHIS_lags[4: 63,1], d=0)
fitINPC_E_CHIS2 <- auto.arima(INPC_E_CHIS_v2[4: 63,2], xreg=INPC_E_CHIS_lags[4: 63,1:2], d=0)
fitINPC_E_CHIS3 <- auto.arima(INPC_E_CHIS_v2[4: 63,2], xreg=INPC_E_CHIS_lags[4: 63,1:3], d=0)
AIC_INPC_E_CHIS <- cbind(fitINPC_E_CHIS1$aic,fitINPC_E_CHIS2$aic,fitINPC_E_CHIS3$aic)
colnames(AIC_INPC_E_CHIS)<-c("1 lag","2 lags", "3 lags")
# M1 - CHIS
M1_CHIS_v<-as.vector(M1_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
M1_CHIS_v2<-cbind(M1_CHIS_v,CV_CHIS_v)
colnames(M1_CHIS_v2)<-c("M1_CHIS","CV_CHIS")
a<- lag(M1_CHIS_v,0)
x<- lag(M1_CHIS_v,1)
y<- lag(M1_CHIS_v,2)
z<- lag(M1_CHIS_v,3)
M1_CHIS_lags <- cbind(x,y,z)

fitM1_CHIS1 <- auto.arima(M1_CHIS_v2[4: 63,2], xreg=M1_CHIS_lags[4: 63,1], d=0)
fitM1_CHIS2 <- auto.arima(M1_CHIS_v2[4: 63,2], xreg=M1_CHIS_lags[4: 63,1:2], d=0)
fitM1_CHIS3 <- auto.arima(M1_CHIS_v2[4: 63,2], xreg=M1_CHIS_lags[4: 63,1:3], d=0)
AIC_M1_CHIS <- cbind(fitM1_CHIS1$aic,fitM1_CHIS2$aic,fitM1_CHIS3$aic)
colnames(AIC_M1_CHIS)<-c("1 lag","2 lags", "3 lags")
# CONF - CHIS
CONF_CHIS_v<-as.vector(CONF_CHIS)
CV_CHIS_v<-as.vector(CV_CHIS)
CONF_CHIS_v2<-cbind(CONF_CHIS_v,CV_CHIS_v)
colnames(CONF_CHIS_v2)<-c("CONF_CHIS","CV_CHIS")
a<- lag(CONF_CHIS_v,0)
x<- lag(CONF_CHIS_v,1)
y<- lag(CONF_CHIS_v,2)
z<- lag(CONF_CHIS_v,3)
CONF_CHIS_lags <- cbind(x,y,z)

fitCONF_CHIS1 <- auto.arima(CONF_CHIS_v2[4: 63,2], xreg=CONF_CHIS_lags[4: 63,1], d=0)
fitCONF_CHIS2 <- auto.arima(CONF_CHIS_v2[4: 63,2], xreg=CONF_CHIS_lags[4: 63,1:2], d=0)
fitCONF_CHIS3 <- auto.arima(CONF_CHIS_v2[4: 63,2], xreg=CONF_CHIS_lags[4: 63,1:3], d=0)
AIC_CONF_CHIS <- cbind(fitCONF_CHIS1$aic,fitCONF_CHIS2$aic,fitCONF_CHIS3$aic)
colnames(AIC_CONF_CHIS)<-c("1 lag","2 lags", "3 lags")

AICs_CHIS<-rbind(AIC_IPV_CHIS,AIC_UNEMP_CHIS,AIC_REM_CHIS,AIC_GDP_CHIS,AIC_INPC_SUB_CHIS,AIC_INPC_E_CHIS,AIC_M1_CHIS,AIC_CONF_CHIS)
rownames(AICs_CHIS)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_CHIS
```

```{r}
# COAH
# IPV - COAH
IPV_COAH_v<-as.vector(IPV_COAH)
CV_COAH_v<-as.vector(CV_COAH)
IPV_COAH_v2<-cbind(IPV_COAH_v,CV_COAH_v)
colnames(IPV_COAH_v2)<-c("IPV_COAH","CV_COAH")
a<- lag(IPV_COAH_v,0)
x<- lag(IPV_COAH_v,1)
y<- lag(IPV_COAH_v,2)
z<- lag(IPV_COAH_v,3)
IPV_COAH_lags <- cbind(x,y,z)

fitIPV_COAH1 <- auto.arima(IPV_COAH_v2[4: 63,2], xreg=IPV_COAH_lags[4: 63,1], d=0)
fitIPV_COAH2 <- auto.arima(IPV_COAH_v2[4: 63,2], xreg=IPV_COAH_lags[4: 63,1:2], d=0)
fitIPV_COAH3 <- auto.arima(IPV_COAH_v2[4: 63,2], xreg=IPV_COAH_lags[4: 63,1:3], d=0)
AIC_IPV_COAH <- cbind(fitIPV_COAH1$aic,fitIPV_COAH2$aic,fitIPV_COAH3$aic)
colnames(AIC_IPV_COAH)<-c("1 lag","2 lags", "3 lags")
# UNEMP - COAH
UNEMP_COAH_v<-as.vector(UNEMP_COAH)
CV_COAH_v<-as.vector(CV_COAH)
UNEMP_COAH_v2<-cbind(UNEMP_COAH_v,CV_COAH_v)
colnames(UNEMP_COAH_v2)<-c("UNEMP_COAH","CV_COAH")
a<- lag(UNEMP_COAH_v,0)
x<- lag(UNEMP_COAH_v,1)
y<- lag(UNEMP_COAH_v,2)
z<- lag(UNEMP_COAH_v,3)
UNEMP_COAH_lags <- cbind(x,y,z)

fitUNEMP_COAH1 <- auto.arima(UNEMP_COAH_v2[4: 63,2], xreg=UNEMP_COAH_lags[4: 63,1], d=0)
fitUNEMP_COAH2 <- auto.arima(UNEMP_COAH_v2[4: 63,2], xreg=UNEMP_COAH_lags[4: 63,1:2], d=0)
fitUNEMP_COAH3 <- auto.arima(UNEMP_COAH_v2[4: 63,2], xreg=UNEMP_COAH_lags[4: 63,1:3], d=0)
AIC_UNEMP_COAH <- cbind(fitUNEMP_COAH1$aic,fitUNEMP_COAH2$aic,fitUNEMP_COAH3$aic)
colnames(AIC_UNEMP_COAH)<-c("1 lag","2 lags", "3 lags")
# REM - COAH
REM_COAH_v<-as.vector(REM_COAH)
CV_COAH_v<-as.vector(CV_COAH)
REM_COAH_v2<-cbind(REM_COAH_v,CV_COAH_v)
colnames(REM_COAH_v2)<-c("REM_COAH","CV_COAH")
a<- lag(REM_COAH_v,0)
x<- lag(REM_COAH_v,1)
y<- lag(REM_COAH_v,2)
z<- lag(REM_COAH_v,3)
REM_COAH_lags <- cbind(x,y,z)

fitREM_COAH1 <- auto.arima(REM_COAH_v2[4: 63,2], xreg=REM_COAH_lags[4: 63,1], d=0)
fitREM_COAH2 <- auto.arima(REM_COAH_v2[4: 63,2], xreg=REM_COAH_lags[4: 63,1:2], d=0)
fitREM_COAH3 <- auto.arima(REM_COAH_v2[4: 63,2], xreg=REM_COAH_lags[4: 63,1:3], d=0)
AIC_REM_COAH <- cbind(fitREM_COAH1$aic,fitREM_COAH2$aic,fitREM_COAH3$aic)
colnames(AIC_REM_COAH)<-c("1 lag","2 lags", "3 lags")
# GDP - COAH
GDP_COAH_v<-as.vector(GDP_COAH)
CV_COAH_v<-as.vector(CV_COAH)
GDP_COAH_v2<-cbind(GDP_COAH_v,CV_COAH_v)
colnames(GDP_COAH_v2)<-c("GDP_COAH","CV_COAH")
a<- lag(GDP_COAH_v,0)
x<- lag(GDP_COAH_v,1)
y<- lag(GDP_COAH_v,2)
z<- lag(GDP_COAH_v,3)
GDP_COAH_lags <- cbind(x,y,z)

fitGDP_COAH1 <- auto.arima(GDP_COAH_v2[4: 63,2], xreg=GDP_COAH_lags[4: 63,1], d=0)
fitGDP_COAH2 <- auto.arima(GDP_COAH_v2[4: 63,2], xreg=GDP_COAH_lags[4: 63,1:2], d=0)
fitGDP_COAH3 <- auto.arima(GDP_COAH_v2[4: 63,2], xreg=GDP_COAH_lags[4: 63,1:3], d=0)
AIC_GDP_COAH <- cbind(fitGDP_COAH1$aic,fitGDP_COAH2$aic,fitGDP_COAH3$aic)
colnames(AIC_GDP_COAH)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - COAH
INPC_SUB_COAH_v<-as.vector(INPC_SUB_COAH)
CV_COAH_v<-as.vector(CV_COAH)
INPC_SUB_COAH_v2<-cbind(INPC_SUB_COAH_v,CV_COAH_v)
colnames(INPC_SUB_COAH_v2)<-c("INPC_SUB_COAH","CV_COAH")
a<- lag(INPC_SUB_COAH_v,0)
x<- lag(INPC_SUB_COAH_v,1)
y<- lag(INPC_SUB_COAH_v,2)
z<- lag(INPC_SUB_COAH_v,3)
INPC_SUB_COAH_lags <- cbind(x,y,z)

fitINPC_SUB_COAH1 <- auto.arima(INPC_SUB_COAH_v2[4: 63,2], xreg=INPC_SUB_COAH_lags[4: 63,1], d=0)
fitINPC_SUB_COAH2 <- auto.arima(INPC_SUB_COAH_v2[4: 63,2], xreg=INPC_SUB_COAH_lags[4: 63,1:2], d=0)
fitINPC_SUB_COAH3 <- auto.arima(INPC_SUB_COAH_v2[4: 63,2], xreg=INPC_SUB_COAH_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_COAH <- cbind(fitINPC_SUB_COAH1$aic,fitINPC_SUB_COAH2$aic,fitINPC_SUB_COAH3$aic)
colnames(AIC_INPC_SUB_COAH)<-c("1 lag","2 lags", "3 lags")
# INPC_E - COAH
INPC_E_COAH_v<-as.vector(INPC_E_COAH)
CV_COAH_v<-as.vector(CV_COAH)
INPC_E_COAH_v2<-cbind(INPC_E_COAH_v,CV_COAH_v)
colnames(INPC_E_COAH_v2)<-c("INPC_E_COAH","CV_COAH")
a<- lag(INPC_E_COAH_v,0)
x<- lag(INPC_E_COAH_v,1)
y<- lag(INPC_E_COAH_v,2)
z<- lag(INPC_E_COAH_v,3)
INPC_E_COAH_lags <- cbind(x,y,z)

fitINPC_E_COAH1 <- auto.arima(INPC_E_COAH_v2[4: 63,2], xreg=INPC_E_COAH_lags[4: 63,1], d=0)
fitINPC_E_COAH2 <- auto.arima(INPC_E_COAH_v2[4: 63,2], xreg=INPC_E_COAH_lags[4: 63,1:2], d=0)
fitINPC_E_COAH3 <- auto.arima(INPC_E_COAH_v2[4: 63,2], xreg=INPC_E_COAH_lags[4: 63,1:3], d=0)
AIC_INPC_E_COAH <- cbind(fitINPC_E_COAH1$aic,fitINPC_E_COAH2$aic,fitINPC_E_COAH3$aic)
colnames(AIC_INPC_E_COAH)<-c("1 lag","2 lags", "3 lags")
# M1 - COAH
M1_COAH_v<-as.vector(M1_COAH)
CV_COAH_v<-as.vector(CV_COAH)
M1_COAH_v2<-cbind(M1_COAH_v,CV_COAH_v)
colnames(M1_COAH_v2)<-c("M1_COAH","CV_COAH")
a<- lag(M1_COAH_v,0)
x<- lag(M1_COAH_v,1)
y<- lag(M1_COAH_v,2)
z<- lag(M1_COAH_v,3)
M1_COAH_lags <- cbind(x,y,z)

fitM1_COAH1 <- auto.arima(M1_COAH_v2[4: 63,2], xreg=M1_COAH_lags[4: 63,1], d=0)
fitM1_COAH2 <- auto.arima(M1_COAH_v2[4: 63,2], xreg=M1_COAH_lags[4: 63,1:2], d=0)
fitM1_COAH3 <- auto.arima(M1_COAH_v2[4: 63,2], xreg=M1_COAH_lags[4: 63,1:3], d=0)
AIC_M1_COAH <- cbind(fitM1_COAH1$aic,fitM1_COAH2$aic,fitM1_COAH3$aic)
colnames(AIC_M1_COAH)<-c("1 lag","2 lags", "3 lags")
# CONF - COAH
CONF_COAH_v<-as.vector(CONF_COAH)
CV_COAH_v<-as.vector(CV_COAH)
CONF_COAH_v2<-cbind(CONF_COAH_v,CV_COAH_v)
colnames(CONF_COAH_v2)<-c("CONF_COAH","CV_COAH")
a<- lag(CONF_COAH_v,0)
x<- lag(CONF_COAH_v,1)
y<- lag(CONF_COAH_v,2)
z<- lag(CONF_COAH_v,3)
CONF_COAH_lags <- cbind(x,y,z)

fitCONF_COAH1 <- auto.arima(CONF_COAH_v2[4: 63,2], xreg=CONF_COAH_lags[4: 63,1], d=0)
fitCONF_COAH2 <- auto.arima(CONF_COAH_v2[4: 63,2], xreg=CONF_COAH_lags[4: 63,1:2], d=0)
fitCONF_COAH3 <- auto.arima(CONF_COAH_v2[4: 63,2], xreg=CONF_COAH_lags[4: 63,1:3], d=0)
AIC_CONF_COAH <- cbind(fitCONF_COAH1$aic,fitCONF_COAH2$aic,fitCONF_COAH3$aic)
colnames(AIC_CONF_COAH)<-c("1 lag","2 lags", "3 lags")

AICs_COAH<-rbind(AIC_IPV_COAH,AIC_UNEMP_COAH,AIC_REM_COAH,AIC_GDP_COAH,AIC_INPC_SUB_COAH,AIC_INPC_E_COAH,AIC_M1_COAH,AIC_CONF_COAH)
rownames(AICs_COAH)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_COAH
```

```{r}
# COL
# IPV - COL
IPV_COL_v<-as.vector(IPV_COL)
CV_COL_v<-as.vector(CV_COL)
IPV_COL_v2<-cbind(IPV_COL_v,CV_COL_v)
colnames(IPV_COL_v2)<-c("IPV_COL","CV_COL")
a<- lag(IPV_COL_v,0)
x<- lag(IPV_COL_v,1)
y<- lag(IPV_COL_v,2)
z<- lag(IPV_COL_v,3)
IPV_COL_lags <- cbind(x,y,z)

fitIPV_COL1 <- auto.arima(IPV_COL_v2[4: 63,2], xreg=IPV_COL_lags[4: 63,1], d=0)
fitIPV_COL2 <- auto.arima(IPV_COL_v2[4: 63,2], xreg=IPV_COL_lags[4: 63,1:2], d=0)
fitIPV_COL3 <- auto.arima(IPV_COL_v2[4: 63,2], xreg=IPV_COL_lags[4: 63,1:3], d=0)
AIC_IPV_COL <- cbind(fitIPV_COL1$aic,fitIPV_COL2$aic,fitIPV_COL3$aic)
colnames(AIC_IPV_COL)<-c("1 lag","2 lags", "3 lags")
# UNEMP - COL
UNEMP_COL_v<-as.vector(UNEMP_COL)
CV_COL_v<-as.vector(CV_COL)
UNEMP_COL_v2<-cbind(UNEMP_COL_v,CV_COL_v)
colnames(UNEMP_COL_v2)<-c("UNEMP_COL","CV_COL")
a<- lag(UNEMP_COL_v,0)
x<- lag(UNEMP_COL_v,1)
y<- lag(UNEMP_COL_v,2)
z<- lag(UNEMP_COL_v,3)
UNEMP_COL_lags <- cbind(x,y,z)

fitUNEMP_COL1 <- auto.arima(UNEMP_COL_v2[4: 63,2], xreg=UNEMP_COL_lags[4: 63,1], d=0)
fitUNEMP_COL2 <- auto.arima(UNEMP_COL_v2[4: 63,2], xreg=UNEMP_COL_lags[4: 63,1:2], d=0)
fitUNEMP_COL3 <- auto.arima(UNEMP_COL_v2[4: 63,2], xreg=UNEMP_COL_lags[4: 63,1:3], d=0)
AIC_UNEMP_COL <- cbind(fitUNEMP_COL1$aic,fitUNEMP_COL2$aic,fitUNEMP_COL3$aic)
colnames(AIC_UNEMP_COL)<-c("1 lag","2 lags", "3 lags")
# REM - COL
REM_COL_v<-as.vector(REM_COL)
CV_COL_v<-as.vector(CV_COL)
REM_COL_v2<-cbind(REM_COL_v,CV_COL_v)
colnames(REM_COL_v2)<-c("REM_COL","CV_COL")
a<- lag(REM_COL_v,0)
x<- lag(REM_COL_v,1)
y<- lag(REM_COL_v,2)
z<- lag(REM_COL_v,3)
REM_COL_lags <- cbind(x,y,z)

fitREM_COL1 <- auto.arima(REM_COL_v2[4: 63,2], xreg=REM_COL_lags[4: 63,1], d=0)
fitREM_COL2 <- auto.arima(REM_COL_v2[4: 63,2], xreg=REM_COL_lags[4: 63,1:2], d=0)
fitREM_COL3 <- auto.arima(REM_COL_v2[4: 63,2], xreg=REM_COL_lags[4: 63,1:3], d=0)
AIC_REM_COL <- cbind(fitREM_COL1$aic,fitREM_COL2$aic,fitREM_COL3$aic)
colnames(AIC_REM_COL)<-c("1 lag","2 lags", "3 lags")
# GDP - COL
GDP_COL_v<-as.vector(GDP_COL)
CV_COL_v<-as.vector(CV_COL)
GDP_COL_v2<-cbind(GDP_COL_v,CV_COL_v)
colnames(GDP_COL_v2)<-c("GDP_COL","CV_COL")
a<- lag(GDP_COL_v,0)
x<- lag(GDP_COL_v,1)
y<- lag(GDP_COL_v,2)
z<- lag(GDP_COL_v,3)
GDP_COL_lags <- cbind(x,y,z)

fitGDP_COL1 <- auto.arima(GDP_COL_v2[4: 63,2], xreg=GDP_COL_lags[4: 63,1], d=0)
fitGDP_COL2 <- auto.arima(GDP_COL_v2[4: 63,2], xreg=GDP_COL_lags[4: 63,1:2], d=0)
fitGDP_COL3 <- auto.arima(GDP_COL_v2[4: 63,2], xreg=GDP_COL_lags[4: 63,1:3], d=0)
AIC_GDP_COL <- cbind(fitGDP_COL1$aic,fitGDP_COL2$aic,fitGDP_COL3$aic)
colnames(AIC_GDP_COL)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - COL
INPC_SUB_COL_v<-as.vector(INPC_SUB_COL)
CV_COL_v<-as.vector(CV_COL)
INPC_SUB_COL_v2<-cbind(INPC_SUB_COL_v,CV_COL_v)
colnames(INPC_SUB_COL_v2)<-c("INPC_SUB_COL","CV_COL")
a<- lag(INPC_SUB_COL_v,0)
x<- lag(INPC_SUB_COL_v,1)
y<- lag(INPC_SUB_COL_v,2)
z<- lag(INPC_SUB_COL_v,3)
INPC_SUB_COL_lags <- cbind(x,y,z)

fitINPC_SUB_COL1 <- auto.arima(INPC_SUB_COL_v2[4: 63,2], xreg=INPC_SUB_COL_lags[4: 63,1], d=0)
fitINPC_SUB_COL2 <- auto.arima(INPC_SUB_COL_v2[4: 63,2], xreg=INPC_SUB_COL_lags[4: 63,1:2], d=0)
fitINPC_SUB_COL3 <- auto.arima(INPC_SUB_COL_v2[4: 63,2], xreg=INPC_SUB_COL_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_COL <- cbind(fitINPC_SUB_COL1$aic,fitINPC_SUB_COL2$aic,fitINPC_SUB_COL3$aic)
colnames(AIC_INPC_SUB_COL)<-c("1 lag","2 lags", "3 lags")
# INPC_E - COL
INPC_E_COL_v<-as.vector(INPC_E_COL)
CV_COL_v<-as.vector(CV_COL)
INPC_E_COL_v2<-cbind(INPC_E_COL_v,CV_COL_v)
colnames(INPC_E_COL_v2)<-c("INPC_E_COL","CV_COL")
a<- lag(INPC_E_COL_v,0)
x<- lag(INPC_E_COL_v,1)
y<- lag(INPC_E_COL_v,2)
z<- lag(INPC_E_COL_v,3)
INPC_E_COL_lags <- cbind(x,y,z)

fitINPC_E_COL1 <- auto.arima(INPC_E_COL_v2[4: 63,2], xreg=INPC_E_COL_lags[4: 63,1], d=0)
fitINPC_E_COL2 <- auto.arima(INPC_E_COL_v2[4: 63,2], xreg=INPC_E_COL_lags[4: 63,1:2], d=0)
fitINPC_E_COL3 <- auto.arima(INPC_E_COL_v2[4: 63,2], xreg=INPC_E_COL_lags[4: 63,1:3], d=0)
AIC_INPC_E_COL <- cbind(fitINPC_E_COL1$aic,fitINPC_E_COL2$aic,fitINPC_E_COL3$aic)
colnames(AIC_INPC_E_COL)<-c("1 lag","2 lags", "3 lags")
# M1 - COL
M1_COL_v<-as.vector(M1_COL)
CV_COL_v<-as.vector(CV_COL)
M1_COL_v2<-cbind(M1_COL_v,CV_COL_v)
colnames(M1_COL_v2)<-c("M1_COL","CV_COL")
a<- lag(M1_COL_v,0)
x<- lag(M1_COL_v,1)
y<- lag(M1_COL_v,2)
z<- lag(M1_COL_v,3)
M1_COL_lags <- cbind(x,y,z)

fitM1_COL1 <- auto.arima(M1_COL_v2[4: 63,2], xreg=M1_COL_lags[4: 63,1], d=0)
fitM1_COL2 <- auto.arima(M1_COL_v2[4: 63,2], xreg=M1_COL_lags[4: 63,1:2], d=0)
fitM1_COL3 <- auto.arima(M1_COL_v2[4: 63,2], xreg=M1_COL_lags[4: 63,1:3], d=0)
AIC_M1_COL <- cbind(fitM1_COL1$aic,fitM1_COL2$aic,fitM1_COL3$aic)
colnames(AIC_M1_COL)<-c("1 lag","2 lags", "3 lags")
# CONF - COL
CONF_COL_v<-as.vector(CONF_COL)
CV_COL_v<-as.vector(CV_COL)
CONF_COL_v2<-cbind(CONF_COL_v,CV_COL_v)
colnames(CONF_COL_v2)<-c("CONF_COL","CV_COL")
a<- lag(CONF_COL_v,0)
x<- lag(CONF_COL_v,1)
y<- lag(CONF_COL_v,2)
z<- lag(CONF_COL_v,3)
CONF_COL_lags <- cbind(x,y,z)

fitCONF_COL1 <- auto.arima(CONF_COL_v2[4: 63,2], xreg=CONF_COL_lags[4: 63,1], d=0)
fitCONF_COL2 <- auto.arima(CONF_COL_v2[4: 63,2], xreg=CONF_COL_lags[4: 63,1:2], d=0)
fitCONF_COL3 <- auto.arima(CONF_COL_v2[4: 63,2], xreg=CONF_COL_lags[4: 63,1:3], d=0)
AIC_CONF_COL <- cbind(fitCONF_COL1$aic,fitCONF_COL2$aic,fitCONF_COL3$aic)
colnames(AIC_CONF_COL)<-c("1 lag","2 lags", "3 lags")

AICs_COL<-rbind(AIC_IPV_COL,AIC_UNEMP_COL,AIC_REM_COL,AIC_GDP_COL,AIC_INPC_SUB_COL,AIC_INPC_E_COL,AIC_M1_COL,AIC_CONF_COL)
rownames(AICs_COL)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_COL
```

```{r}
# DGO
# IPV - DGO
IPV_DGO_v<-as.vector(IPV_DGO)
CV_DGO_v<-as.vector(CV_DGO)
IPV_DGO_v2<-cbind(IPV_DGO_v,CV_DGO_v)
colnames(IPV_DGO_v2)<-c("IPV_DGO","CV_DGO")
a<- lag(IPV_DGO_v,0)
x<- lag(IPV_DGO_v,1)
y<- lag(IPV_DGO_v,2)
z<- lag(IPV_DGO_v,3)
IPV_DGO_lags <- cbind(x,y,z)

fitIPV_DGO1 <- auto.arima(IPV_DGO_v2[4: 63,2], xreg=IPV_DGO_lags[4: 63,1], d=0)
fitIPV_DGO2 <- auto.arima(IPV_DGO_v2[4: 63,2], xreg=IPV_DGO_lags[4: 63,1:2], d=0)
fitIPV_DGO3 <- auto.arima(IPV_DGO_v2[4: 63,2], xreg=IPV_DGO_lags[4: 63,1:3], d=0)
AIC_IPV_DGO <- cbind(fitIPV_DGO1$aic,fitIPV_DGO2$aic,fitIPV_DGO3$aic)
colnames(AIC_IPV_DGO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - DGO
UNEMP_DGO_v<-as.vector(UNEMP_DGO)
CV_DGO_v<-as.vector(CV_DGO)
UNEMP_DGO_v2<-cbind(UNEMP_DGO_v,CV_DGO_v)
colnames(UNEMP_DGO_v2)<-c("UNEMP_DGO","CV_DGO")
a<- lag(UNEMP_DGO_v,0)
x<- lag(UNEMP_DGO_v,1)
y<- lag(UNEMP_DGO_v,2)
z<- lag(UNEMP_DGO_v,3)
UNEMP_DGO_lags <- cbind(x,y,z)

fitUNEMP_DGO1 <- auto.arima(UNEMP_DGO_v2[4: 63,2], xreg=UNEMP_DGO_lags[4: 63,1], d=0)
fitUNEMP_DGO2 <- auto.arima(UNEMP_DGO_v2[4: 63,2], xreg=UNEMP_DGO_lags[4: 63,1:2], d=0)
fitUNEMP_DGO3 <- auto.arima(UNEMP_DGO_v2[4: 63,2], xreg=UNEMP_DGO_lags[4: 63,1:3], d=0)
AIC_UNEMP_DGO <- cbind(fitUNEMP_DGO1$aic,fitUNEMP_DGO2$aic,fitUNEMP_DGO3$aic)
colnames(AIC_UNEMP_DGO)<-c("1 lag","2 lags", "3 lags")
# REM - DGO
REM_DGO_v<-as.vector(REM_DGO)
CV_DGO_v<-as.vector(CV_DGO)
REM_DGO_v2<-cbind(REM_DGO_v,CV_DGO_v)
colnames(REM_DGO_v2)<-c("REM_DGO","CV_DGO")
a<- lag(REM_DGO_v,0)
x<- lag(REM_DGO_v,1)
y<- lag(REM_DGO_v,2)
z<- lag(REM_DGO_v,3)
REM_DGO_lags <- cbind(x,y,z)

fitREM_DGO1 <- auto.arima(REM_DGO_v2[4: 63,2], xreg=REM_DGO_lags[4: 63,1], d=0)
fitREM_DGO2 <- auto.arima(REM_DGO_v2[4: 63,2], xreg=REM_DGO_lags[4: 63,1:2], d=0)
fitREM_DGO3 <- auto.arima(REM_DGO_v2[4: 63,2], xreg=REM_DGO_lags[4: 63,1:3], d=0)
AIC_REM_DGO <- cbind(fitREM_DGO1$aic,fitREM_DGO2$aic,fitREM_DGO3$aic)
colnames(AIC_REM_DGO)<-c("1 lag","2 lags", "3 lags")
# GDP - DGO
GDP_DGO_v<-as.vector(GDP_DGO)
CV_DGO_v<-as.vector(CV_DGO)
GDP_DGO_v2<-cbind(GDP_DGO_v,CV_DGO_v)
colnames(GDP_DGO_v2)<-c("GDP_DGO","CV_DGO")
a<- lag(GDP_DGO_v,0)
x<- lag(GDP_DGO_v,1)
y<- lag(GDP_DGO_v,2)
z<- lag(GDP_DGO_v,3)
GDP_DGO_lags <- cbind(x,y,z)

fitGDP_DGO1 <- auto.arima(GDP_DGO_v2[4: 63,2], xreg=GDP_DGO_lags[4: 63,1], d=0)
fitGDP_DGO2 <- auto.arima(GDP_DGO_v2[4: 63,2], xreg=GDP_DGO_lags[4: 63,1:2], d=0)
fitGDP_DGO3 <- auto.arima(GDP_DGO_v2[4: 63,2], xreg=GDP_DGO_lags[4: 63,1:3], d=0)
AIC_GDP_DGO <- cbind(fitGDP_DGO1$aic,fitGDP_DGO2$aic,fitGDP_DGO3$aic)
colnames(AIC_GDP_DGO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - DGO
INPC_SUB_DGO_v<-as.vector(INPC_SUB_DGO)
CV_DGO_v<-as.vector(CV_DGO)
INPC_SUB_DGO_v2<-cbind(INPC_SUB_DGO_v,CV_DGO_v)
colnames(INPC_SUB_DGO_v2)<-c("INPC_SUB_DGO","CV_DGO")
a<- lag(INPC_SUB_DGO_v,0)
x<- lag(INPC_SUB_DGO_v,1)
y<- lag(INPC_SUB_DGO_v,2)
z<- lag(INPC_SUB_DGO_v,3)
INPC_SUB_DGO_lags <- cbind(x,y,z)

fitINPC_SUB_DGO1 <- auto.arima(INPC_SUB_DGO_v2[4: 63,2], xreg=INPC_SUB_DGO_lags[4: 63,1], d=0)
fitINPC_SUB_DGO2 <- auto.arima(INPC_SUB_DGO_v2[4: 63,2], xreg=INPC_SUB_DGO_lags[4: 63,1:2], d=0)
fitINPC_SUB_DGO3 <- auto.arima(INPC_SUB_DGO_v2[4: 63,2], xreg=INPC_SUB_DGO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_DGO <- cbind(fitINPC_SUB_DGO1$aic,fitINPC_SUB_DGO2$aic,fitINPC_SUB_DGO3$aic)
colnames(AIC_INPC_SUB_DGO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - DGO
INPC_E_DGO_v<-as.vector(INPC_E_DGO)
CV_DGO_v<-as.vector(CV_DGO)
INPC_E_DGO_v2<-cbind(INPC_E_DGO_v,CV_DGO_v)
colnames(INPC_E_DGO_v2)<-c("INPC_E_DGO","CV_DGO")
a<- lag(INPC_E_DGO_v,0)
x<- lag(INPC_E_DGO_v,1)
y<- lag(INPC_E_DGO_v,2)
z<- lag(INPC_E_DGO_v,3)
INPC_E_DGO_lags <- cbind(x,y,z)

fitINPC_E_DGO1 <- auto.arima(INPC_E_DGO_v2[4: 63,2], xreg=INPC_E_DGO_lags[4: 63,1], d=0)
fitINPC_E_DGO2 <- auto.arima(INPC_E_DGO_v2[4: 63,2], xreg=INPC_E_DGO_lags[4: 63,1:2], d=0)
fitINPC_E_DGO3 <- auto.arima(INPC_E_DGO_v2[4: 63,2], xreg=INPC_E_DGO_lags[4: 63,1:3], d=0)
AIC_INPC_E_DGO <- cbind(fitINPC_E_DGO1$aic,fitINPC_E_DGO2$aic,fitINPC_E_DGO3$aic)
colnames(AIC_INPC_E_DGO)<-c("1 lag","2 lags", "3 lags")
# M1 - DGO
M1_DGO_v<-as.vector(M1_DGO)
CV_DGO_v<-as.vector(CV_DGO)
M1_DGO_v2<-cbind(M1_DGO_v,CV_DGO_v)
colnames(M1_DGO_v2)<-c("M1_DGO","CV_DGO")
a<- lag(M1_DGO_v,0)
x<- lag(M1_DGO_v,1)
y<- lag(M1_DGO_v,2)
z<- lag(M1_DGO_v,3)
M1_DGO_lags <- cbind(x,y,z)

fitM1_DGO1 <- auto.arima(M1_DGO_v2[4: 63,2], xreg=M1_DGO_lags[4: 63,1], d=0)
fitM1_DGO2 <- auto.arima(M1_DGO_v2[4: 63,2], xreg=M1_DGO_lags[4: 63,1:2], d=0)
fitM1_DGO3 <- auto.arima(M1_DGO_v2[4: 63,2], xreg=M1_DGO_lags[4: 63,1:3], d=0)
AIC_M1_DGO <- cbind(fitM1_DGO1$aic,fitM1_DGO2$aic,fitM1_DGO3$aic)
colnames(AIC_M1_DGO)<-c("1 lag","2 lags", "3 lags")
# CONF - DGO
CONF_DGO_v<-as.vector(CONF_DGO)
CV_DGO_v<-as.vector(CV_DGO)
CONF_DGO_v2<-cbind(CONF_DGO_v,CV_DGO_v)
colnames(CONF_DGO_v2)<-c("CONF_DGO","CV_DGO")
a<- lag(CONF_DGO_v,0)
x<- lag(CONF_DGO_v,1)
y<- lag(CONF_DGO_v,2)
z<- lag(CONF_DGO_v,3)
CONF_DGO_lags <- cbind(x,y,z)

fitCONF_DGO1 <- auto.arima(CONF_DGO_v2[4: 63,2], xreg=CONF_DGO_lags[4: 63,1], d=0)
fitCONF_DGO2 <- auto.arima(CONF_DGO_v2[4: 63,2], xreg=CONF_DGO_lags[4: 63,1:2], d=0)
fitCONF_DGO3 <- auto.arima(CONF_DGO_v2[4: 63,2], xreg=CONF_DGO_lags[4: 63,1:3], d=0)
AIC_CONF_DGO <- cbind(fitCONF_DGO1$aic,fitCONF_DGO2$aic,fitCONF_DGO3$aic)
colnames(AIC_CONF_DGO)<-c("1 lag","2 lags", "3 lags")

AICs_DGO<-rbind(AIC_IPV_DGO,AIC_UNEMP_DGO,AIC_REM_DGO,AIC_GDP_DGO,AIC_INPC_SUB_DGO,AIC_INPC_E_DGO,AIC_M1_DGO,AIC_CONF_DGO)
rownames(AICs_DGO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_DGO
```

```{r}
# GRO
# IPV - GRO
IPV_GRO_v<-as.vector(IPV_GRO)
CV_GRO_v<-as.vector(CV_GRO)
IPV_GRO_v2<-cbind(IPV_GRO_v,CV_GRO_v)
colnames(IPV_GRO_v2)<-c("IPV_GRO","CV_GRO")
a<- lag(IPV_GRO_v,0)
x<- lag(IPV_GRO_v,1)
y<- lag(IPV_GRO_v,2)
z<- lag(IPV_GRO_v,3)
IPV_GRO_lags <- cbind(x,y,z)

fitIPV_GRO1 <- auto.arima(IPV_GRO_v2[4: 63,2], xreg=IPV_GRO_lags[4: 63,1], d=0)
fitIPV_GRO2 <- auto.arima(IPV_GRO_v2[4: 63,2], xreg=IPV_GRO_lags[4: 63,1:2], d=0)
fitIPV_GRO3 <- auto.arima(IPV_GRO_v2[4: 63,2], xreg=IPV_GRO_lags[4: 63,1:3], d=0)
AIC_IPV_GRO <- cbind(fitIPV_GRO1$aic,fitIPV_GRO2$aic,fitIPV_GRO3$aic)
colnames(AIC_IPV_GRO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - GRO
UNEMP_GRO_v<-as.vector(UNEMP_GRO)
CV_GRO_v<-as.vector(CV_GRO)
UNEMP_GRO_v2<-cbind(UNEMP_GRO_v,CV_GRO_v)
colnames(UNEMP_GRO_v2)<-c("UNEMP_GRO","CV_GRO")
a<- lag(UNEMP_GRO_v,0)
x<- lag(UNEMP_GRO_v,1)
y<- lag(UNEMP_GRO_v,2)
z<- lag(UNEMP_GRO_v,3)
UNEMP_GRO_lags <- cbind(x,y,z)

fitUNEMP_GRO1 <- auto.arima(UNEMP_GRO_v2[4: 63,2], xreg=UNEMP_GRO_lags[4: 63,1], d=0)
fitUNEMP_GRO2 <- auto.arima(UNEMP_GRO_v2[4: 63,2], xreg=UNEMP_GRO_lags[4: 63,1:2], d=0)
fitUNEMP_GRO3 <- auto.arima(UNEMP_GRO_v2[4: 63,2], xreg=UNEMP_GRO_lags[4: 63,1:3], d=0)
AIC_UNEMP_GRO <- cbind(fitUNEMP_GRO1$aic,fitUNEMP_GRO2$aic,fitUNEMP_GRO3$aic)
colnames(AIC_UNEMP_GRO)<-c("1 lag","2 lags", "3 lags")
# REM - GRO
REM_GRO_v<-as.vector(REM_GRO)
CV_GRO_v<-as.vector(CV_GRO)
REM_GRO_v2<-cbind(REM_GRO_v,CV_GRO_v)
colnames(REM_GRO_v2)<-c("REM_GRO","CV_GRO")
a<- lag(REM_GRO_v,0)
x<- lag(REM_GRO_v,1)
y<- lag(REM_GRO_v,2)
z<- lag(REM_GRO_v,3)
REM_GRO_lags <- cbind(x,y,z)

fitREM_GRO1 <- auto.arima(REM_GRO_v2[4: 63,2], xreg=REM_GRO_lags[4: 63,1], d=0)
fitREM_GRO2 <- auto.arima(REM_GRO_v2[4: 63,2], xreg=REM_GRO_lags[4: 63,1:2], d=0)
fitREM_GRO3 <- auto.arima(REM_GRO_v2[4: 63,2], xreg=REM_GRO_lags[4: 63,1:3], d=0)
AIC_REM_GRO <- cbind(fitREM_GRO1$aic,fitREM_GRO2$aic,fitREM_GRO3$aic)
colnames(AIC_REM_GRO)<-c("1 lag","2 lags", "3 lags")
# GDP - GRO
GDP_GRO_v<-as.vector(GDP_GRO)
CV_GRO_v<-as.vector(CV_GRO)
GDP_GRO_v2<-cbind(GDP_GRO_v,CV_GRO_v)
colnames(GDP_GRO_v2)<-c("GDP_GRO","CV_GRO")
a<- lag(GDP_GRO_v,0)
x<- lag(GDP_GRO_v,1)
y<- lag(GDP_GRO_v,2)
z<- lag(GDP_GRO_v,3)
GDP_GRO_lags <- cbind(x,y,z)

fitGDP_GRO1 <- auto.arima(GDP_GRO_v2[4: 63,2], xreg=GDP_GRO_lags[4: 63,1], d=0)
fitGDP_GRO2 <- auto.arima(GDP_GRO_v2[4: 63,2], xreg=GDP_GRO_lags[4: 63,1:2], d=0)
fitGDP_GRO3 <- auto.arima(GDP_GRO_v2[4: 63,2], xreg=GDP_GRO_lags[4: 63,1:3], d=0)
AIC_GDP_GRO <- cbind(fitGDP_GRO1$aic,fitGDP_GRO2$aic,fitGDP_GRO3$aic)
colnames(AIC_GDP_GRO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - GRO
INPC_SUB_GRO_v<-as.vector(INPC_SUB_GRO)
CV_GRO_v<-as.vector(CV_GRO)
INPC_SUB_GRO_v2<-cbind(INPC_SUB_GRO_v,CV_GRO_v)
colnames(INPC_SUB_GRO_v2)<-c("INPC_SUB_GRO","CV_GRO")
a<- lag(INPC_SUB_GRO_v,0)
x<- lag(INPC_SUB_GRO_v,1)
y<- lag(INPC_SUB_GRO_v,2)
z<- lag(INPC_SUB_GRO_v,3)
INPC_SUB_GRO_lags <- cbind(x,y,z)

fitINPC_SUB_GRO1 <- auto.arima(INPC_SUB_GRO_v2[4: 63,2], xreg=INPC_SUB_GRO_lags[4: 63,1], d=0)
fitINPC_SUB_GRO2 <- auto.arima(INPC_SUB_GRO_v2[4: 63,2], xreg=INPC_SUB_GRO_lags[4: 63,1:2], d=0)
fitINPC_SUB_GRO3 <- auto.arima(INPC_SUB_GRO_v2[4: 63,2], xreg=INPC_SUB_GRO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_GRO <- cbind(fitINPC_SUB_GRO1$aic,fitINPC_SUB_GRO2$aic,fitINPC_SUB_GRO3$aic)
colnames(AIC_INPC_SUB_GRO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - GRO
INPC_E_GRO_v<-as.vector(INPC_E_GRO)
CV_GRO_v<-as.vector(CV_GRO)
INPC_E_GRO_v2<-cbind(INPC_E_GRO_v,CV_GRO_v)
colnames(INPC_E_GRO_v2)<-c("INPC_E_GRO","CV_GRO")
a<- lag(INPC_E_GRO_v,0)
x<- lag(INPC_E_GRO_v,1)
y<- lag(INPC_E_GRO_v,2)
z<- lag(INPC_E_GRO_v,3)
INPC_E_GRO_lags <- cbind(x,y,z)

fitINPC_E_GRO1 <- auto.arima(INPC_E_GRO_v2[4: 63,2], xreg=INPC_E_GRO_lags[4: 63,1], d=0)
fitINPC_E_GRO2 <- auto.arima(INPC_E_GRO_v2[4: 63,2], xreg=INPC_E_GRO_lags[4: 63,1:2], d=0)
fitINPC_E_GRO3 <- auto.arima(INPC_E_GRO_v2[4: 63,2], xreg=INPC_E_GRO_lags[4: 63,1:3], d=0)
AIC_INPC_E_GRO <- cbind(fitINPC_E_GRO1$aic,fitINPC_E_GRO2$aic,fitINPC_E_GRO3$aic)
colnames(AIC_INPC_E_GRO)<-c("1 lag","2 lags", "3 lags")
# M1 - GRO
M1_GRO_v<-as.vector(M1_GRO)
CV_GRO_v<-as.vector(CV_GRO)
M1_GRO_v2<-cbind(M1_GRO_v,CV_GRO_v)
colnames(M1_GRO_v2)<-c("M1_GRO","CV_GRO")
a<- lag(M1_GRO_v,0)
x<- lag(M1_GRO_v,1)
y<- lag(M1_GRO_v,2)
z<- lag(M1_GRO_v,3)
M1_GRO_lags <- cbind(x,y,z)

fitM1_GRO1 <- auto.arima(M1_GRO_v2[4: 63,2], xreg=M1_GRO_lags[4: 63,1], d=0)
fitM1_GRO2 <- auto.arima(M1_GRO_v2[4: 63,2], xreg=M1_GRO_lags[4: 63,1:2], d=0)
fitM1_GRO3 <- auto.arima(M1_GRO_v2[4: 63,2], xreg=M1_GRO_lags[4: 63,1:3], d=0)
AIC_M1_GRO <- cbind(fitM1_GRO1$aic,fitM1_GRO2$aic,fitM1_GRO3$aic)
colnames(AIC_M1_GRO)<-c("1 lag","2 lags", "3 lags")
# CONF - GRO
CONF_GRO_v<-as.vector(CONF_GRO)
CV_GRO_v<-as.vector(CV_GRO)
CONF_GRO_v2<-cbind(CONF_GRO_v,CV_GRO_v)
colnames(CONF_GRO_v2)<-c("CONF_GRO","CV_GRO")
a<- lag(CONF_GRO_v,0)
x<- lag(CONF_GRO_v,1)
y<- lag(CONF_GRO_v,2)
z<- lag(CONF_GRO_v,3)
CONF_GRO_lags <- cbind(x,y,z)

fitCONF_GRO1 <- auto.arima(CONF_GRO_v2[4: 63,2], xreg=CONF_GRO_lags[4: 63,1], d=0)
fitCONF_GRO2 <- auto.arima(CONF_GRO_v2[4: 63,2], xreg=CONF_GRO_lags[4: 63,1:2], d=0)
fitCONF_GRO3 <- auto.arima(CONF_GRO_v2[4: 63,2], xreg=CONF_GRO_lags[4: 63,1:3], d=0)
AIC_CONF_GRO <- cbind(fitCONF_GRO1$aic,fitCONF_GRO2$aic,fitCONF_GRO3$aic)
colnames(AIC_CONF_GRO)<-c("1 lag","2 lags", "3 lags")

AICs_GRO<-rbind(AIC_IPV_GRO,AIC_UNEMP_GRO,AIC_REM_GRO,AIC_GDP_GRO,AIC_INPC_SUB_GRO,AIC_INPC_E_GRO,AIC_M1_GRO,AIC_CONF_GRO)
rownames(AICs_GRO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_GRO
```

```{r}
# GTO
# IPV - GTO
IPV_GTO_v<-as.vector(IPV_GTO)
CV_GTO_v<-as.vector(CV_GTO)
IPV_GTO_v2<-cbind(IPV_GTO_v,CV_GTO_v)
colnames(IPV_GTO_v2)<-c("IPV_GTO","CV_GTO")
a<- lag(IPV_GTO_v,0)
x<- lag(IPV_GTO_v,1)
y<- lag(IPV_GTO_v,2)
z<- lag(IPV_GTO_v,3)
IPV_GTO_lags <- cbind(x,y,z)

fitIPV_GTO1 <- auto.arima(IPV_GTO_v2[4: 63,2], xreg=IPV_GTO_lags[4: 63,1], d=0)
fitIPV_GTO2 <- auto.arima(IPV_GTO_v2[4: 63,2], xreg=IPV_GTO_lags[4: 63,1:2], d=0)
fitIPV_GTO3 <- auto.arima(IPV_GTO_v2[4: 63,2], xreg=IPV_GTO_lags[4: 63,1:3], d=0)
AIC_IPV_GTO <- cbind(fitIPV_GTO1$aic,fitIPV_GTO2$aic,fitIPV_GTO3$aic)
colnames(AIC_IPV_GTO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - GTO
UNEMP_GTO_v<-as.vector(UNEMP_GTO)
CV_GTO_v<-as.vector(CV_GTO)
UNEMP_GTO_v2<-cbind(UNEMP_GTO_v,CV_GTO_v)
colnames(UNEMP_GTO_v2)<-c("UNEMP_GTO","CV_GTO")
a<- lag(UNEMP_GTO_v,0)
x<- lag(UNEMP_GTO_v,1)
y<- lag(UNEMP_GTO_v,2)
z<- lag(UNEMP_GTO_v,3)
UNEMP_GTO_lags <- cbind(x,y,z)

fitUNEMP_GTO1 <- auto.arima(UNEMP_GTO_v2[4: 63,2], xreg=UNEMP_GTO_lags[4: 63,1], d=0)
fitUNEMP_GTO2 <- auto.arima(UNEMP_GTO_v2[4: 63,2], xreg=UNEMP_GTO_lags[4: 63,1:2], d=0)
fitUNEMP_GTO3 <- auto.arima(UNEMP_GTO_v2[4: 63,2], xreg=UNEMP_GTO_lags[4: 63,1:3], d=0)
AIC_UNEMP_GTO <- cbind(fitUNEMP_GTO1$aic,fitUNEMP_GTO2$aic,fitUNEMP_GTO3$aic)
colnames(AIC_UNEMP_GTO)<-c("1 lag","2 lags", "3 lags")
# REM - GTO
REM_GTO_v<-as.vector(REM_GTO)
CV_GTO_v<-as.vector(CV_GTO)
REM_GTO_v2<-cbind(REM_GTO_v,CV_GTO_v)
colnames(REM_GTO_v2)<-c("REM_GTO","CV_GTO")
a<- lag(REM_GTO_v,0)
x<- lag(REM_GTO_v,1)
y<- lag(REM_GTO_v,2)
z<- lag(REM_GTO_v,3)
REM_GTO_lags <- cbind(x,y,z)

fitREM_GTO1 <- auto.arima(REM_GTO_v2[4: 63,2], xreg=REM_GTO_lags[4: 63,1], d=0)
fitREM_GTO2 <- auto.arima(REM_GTO_v2[4: 63,2], xreg=REM_GTO_lags[4: 63,1:2], d=0)
fitREM_GTO3 <- auto.arima(REM_GTO_v2[4: 63,2], xreg=REM_GTO_lags[4: 63,1:3], d=0)
AIC_REM_GTO <- cbind(fitREM_GTO1$aic,fitREM_GTO2$aic,fitREM_GTO3$aic)
colnames(AIC_REM_GTO)<-c("1 lag","2 lags", "3 lags")
# GDP - GTO
GDP_GTO_v<-as.vector(GDP_GTO)
CV_GTO_v<-as.vector(CV_GTO)
GDP_GTO_v2<-cbind(GDP_GTO_v,CV_GTO_v)
colnames(GDP_GTO_v2)<-c("GDP_GTO","CV_GTO")
a<- lag(GDP_GTO_v,0)
x<- lag(GDP_GTO_v,1)
y<- lag(GDP_GTO_v,2)
z<- lag(GDP_GTO_v,3)
GDP_GTO_lags <- cbind(x,y,z)

fitGDP_GTO1 <- auto.arima(GDP_GTO_v2[4: 63,2], xreg=GDP_GTO_lags[4: 63,1], d=0)
fitGDP_GTO2 <- auto.arima(GDP_GTO_v2[4: 63,2], xreg=GDP_GTO_lags[4: 63,1:2], d=0)
fitGDP_GTO3 <- auto.arima(GDP_GTO_v2[4: 63,2], xreg=GDP_GTO_lags[4: 63,1:3], d=0)
AIC_GDP_GTO <- cbind(fitGDP_GTO1$aic,fitGDP_GTO2$aic,fitGDP_GTO3$aic)
colnames(AIC_GDP_GTO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - GTO
INPC_SUB_GTO_v<-as.vector(INPC_SUB_GTO)
CV_GTO_v<-as.vector(CV_GTO)
INPC_SUB_GTO_v2<-cbind(INPC_SUB_GTO_v,CV_GTO_v)
colnames(INPC_SUB_GTO_v2)<-c("INPC_SUB_GTO","CV_GTO")
a<- lag(INPC_SUB_GTO_v,0)
x<- lag(INPC_SUB_GTO_v,1)
y<- lag(INPC_SUB_GTO_v,2)
z<- lag(INPC_SUB_GTO_v,3)
INPC_SUB_GTO_lags <- cbind(x,y,z)

fitINPC_SUB_GTO1 <- auto.arima(INPC_SUB_GTO_v2[4: 63,2], xreg=INPC_SUB_GTO_lags[4: 63,1], d=0)
fitINPC_SUB_GTO2 <- auto.arima(INPC_SUB_GTO_v2[4: 63,2], xreg=INPC_SUB_GTO_lags[4: 63,1:2], d=0)
fitINPC_SUB_GTO3 <- auto.arima(INPC_SUB_GTO_v2[4: 63,2], xreg=INPC_SUB_GTO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_GTO <- cbind(fitINPC_SUB_GTO1$aic,fitINPC_SUB_GTO2$aic,fitINPC_SUB_GTO3$aic)
colnames(AIC_INPC_SUB_GTO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - GTO
INPC_E_GTO_v<-as.vector(INPC_E_GTO)
CV_GTO_v<-as.vector(CV_GTO)
INPC_E_GTO_v2<-cbind(INPC_E_GTO_v,CV_GTO_v)
colnames(INPC_E_GTO_v2)<-c("INPC_E_GTO","CV_GTO")
a<- lag(INPC_E_GTO_v,0)
x<- lag(INPC_E_GTO_v,1)
y<- lag(INPC_E_GTO_v,2)
z<- lag(INPC_E_GTO_v,3)
INPC_E_GTO_lags <- cbind(x,y,z)

fitINPC_E_GTO1 <- auto.arima(INPC_E_GTO_v2[4: 63,2], xreg=INPC_E_GTO_lags[4: 63,1], d=0)
fitINPC_E_GTO2 <- auto.arima(INPC_E_GTO_v2[4: 63,2], xreg=INPC_E_GTO_lags[4: 63,1:2], d=0)
fitINPC_E_GTO3 <- auto.arima(INPC_E_GTO_v2[4: 63,2], xreg=INPC_E_GTO_lags[4: 63,1:3], d=0)
AIC_INPC_E_GTO <- cbind(fitINPC_E_GTO1$aic,fitINPC_E_GTO2$aic,fitINPC_E_GTO3$aic)
colnames(AIC_INPC_E_GTO)<-c("1 lag","2 lags", "3 lags")
# M1 - GTO
M1_GTO_v<-as.vector(M1_GTO)
CV_GTO_v<-as.vector(CV_GTO)
M1_GTO_v2<-cbind(M1_GTO_v,CV_GTO_v)
colnames(M1_GTO_v2)<-c("M1_GTO","CV_GTO")
a<- lag(M1_GTO_v,0)
x<- lag(M1_GTO_v,1)
y<- lag(M1_GTO_v,2)
z<- lag(M1_GTO_v,3)
M1_GTO_lags <- cbind(x,y,z)

fitM1_GTO1 <- auto.arima(M1_GTO_v2[4: 63,2], xreg=M1_GTO_lags[4: 63,1], d=0)
fitM1_GTO2 <- auto.arima(M1_GTO_v2[4: 63,2], xreg=M1_GTO_lags[4: 63,1:2], d=0)
fitM1_GTO3 <- auto.arima(M1_GTO_v2[4: 63,2], xreg=M1_GTO_lags[4: 63,1:3], d=0)
AIC_M1_GTO <- cbind(fitM1_GTO1$aic,fitM1_GTO2$aic,fitM1_GTO3$aic)
colnames(AIC_M1_GTO)<-c("1 lag","2 lags", "3 lags")
# CONF - GTO
CONF_GTO_v<-as.vector(CONF_GTO)
CV_GTO_v<-as.vector(CV_GTO)
CONF_GTO_v2<-cbind(CONF_GTO_v,CV_GTO_v)
colnames(CONF_GTO_v2)<-c("CONF_GTO","CV_GTO")
a<- lag(CONF_GTO_v,0)
x<- lag(CONF_GTO_v,1)
y<- lag(CONF_GTO_v,2)
z<- lag(CONF_GTO_v,3)
CONF_GTO_lags <- cbind(x,y,z)

fitCONF_GTO1 <- auto.arima(CONF_GTO_v2[4: 63,2], xreg=CONF_GTO_lags[4: 63,1], d=0)
fitCONF_GTO2 <- auto.arima(CONF_GTO_v2[4: 63,2], xreg=CONF_GTO_lags[4: 63,1:2], d=0)
fitCONF_GTO3 <- auto.arima(CONF_GTO_v2[4: 63,2], xreg=CONF_GTO_lags[4: 63,1:3], d=0)
AIC_CONF_GTO <- cbind(fitCONF_GTO1$aic,fitCONF_GTO2$aic,fitCONF_GTO3$aic)
colnames(AIC_CONF_GTO)<-c("1 lag","2 lags", "3 lags")

AICs_GTO<-rbind(AIC_IPV_GTO,AIC_UNEMP_GTO,AIC_REM_GTO,AIC_GDP_GTO,AIC_INPC_SUB_GTO,AIC_INPC_E_GTO,AIC_M1_GTO,AIC_CONF_GTO)
rownames(AICs_GTO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_GTO
```

```{r}
# HGO
# IPV - HGO
IPV_HGO_v<-as.vector(IPV_HGO)
CV_HGO_v<-as.vector(CV_HGO)
IPV_HGO_v2<-cbind(IPV_HGO_v,CV_HGO_v)
colnames(IPV_HGO_v2)<-c("IPV_HGO","CV_HGO")
a<- lag(IPV_HGO_v,0)
x<- lag(IPV_HGO_v,1)
y<- lag(IPV_HGO_v,2)
z<- lag(IPV_HGO_v,3)
IPV_HGO_lags <- cbind(x,y,z)

fitIPV_HGO1 <- auto.arima(IPV_HGO_v2[4: 63,2], xreg=IPV_HGO_lags[4: 63,1], d=0)
fitIPV_HGO2 <- auto.arima(IPV_HGO_v2[4: 63,2], xreg=IPV_HGO_lags[4: 63,1:2], d=0)
fitIPV_HGO3 <- auto.arima(IPV_HGO_v2[4: 63,2], xreg=IPV_HGO_lags[4: 63,1:3], d=0)
AIC_IPV_HGO <- cbind(fitIPV_HGO1$aic,fitIPV_HGO2$aic,fitIPV_HGO3$aic)
colnames(AIC_IPV_HGO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - HGO
UNEMP_HGO_v<-as.vector(UNEMP_HGO)
CV_HGO_v<-as.vector(CV_HGO)
UNEMP_HGO_v2<-cbind(UNEMP_HGO_v,CV_HGO_v)
colnames(UNEMP_HGO_v2)<-c("UNEMP_HGO","CV_HGO")
a<- lag(UNEMP_HGO_v,0)
x<- lag(UNEMP_HGO_v,1)
y<- lag(UNEMP_HGO_v,2)
z<- lag(UNEMP_HGO_v,3)
UNEMP_HGO_lags <- cbind(x,y,z)

fitUNEMP_HGO1 <- auto.arima(UNEMP_HGO_v2[4: 63,2], xreg=UNEMP_HGO_lags[4: 63,1], d=0)
fitUNEMP_HGO2 <- auto.arima(UNEMP_HGO_v2[4: 63,2], xreg=UNEMP_HGO_lags[4: 63,1:2], d=0)
fitUNEMP_HGO3 <- auto.arima(UNEMP_HGO_v2[4: 63,2], xreg=UNEMP_HGO_lags[4: 63,1:3], d=0)
AIC_UNEMP_HGO <- cbind(fitUNEMP_HGO1$aic,fitUNEMP_HGO2$aic,fitUNEMP_HGO3$aic)
colnames(AIC_UNEMP_HGO)<-c("1 lag","2 lags", "3 lags")
# REM - HGO
REM_HGO_v<-as.vector(REM_HGO)
CV_HGO_v<-as.vector(CV_HGO)
REM_HGO_v2<-cbind(REM_HGO_v,CV_HGO_v)
colnames(REM_HGO_v2)<-c("REM_HGO","CV_HGO")
a<- lag(REM_HGO_v,0)
x<- lag(REM_HGO_v,1)
y<- lag(REM_HGO_v,2)
z<- lag(REM_HGO_v,3)
REM_HGO_lags <- cbind(x,y,z)

fitREM_HGO1 <- auto.arima(REM_HGO_v2[4: 63,2], xreg=REM_HGO_lags[4: 63,1], d=0)
fitREM_HGO2 <- auto.arima(REM_HGO_v2[4: 63,2], xreg=REM_HGO_lags[4: 63,1:2], d=0)
fitREM_HGO3 <- auto.arima(REM_HGO_v2[4: 63,2], xreg=REM_HGO_lags[4: 63,1:3], d=0)
AIC_REM_HGO <- cbind(fitREM_HGO1$aic,fitREM_HGO2$aic,fitREM_HGO3$aic)
colnames(AIC_REM_HGO)<-c("1 lag","2 lags", "3 lags")
# GDP - HGO
GDP_HGO_v<-as.vector(GDP_HGO)
CV_HGO_v<-as.vector(CV_HGO)
GDP_HGO_v2<-cbind(GDP_HGO_v,CV_HGO_v)
colnames(GDP_HGO_v2)<-c("GDP_HGO","CV_HGO")
a<- lag(GDP_HGO_v,0)
x<- lag(GDP_HGO_v,1)
y<- lag(GDP_HGO_v,2)
z<- lag(GDP_HGO_v,3)
GDP_HGO_lags <- cbind(x,y,z)

fitGDP_HGO1 <- auto.arima(GDP_HGO_v2[4: 63,2], xreg=GDP_HGO_lags[4: 63,1], d=0)
fitGDP_HGO2 <- auto.arima(GDP_HGO_v2[4: 63,2], xreg=GDP_HGO_lags[4: 63,1:2], d=0)
fitGDP_HGO3 <- auto.arima(GDP_HGO_v2[4: 63,2], xreg=GDP_HGO_lags[4: 63,1:3], d=0)
AIC_GDP_HGO <- cbind(fitGDP_HGO1$aic,fitGDP_HGO2$aic,fitGDP_HGO3$aic)
colnames(AIC_GDP_HGO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - HGO
INPC_SUB_HGO_v<-as.vector(INPC_SUB_HGO)
CV_HGO_v<-as.vector(CV_HGO)
INPC_SUB_HGO_v2<-cbind(INPC_SUB_HGO_v,CV_HGO_v)
colnames(INPC_SUB_HGO_v2)<-c("INPC_SUB_HGO","CV_HGO")
a<- lag(INPC_SUB_HGO_v,0)
x<- lag(INPC_SUB_HGO_v,1)
y<- lag(INPC_SUB_HGO_v,2)
z<- lag(INPC_SUB_HGO_v,3)
INPC_SUB_HGO_lags <- cbind(x,y,z)

fitINPC_SUB_HGO1 <- auto.arima(INPC_SUB_HGO_v2[4: 63,2], xreg=INPC_SUB_HGO_lags[4: 63,1], d=0)
fitINPC_SUB_HGO2 <- auto.arima(INPC_SUB_HGO_v2[4: 63,2], xreg=INPC_SUB_HGO_lags[4: 63,1:2], d=0)
fitINPC_SUB_HGO3 <- auto.arima(INPC_SUB_HGO_v2[4: 63,2], xreg=INPC_SUB_HGO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_HGO <- cbind(fitINPC_SUB_HGO1$aic,fitINPC_SUB_HGO2$aic,fitINPC_SUB_HGO3$aic)
colnames(AIC_INPC_SUB_HGO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - HGO
INPC_E_HGO_v<-as.vector(INPC_E_HGO)
CV_HGO_v<-as.vector(CV_HGO)
INPC_E_HGO_v2<-cbind(INPC_E_HGO_v,CV_HGO_v)
colnames(INPC_E_HGO_v2)<-c("INPC_E_HGO","CV_HGO")
a<- lag(INPC_E_HGO_v,0)
x<- lag(INPC_E_HGO_v,1)
y<- lag(INPC_E_HGO_v,2)
z<- lag(INPC_E_HGO_v,3)
INPC_E_HGO_lags <- cbind(x,y,z)

fitINPC_E_HGO1 <- auto.arima(INPC_E_HGO_v2[4: 63,2], xreg=INPC_E_HGO_lags[4: 63,1], d=0)
fitINPC_E_HGO2 <- auto.arima(INPC_E_HGO_v2[4: 63,2], xreg=INPC_E_HGO_lags[4: 63,1:2], d=0)
fitINPC_E_HGO3 <- auto.arima(INPC_E_HGO_v2[4: 63,2], xreg=INPC_E_HGO_lags[4: 63,1:3], d=0)
AIC_INPC_E_HGO <- cbind(fitINPC_E_HGO1$aic,fitINPC_E_HGO2$aic,fitINPC_E_HGO3$aic)
colnames(AIC_INPC_E_HGO)<-c("1 lag","2 lags", "3 lags")
# M1 - HGO
M1_HGO_v<-as.vector(M1_HGO)
CV_HGO_v<-as.vector(CV_HGO)
M1_HGO_v2<-cbind(M1_HGO_v,CV_HGO_v)
colnames(M1_HGO_v2)<-c("M1_HGO","CV_HGO")
a<- lag(M1_HGO_v,0)
x<- lag(M1_HGO_v,1)
y<- lag(M1_HGO_v,2)
z<- lag(M1_HGO_v,3)
M1_HGO_lags <- cbind(x,y,z)

fitM1_HGO1 <- auto.arima(M1_HGO_v2[4: 63,2], xreg=M1_HGO_lags[4: 63,1], d=0)
fitM1_HGO2 <- auto.arima(M1_HGO_v2[4: 63,2], xreg=M1_HGO_lags[4: 63,1:2], d=0)
fitM1_HGO3 <- auto.arima(M1_HGO_v2[4: 63,2], xreg=M1_HGO_lags[4: 63,1:3], d=0)
AIC_M1_HGO <- cbind(fitM1_HGO1$aic,fitM1_HGO2$aic,fitM1_HGO3$aic)
colnames(AIC_M1_HGO)<-c("1 lag","2 lags", "3 lags")
# CONF - HGO
CONF_HGO_v<-as.vector(CONF_HGO)
CV_HGO_v<-as.vector(CV_HGO)
CONF_HGO_v2<-cbind(CONF_HGO_v,CV_HGO_v)
colnames(CONF_HGO_v2)<-c("CONF_HGO","CV_HGO")
a<- lag(CONF_HGO_v,0)
x<- lag(CONF_HGO_v,1)
y<- lag(CONF_HGO_v,2)
z<- lag(CONF_HGO_v,3)
CONF_HGO_lags <- cbind(x,y,z)

fitCONF_HGO1 <- auto.arima(CONF_HGO_v2[4: 63,2], xreg=CONF_HGO_lags[4: 63,1], d=0)
fitCONF_HGO2 <- auto.arima(CONF_HGO_v2[4: 63,2], xreg=CONF_HGO_lags[4: 63,1:2], d=0)
fitCONF_HGO3 <- auto.arima(CONF_HGO_v2[4: 63,2], xreg=CONF_HGO_lags[4: 63,1:3], d=0)
AIC_CONF_HGO <- cbind(fitCONF_HGO1$aic,fitCONF_HGO2$aic,fitCONF_HGO3$aic)
colnames(AIC_CONF_HGO)<-c("1 lag","2 lags", "3 lags")

AICs_HGO<-rbind(AIC_IPV_HGO,AIC_UNEMP_HGO,AIC_REM_HGO,AIC_GDP_HGO,AIC_INPC_SUB_HGO,AIC_INPC_E_HGO,AIC_M1_HGO,AIC_CONF_HGO)
rownames(AICs_HGO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_HGO
```

```{r}
# JAL
# IPV - JAL
IPV_JAL_v<-as.vector(IPV_JAL)
CV_JAL_v<-as.vector(CV_JAL)
IPV_JAL_v2<-cbind(IPV_JAL_v,CV_JAL_v)
colnames(IPV_JAL_v2)<-c("IPV_JAL","CV_JAL")
a<- lag(IPV_JAL_v,0)
x<- lag(IPV_JAL_v,1)
y<- lag(IPV_JAL_v,2)
z<- lag(IPV_JAL_v,3)
IPV_JAL_lags <- cbind(x,y,z)

fitIPV_JAL1 <- auto.arima(IPV_JAL_v2[4: 63,2], xreg=IPV_JAL_lags[4: 63,1], d=0)
fitIPV_JAL2 <- auto.arima(IPV_JAL_v2[4: 63,2], xreg=IPV_JAL_lags[4: 63,1:2], d=0)
fitIPV_JAL3 <- auto.arima(IPV_JAL_v2[4: 63,2], xreg=IPV_JAL_lags[4: 63,1:3], d=0)
AIC_IPV_JAL <- cbind(fitIPV_JAL1$aic,fitIPV_JAL2$aic,fitIPV_JAL3$aic)
colnames(AIC_IPV_JAL)<-c("1 lag","2 lags", "3 lags")
# UNEMP - JAL
UNEMP_JAL_v<-as.vector(UNEMP_JAL)
CV_JAL_v<-as.vector(CV_JAL)
UNEMP_JAL_v2<-cbind(UNEMP_JAL_v,CV_JAL_v)
colnames(UNEMP_JAL_v2)<-c("UNEMP_JAL","CV_JAL")
a<- lag(UNEMP_JAL_v,0)
x<- lag(UNEMP_JAL_v,1)
y<- lag(UNEMP_JAL_v,2)
z<- lag(UNEMP_JAL_v,3)
UNEMP_JAL_lags <- cbind(x,y,z)

fitUNEMP_JAL1 <- auto.arima(UNEMP_JAL_v2[4: 63,2], xreg=UNEMP_JAL_lags[4: 63,1], d=0)
fitUNEMP_JAL2 <- auto.arima(UNEMP_JAL_v2[4: 63,2], xreg=UNEMP_JAL_lags[4: 63,1:2], d=0)
fitUNEMP_JAL3 <- auto.arima(UNEMP_JAL_v2[4: 63,2], xreg=UNEMP_JAL_lags[4: 63,1:3], d=0)
AIC_UNEMP_JAL <- cbind(fitUNEMP_JAL1$aic,fitUNEMP_JAL2$aic,fitUNEMP_JAL3$aic)
colnames(AIC_UNEMP_JAL)<-c("1 lag","2 lags", "3 lags")
# REM - JAL
REM_JAL_v<-as.vector(REM_JAL)
CV_JAL_v<-as.vector(CV_JAL)
REM_JAL_v2<-cbind(REM_JAL_v,CV_JAL_v)
colnames(REM_JAL_v2)<-c("REM_JAL","CV_JAL")
a<- lag(REM_JAL_v,0)
x<- lag(REM_JAL_v,1)
y<- lag(REM_JAL_v,2)
z<- lag(REM_JAL_v,3)
REM_JAL_lags <- cbind(x,y,z)

fitREM_JAL1 <- auto.arima(REM_JAL_v2[4: 63,2], xreg=REM_JAL_lags[4: 63,1], d=0)
fitREM_JAL2 <- auto.arima(REM_JAL_v2[4: 63,2], xreg=REM_JAL_lags[4: 63,1:2], d=0)
fitREM_JAL3 <- auto.arima(REM_JAL_v2[4: 63,2], xreg=REM_JAL_lags[4: 63,1:3], d=0)
AIC_REM_JAL <- cbind(fitREM_JAL1$aic,fitREM_JAL2$aic,fitREM_JAL3$aic)
colnames(AIC_REM_JAL)<-c("1 lag","2 lags", "3 lags")
# GDP - JAL
GDP_JAL_v<-as.vector(GDP_JAL)
CV_JAL_v<-as.vector(CV_JAL)
GDP_JAL_v2<-cbind(GDP_JAL_v,CV_JAL_v)
colnames(GDP_JAL_v2)<-c("GDP_JAL","CV_JAL")
a<- lag(GDP_JAL_v,0)
x<- lag(GDP_JAL_v,1)
y<- lag(GDP_JAL_v,2)
z<- lag(GDP_JAL_v,3)
GDP_JAL_lags <- cbind(x,y,z)

fitGDP_JAL1 <- auto.arima(GDP_JAL_v2[4: 63,2], xreg=GDP_JAL_lags[4: 63,1], d=0)
fitGDP_JAL2 <- auto.arima(GDP_JAL_v2[4: 63,2], xreg=GDP_JAL_lags[4: 63,1:2], d=0)
fitGDP_JAL3 <- auto.arima(GDP_JAL_v2[4: 63,2], xreg=GDP_JAL_lags[4: 63,1:3], d=0)
AIC_GDP_JAL <- cbind(fitGDP_JAL1$aic,fitGDP_JAL2$aic,fitGDP_JAL3$aic)
colnames(AIC_GDP_JAL)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - JAL
INPC_SUB_JAL_v<-as.vector(INPC_SUB_JAL)
CV_JAL_v<-as.vector(CV_JAL)
INPC_SUB_JAL_v2<-cbind(INPC_SUB_JAL_v,CV_JAL_v)
colnames(INPC_SUB_JAL_v2)<-c("INPC_SUB_JAL","CV_JAL")
a<- lag(INPC_SUB_JAL_v,0)
x<- lag(INPC_SUB_JAL_v,1)
y<- lag(INPC_SUB_JAL_v,2)
z<- lag(INPC_SUB_JAL_v,3)
INPC_SUB_JAL_lags <- cbind(x,y,z)

fitINPC_SUB_JAL1 <- auto.arima(INPC_SUB_JAL_v2[4: 63,2], xreg=INPC_SUB_JAL_lags[4: 63,1], d=0)
fitINPC_SUB_JAL2 <- auto.arima(INPC_SUB_JAL_v2[4: 63,2], xreg=INPC_SUB_JAL_lags[4: 63,1:2], d=0)
fitINPC_SUB_JAL3 <- auto.arima(INPC_SUB_JAL_v2[4: 63,2], xreg=INPC_SUB_JAL_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_JAL <- cbind(fitINPC_SUB_JAL1$aic,fitINPC_SUB_JAL2$aic,fitINPC_SUB_JAL3$aic)
colnames(AIC_INPC_SUB_JAL)<-c("1 lag","2 lags", "3 lags")
# INPC_E - JAL
INPC_E_JAL_v<-as.vector(INPC_E_JAL)
CV_JAL_v<-as.vector(CV_JAL)
INPC_E_JAL_v2<-cbind(INPC_E_JAL_v,CV_JAL_v)
colnames(INPC_E_JAL_v2)<-c("INPC_E_JAL","CV_JAL")
a<- lag(INPC_E_JAL_v,0)
x<- lag(INPC_E_JAL_v,1)
y<- lag(INPC_E_JAL_v,2)
z<- lag(INPC_E_JAL_v,3)
INPC_E_JAL_lags <- cbind(x,y,z)

fitINPC_E_JAL1 <- auto.arima(INPC_E_JAL_v2[4: 63,2], xreg=INPC_E_JAL_lags[4: 63,1], d=0)
fitINPC_E_JAL2 <- auto.arima(INPC_E_JAL_v2[4: 63,2], xreg=INPC_E_JAL_lags[4: 63,1:2], d=0)
fitINPC_E_JAL3 <- auto.arima(INPC_E_JAL_v2[4: 63,2], xreg=INPC_E_JAL_lags[4: 63,1:3], d=0)
AIC_INPC_E_JAL <- cbind(fitINPC_E_JAL1$aic,fitINPC_E_JAL2$aic,fitINPC_E_JAL3$aic)
colnames(AIC_INPC_E_JAL)<-c("1 lag","2 lags", "3 lags")
# M1 - JAL
M1_JAL_v<-as.vector(M1_JAL)
CV_JAL_v<-as.vector(CV_JAL)
M1_JAL_v2<-cbind(M1_JAL_v,CV_JAL_v)
colnames(M1_JAL_v2)<-c("M1_JAL","CV_JAL")
a<- lag(M1_JAL_v,0)
x<- lag(M1_JAL_v,1)
y<- lag(M1_JAL_v,2)
z<- lag(M1_JAL_v,3)
M1_JAL_lags <- cbind(x,y,z)

fitM1_JAL1 <- auto.arima(M1_JAL_v2[4: 63,2], xreg=M1_JAL_lags[4: 63,1], d=0)
fitM1_JAL2 <- auto.arima(M1_JAL_v2[4: 63,2], xreg=M1_JAL_lags[4: 63,1:2], d=0)
fitM1_JAL3 <- auto.arima(M1_JAL_v2[4: 63,2], xreg=M1_JAL_lags[4: 63,1:3], d=0)
AIC_M1_JAL <- cbind(fitM1_JAL1$aic,fitM1_JAL2$aic,fitM1_JAL3$aic)
colnames(AIC_M1_JAL)<-c("1 lag","2 lags", "3 lags")
# CONF - JAL
CONF_JAL_v<-as.vector(CONF_JAL)
CV_JAL_v<-as.vector(CV_JAL)
CONF_JAL_v2<-cbind(CONF_JAL_v,CV_JAL_v)
colnames(CONF_JAL_v2)<-c("CONF_JAL","CV_JAL")
a<- lag(CONF_JAL_v,0)
x<- lag(CONF_JAL_v,1)
y<- lag(CONF_JAL_v,2)
z<- lag(CONF_JAL_v,3)
CONF_JAL_lags <- cbind(x,y,z)

fitCONF_JAL1 <- auto.arima(CONF_JAL_v2[4: 63,2], xreg=CONF_JAL_lags[4: 63,1], d=0)
fitCONF_JAL2 <- auto.arima(CONF_JAL_v2[4: 63,2], xreg=CONF_JAL_lags[4: 63,1:2], d=0)
fitCONF_JAL3 <- auto.arima(CONF_JAL_v2[4: 63,2], xreg=CONF_JAL_lags[4: 63,1:3], d=0)
AIC_CONF_JAL <- cbind(fitCONF_JAL1$aic,fitCONF_JAL2$aic,fitCONF_JAL3$aic)
colnames(AIC_CONF_JAL)<-c("1 lag","2 lags", "3 lags")

AICs_JAL<-rbind(AIC_IPV_JAL,AIC_UNEMP_JAL,AIC_REM_JAL,AIC_GDP_JAL,AIC_INPC_SUB_JAL,AIC_INPC_E_JAL,AIC_M1_JAL,AIC_CONF_JAL)
rownames(AICs_JAL)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_JAL
```

```{r}
# MEX
# IPV - MEX
IPV_MEX_v<-as.vector(IPV_MEX)
CV_MEX_v<-as.vector(CV_MEX)
IPV_MEX_v2<-cbind(IPV_MEX_v,CV_MEX_v)
colnames(IPV_MEX_v2)<-c("IPV_MEX","CV_MEX")
a<- lag(IPV_MEX_v,0)
x<- lag(IPV_MEX_v,1)
y<- lag(IPV_MEX_v,2)
z<- lag(IPV_MEX_v,3)
IPV_MEX_lags <- cbind(x,y,z)

fitIPV_MEX1 <- auto.arima(IPV_MEX_v2[4: 63,2], xreg=IPV_MEX_lags[4: 63,1], d=0)
fitIPV_MEX2 <- auto.arima(IPV_MEX_v2[4: 63,2], xreg=IPV_MEX_lags[4: 63,1:2], d=0)
fitIPV_MEX3 <- auto.arima(IPV_MEX_v2[4: 63,2], xreg=IPV_MEX_lags[4: 63,1:3], d=0)
AIC_IPV_MEX <- cbind(fitIPV_MEX1$aic,fitIPV_MEX2$aic,fitIPV_MEX3$aic)
colnames(AIC_IPV_MEX)<-c("1 lag","2 lags", "3 lags")
# UNEMP - MEX
UNEMP_MEX_v<-as.vector(UNEMP_MEX)
CV_MEX_v<-as.vector(CV_MEX)
UNEMP_MEX_v2<-cbind(UNEMP_MEX_v,CV_MEX_v)
colnames(UNEMP_MEX_v2)<-c("UNEMP_MEX","CV_MEX")
a<- lag(UNEMP_MEX_v,0)
x<- lag(UNEMP_MEX_v,1)
y<- lag(UNEMP_MEX_v,2)
z<- lag(UNEMP_MEX_v,3)
UNEMP_MEX_lags <- cbind(x,y,z)

fitUNEMP_MEX1 <- auto.arima(UNEMP_MEX_v2[4: 63,2], xreg=UNEMP_MEX_lags[4: 63,1], d=0)
fitUNEMP_MEX2 <- auto.arima(UNEMP_MEX_v2[4: 63,2], xreg=UNEMP_MEX_lags[4: 63,1:2], d=0)
fitUNEMP_MEX3 <- auto.arima(UNEMP_MEX_v2[4: 63,2], xreg=UNEMP_MEX_lags[4: 63,1:3], d=0)
AIC_UNEMP_MEX <- cbind(fitUNEMP_MEX1$aic,fitUNEMP_MEX2$aic,fitUNEMP_MEX3$aic)
colnames(AIC_UNEMP_MEX)<-c("1 lag","2 lags", "3 lags")
# REM - MEX
REM_MEX_v<-as.vector(REM_MEX)
CV_MEX_v<-as.vector(CV_MEX)
REM_MEX_v2<-cbind(REM_MEX_v,CV_MEX_v)
colnames(REM_MEX_v2)<-c("REM_MEX","CV_MEX")
a<- lag(REM_MEX_v,0)
x<- lag(REM_MEX_v,1)
y<- lag(REM_MEX_v,2)
z<- lag(REM_MEX_v,3)
REM_MEX_lags <- cbind(x,y,z)

fitREM_MEX1 <- auto.arima(REM_MEX_v2[4: 63,2], xreg=REM_MEX_lags[4: 63,1], d=0)
fitREM_MEX2 <- auto.arima(REM_MEX_v2[4: 63,2], xreg=REM_MEX_lags[4: 63,1:2], d=0)
fitREM_MEX3 <- auto.arima(REM_MEX_v2[4: 63,2], xreg=REM_MEX_lags[4: 63,1:3], d=0)
AIC_REM_MEX <- cbind(fitREM_MEX1$aic,fitREM_MEX2$aic,fitREM_MEX3$aic)
colnames(AIC_REM_MEX)<-c("1 lag","2 lags", "3 lags")
# GDP - MEX
GDP_MEX_v<-as.vector(GDP_MEX)
CV_MEX_v<-as.vector(CV_MEX)
GDP_MEX_v2<-cbind(GDP_MEX_v,CV_MEX_v)
colnames(GDP_MEX_v2)<-c("GDP_MEX","CV_MEX")
a<- lag(GDP_MEX_v,0)
x<- lag(GDP_MEX_v,1)
y<- lag(GDP_MEX_v,2)
z<- lag(GDP_MEX_v,3)
GDP_MEX_lags <- cbind(x,y,z)

fitGDP_MEX1 <- auto.arima(GDP_MEX_v2[4: 63,2], xreg=GDP_MEX_lags[4: 63,1], d=0)
fitGDP_MEX2 <- auto.arima(GDP_MEX_v2[4: 63,2], xreg=GDP_MEX_lags[4: 63,1:2], d=0)
fitGDP_MEX3 <- auto.arima(GDP_MEX_v2[4: 63,2], xreg=GDP_MEX_lags[4: 63,1:3], d=0)
AIC_GDP_MEX <- cbind(fitGDP_MEX1$aic,fitGDP_MEX2$aic,fitGDP_MEX3$aic)
colnames(AIC_GDP_MEX)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - MEX
INPC_SUB_MEX_v<-as.vector(INPC_SUB_MEX)
CV_MEX_v<-as.vector(CV_MEX)
INPC_SUB_MEX_v2<-cbind(INPC_SUB_MEX_v,CV_MEX_v)
colnames(INPC_SUB_MEX_v2)<-c("INPC_SUB_MEX","CV_MEX")
a<- lag(INPC_SUB_MEX_v,0)
x<- lag(INPC_SUB_MEX_v,1)
y<- lag(INPC_SUB_MEX_v,2)
z<- lag(INPC_SUB_MEX_v,3)
INPC_SUB_MEX_lags <- cbind(x,y,z)

fitINPC_SUB_MEX1 <- auto.arima(INPC_SUB_MEX_v2[4: 63,2], xreg=INPC_SUB_MEX_lags[4: 63,1], d=0)
fitINPC_SUB_MEX2 <- auto.arima(INPC_SUB_MEX_v2[4: 63,2], xreg=INPC_SUB_MEX_lags[4: 63,1:2], d=0)
fitINPC_SUB_MEX3 <- auto.arima(INPC_SUB_MEX_v2[4: 63,2], xreg=INPC_SUB_MEX_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_MEX <- cbind(fitINPC_SUB_MEX1$aic,fitINPC_SUB_MEX2$aic,fitINPC_SUB_MEX3$aic)
colnames(AIC_INPC_SUB_MEX)<-c("1 lag","2 lags", "3 lags")
# INPC_E - MEX
INPC_E_MEX_v<-as.vector(INPC_E_MEX)
CV_MEX_v<-as.vector(CV_MEX)
INPC_E_MEX_v2<-cbind(INPC_E_MEX_v,CV_MEX_v)
colnames(INPC_E_MEX_v2)<-c("INPC_E_MEX","CV_MEX")
a<- lag(INPC_E_MEX_v,0)
x<- lag(INPC_E_MEX_v,1)
y<- lag(INPC_E_MEX_v,2)
z<- lag(INPC_E_MEX_v,3)
INPC_E_MEX_lags <- cbind(x,y,z)

fitINPC_E_MEX1 <- auto.arima(INPC_E_MEX_v2[4: 63,2], xreg=INPC_E_MEX_lags[4: 63,1], d=0)
fitINPC_E_MEX2 <- auto.arima(INPC_E_MEX_v2[4: 63,2], xreg=INPC_E_MEX_lags[4: 63,1:2], d=0)
fitINPC_E_MEX3 <- auto.arima(INPC_E_MEX_v2[4: 63,2], xreg=INPC_E_MEX_lags[4: 63,1:3], d=0)
AIC_INPC_E_MEX <- cbind(fitINPC_E_MEX1$aic,fitINPC_E_MEX2$aic,fitINPC_E_MEX3$aic)
colnames(AIC_INPC_E_MEX)<-c("1 lag","2 lags", "3 lags")
# M1 - MEX
M1_MEX_v<-as.vector(M1_MEX)
CV_MEX_v<-as.vector(CV_MEX)
M1_MEX_v2<-cbind(M1_MEX_v,CV_MEX_v)
colnames(M1_MEX_v2)<-c("M1_MEX","CV_MEX")
a<- lag(M1_MEX_v,0)
x<- lag(M1_MEX_v,1)
y<- lag(M1_MEX_v,2)
z<- lag(M1_MEX_v,3)
M1_MEX_lags <- cbind(x,y,z)

fitM1_MEX1 <- auto.arima(M1_MEX_v2[4: 63,2], xreg=M1_MEX_lags[4: 63,1], d=0)
fitM1_MEX2 <- auto.arima(M1_MEX_v2[4: 63,2], xreg=M1_MEX_lags[4: 63,1:2], d=0)
fitM1_MEX3 <- auto.arima(M1_MEX_v2[4: 63,2], xreg=M1_MEX_lags[4: 63,1:3], d=0)
AIC_M1_MEX <- cbind(fitM1_MEX1$aic,fitM1_MEX2$aic,fitM1_MEX3$aic)
colnames(AIC_M1_MEX)<-c("1 lag","2 lags", "3 lags")
# CONF - MEX
CONF_MEX_v<-as.vector(CONF_MEX)
CV_MEX_v<-as.vector(CV_MEX)
CONF_MEX_v2<-cbind(CONF_MEX_v,CV_MEX_v)
colnames(CONF_MEX_v2)<-c("CONF_MEX","CV_MEX")
a<- lag(CONF_MEX_v,0)
x<- lag(CONF_MEX_v,1)
y<- lag(CONF_MEX_v,2)
z<- lag(CONF_MEX_v,3)
CONF_MEX_lags <- cbind(x,y,z)

fitCONF_MEX1 <- auto.arima(CONF_MEX_v2[4: 63,2], xreg=CONF_MEX_lags[4: 63,1], d=0)
fitCONF_MEX2 <- auto.arima(CONF_MEX_v2[4: 63,2], xreg=CONF_MEX_lags[4: 63,1:2], d=0)
fitCONF_MEX3 <- auto.arima(CONF_MEX_v2[4: 63,2], xreg=CONF_MEX_lags[4: 63,1:3], d=0)
AIC_CONF_MEX <- cbind(fitCONF_MEX1$aic,fitCONF_MEX2$aic,fitCONF_MEX3$aic)
colnames(AIC_CONF_MEX)<-c("1 lag","2 lags", "3 lags")

AICs_MEX<-rbind(AIC_IPV_MEX,AIC_UNEMP_MEX,AIC_REM_MEX,AIC_GDP_MEX,AIC_INPC_SUB_MEX,AIC_INPC_E_MEX,AIC_M1_MEX,AIC_CONF_MEX)
rownames(AICs_MEX)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_MEX
```

```{r}
# MICH
# IPV - MICH
IPV_MICH_v<-as.vector(IPV_MICH)
CV_MICH_v<-as.vector(CV_MICH)
IPV_MICH_v2<-cbind(IPV_MICH_v,CV_MICH_v)
colnames(IPV_MICH_v2)<-c("IPV_MICH","CV_MICH")
a<- lag(IPV_MICH_v,0)
x<- lag(IPV_MICH_v,1)
y<- lag(IPV_MICH_v,2)
z<- lag(IPV_MICH_v,3)
IPV_MICH_lags <- cbind(x,y,z)

fitIPV_MICH1 <- auto.arima(IPV_MICH_v2[4: 63,2], xreg=IPV_MICH_lags[4: 63,1], d=0)
fitIPV_MICH2 <- auto.arima(IPV_MICH_v2[4: 63,2], xreg=IPV_MICH_lags[4: 63,1:2], d=0)
fitIPV_MICH3 <- auto.arima(IPV_MICH_v2[4: 63,2], xreg=IPV_MICH_lags[4: 63,1:3], d=0)
AIC_IPV_MICH <- cbind(fitIPV_MICH1$aic,fitIPV_MICH2$aic,fitIPV_MICH3$aic)
colnames(AIC_IPV_MICH)<-c("1 lag","2 lags", "3 lags")
# UNEMP - MICH
UNEMP_MICH_v<-as.vector(UNEMP_MICH)
CV_MICH_v<-as.vector(CV_MICH)
UNEMP_MICH_v2<-cbind(UNEMP_MICH_v,CV_MICH_v)
colnames(UNEMP_MICH_v2)<-c("UNEMP_MICH","CV_MICH")
a<- lag(UNEMP_MICH_v,0)
x<- lag(UNEMP_MICH_v,1)
y<- lag(UNEMP_MICH_v,2)
z<- lag(UNEMP_MICH_v,3)
UNEMP_MICH_lags <- cbind(x,y,z)

fitUNEMP_MICH1 <- auto.arima(UNEMP_MICH_v2[4: 63,2], xreg=UNEMP_MICH_lags[4: 63,1], d=0)
fitUNEMP_MICH2 <- auto.arima(UNEMP_MICH_v2[4: 63,2], xreg=UNEMP_MICH_lags[4: 63,1:2], d=0)
fitUNEMP_MICH3 <- auto.arima(UNEMP_MICH_v2[4: 63,2], xreg=UNEMP_MICH_lags[4: 63,1:3], d=0)
AIC_UNEMP_MICH <- cbind(fitUNEMP_MICH1$aic,fitUNEMP_MICH2$aic,fitUNEMP_MICH3$aic)
colnames(AIC_UNEMP_MICH)<-c("1 lag","2 lags", "3 lags")
# REM - MICH
REM_MICH_v<-as.vector(REM_MICH)
CV_MICH_v<-as.vector(CV_MICH)
REM_MICH_v2<-cbind(REM_MICH_v,CV_MICH_v)
colnames(REM_MICH_v2)<-c("REM_MICH","CV_MICH")
a<- lag(REM_MICH_v,0)
x<- lag(REM_MICH_v,1)
y<- lag(REM_MICH_v,2)
z<- lag(REM_MICH_v,3)
REM_MICH_lags <- cbind(x,y,z)

fitREM_MICH1 <- auto.arima(REM_MICH_v2[4: 63,2], xreg=REM_MICH_lags[4: 63,1], d=0)
fitREM_MICH2 <- auto.arima(REM_MICH_v2[4: 63,2], xreg=REM_MICH_lags[4: 63,1:2], d=0)
fitREM_MICH3 <- auto.arima(REM_MICH_v2[4: 63,2], xreg=REM_MICH_lags[4: 63,1:3], d=0)
AIC_REM_MICH <- cbind(fitREM_MICH1$aic,fitREM_MICH2$aic,fitREM_MICH3$aic)
colnames(AIC_REM_MICH)<-c("1 lag","2 lags", "3 lags")
# GDP - MICH
GDP_MICH_v<-as.vector(GDP_MICH)
CV_MICH_v<-as.vector(CV_MICH)
GDP_MICH_v2<-cbind(GDP_MICH_v,CV_MICH_v)
colnames(GDP_MICH_v2)<-c("GDP_MICH","CV_MICH")
a<- lag(GDP_MICH_v,0)
x<- lag(GDP_MICH_v,1)
y<- lag(GDP_MICH_v,2)
z<- lag(GDP_MICH_v,3)
GDP_MICH_lags <- cbind(x,y,z)

fitGDP_MICH1 <- auto.arima(GDP_MICH_v2[4: 63,2], xreg=GDP_MICH_lags[4: 63,1], d=0)
fitGDP_MICH2 <- auto.arima(GDP_MICH_v2[4: 63,2], xreg=GDP_MICH_lags[4: 63,1:2], d=0)
fitGDP_MICH3 <- auto.arima(GDP_MICH_v2[4: 63,2], xreg=GDP_MICH_lags[4: 63,1:3], d=0)
AIC_GDP_MICH <- cbind(fitGDP_MICH1$aic,fitGDP_MICH2$aic,fitGDP_MICH3$aic)
colnames(AIC_GDP_MICH)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - MICH
INPC_SUB_MICH_v<-as.vector(INPC_SUB_MICH)
CV_MICH_v<-as.vector(CV_MICH)
INPC_SUB_MICH_v2<-cbind(INPC_SUB_MICH_v,CV_MICH_v)
colnames(INPC_SUB_MICH_v2)<-c("INPC_SUB_MICH","CV_MICH")
a<- lag(INPC_SUB_MICH_v,0)
x<- lag(INPC_SUB_MICH_v,1)
y<- lag(INPC_SUB_MICH_v,2)
z<- lag(INPC_SUB_MICH_v,3)
INPC_SUB_MICH_lags <- cbind(x,y,z)

fitINPC_SUB_MICH1 <- auto.arima(INPC_SUB_MICH_v2[4: 63,2], xreg=INPC_SUB_MICH_lags[4: 63,1], d=0)
fitINPC_SUB_MICH2 <- auto.arima(INPC_SUB_MICH_v2[4: 63,2], xreg=INPC_SUB_MICH_lags[4: 63,1:2], d=0)
fitINPC_SUB_MICH3 <- auto.arima(INPC_SUB_MICH_v2[4: 63,2], xreg=INPC_SUB_MICH_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_MICH <- cbind(fitINPC_SUB_MICH1$aic,fitINPC_SUB_MICH2$aic,fitINPC_SUB_MICH3$aic)
colnames(AIC_INPC_SUB_MICH)<-c("1 lag","2 lags", "3 lags")
# INPC_E - MICH
INPC_E_MICH_v<-as.vector(INPC_E_MICH)
CV_MICH_v<-as.vector(CV_MICH)
INPC_E_MICH_v2<-cbind(INPC_E_MICH_v,CV_MICH_v)
colnames(INPC_E_MICH_v2)<-c("INPC_E_MICH","CV_MICH")
a<- lag(INPC_E_MICH_v,0)
x<- lag(INPC_E_MICH_v,1)
y<- lag(INPC_E_MICH_v,2)
z<- lag(INPC_E_MICH_v,3)
INPC_E_MICH_lags <- cbind(x,y,z)

fitINPC_E_MICH1 <- auto.arima(INPC_E_MICH_v2[4: 63,2], xreg=INPC_E_MICH_lags[4: 63,1], d=0)
fitINPC_E_MICH2 <- auto.arima(INPC_E_MICH_v2[4: 63,2], xreg=INPC_E_MICH_lags[4: 63,1:2], d=0)
fitINPC_E_MICH3 <- auto.arima(INPC_E_MICH_v2[4: 63,2], xreg=INPC_E_MICH_lags[4: 63,1:3], d=0)
AIC_INPC_E_MICH <- cbind(fitINPC_E_MICH1$aic,fitINPC_E_MICH2$aic,fitINPC_E_MICH3$aic)
colnames(AIC_INPC_E_MICH)<-c("1 lag","2 lags", "3 lags")
# M1 - MICH
M1_MICH_v<-as.vector(M1_MICH)
CV_MICH_v<-as.vector(CV_MICH)
M1_MICH_v2<-cbind(M1_MICH_v,CV_MICH_v)
colnames(M1_MICH_v2)<-c("M1_MICH","CV_MICH")
a<- lag(M1_MICH_v,0)
x<- lag(M1_MICH_v,1)
y<- lag(M1_MICH_v,2)
z<- lag(M1_MICH_v,3)
M1_MICH_lags <- cbind(x,y,z)

fitM1_MICH1 <- auto.arima(M1_MICH_v2[4: 63,2], xreg=M1_MICH_lags[4: 63,1], d=0)
fitM1_MICH2 <- auto.arima(M1_MICH_v2[4: 63,2], xreg=M1_MICH_lags[4: 63,1:2], d=0)
fitM1_MICH3 <- auto.arima(M1_MICH_v2[4: 63,2], xreg=M1_MICH_lags[4: 63,1:3], d=0)
AIC_M1_MICH <- cbind(fitM1_MICH1$aic,fitM1_MICH2$aic,fitM1_MICH3$aic)
colnames(AIC_M1_MICH)<-c("1 lag","2 lags", "3 lags")
# CONF - MICH
CONF_MICH_v<-as.vector(CONF_MICH)
CV_MICH_v<-as.vector(CV_MICH)
CONF_MICH_v2<-cbind(CONF_MICH_v,CV_MICH_v)
colnames(CONF_MICH_v2)<-c("CONF_MICH","CV_MICH")
a<- lag(CONF_MICH_v,0)
x<- lag(CONF_MICH_v,1)
y<- lag(CONF_MICH_v,2)
z<- lag(CONF_MICH_v,3)
CONF_MICH_lags <- cbind(x,y,z)

fitCONF_MICH1 <- auto.arima(CONF_MICH_v2[4: 63,2], xreg=CONF_MICH_lags[4: 63,1], d=0)
fitCONF_MICH2 <- auto.arima(CONF_MICH_v2[4: 63,2], xreg=CONF_MICH_lags[4: 63,1:2], d=0)
fitCONF_MICH3 <- auto.arima(CONF_MICH_v2[4: 63,2], xreg=CONF_MICH_lags[4: 63,1:3], d=0)
AIC_CONF_MICH <- cbind(fitCONF_MICH1$aic,fitCONF_MICH2$aic,fitCONF_MICH3$aic)
colnames(AIC_CONF_MICH)<-c("1 lag","2 lags", "3 lags")

AICs_MICH<-rbind(AIC_IPV_MICH,AIC_UNEMP_MICH,AIC_REM_MICH,AIC_GDP_MICH,AIC_INPC_SUB_MICH,AIC_INPC_E_MICH,AIC_M1_MICH,AIC_CONF_MICH)
rownames(AICs_MICH)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_MICH
```

```{r}
# MOR
# IPV - MOR
IPV_MOR_v<-as.vector(IPV_MOR)
CV_MOR_v<-as.vector(CV_MOR)
IPV_MOR_v2<-cbind(IPV_MOR_v,CV_MOR_v)
colnames(IPV_MOR_v2)<-c("IPV_MOR","CV_MOR")
a<- lag(IPV_MOR_v,0)
x<- lag(IPV_MOR_v,1)
y<- lag(IPV_MOR_v,2)
z<- lag(IPV_MOR_v,3)
IPV_MOR_lags <- cbind(x,y,z)

fitIPV_MOR1 <- auto.arima(IPV_MOR_v2[4: 63,2], xreg=IPV_MOR_lags[4: 63,1], d=0)
fitIPV_MOR2 <- auto.arima(IPV_MOR_v2[4: 63,2], xreg=IPV_MOR_lags[4: 63,1:2], d=0)
fitIPV_MOR3 <- auto.arima(IPV_MOR_v2[4: 63,2], xreg=IPV_MOR_lags[4: 63,1:3], d=0)
AIC_IPV_MOR <- cbind(fitIPV_MOR1$aic,fitIPV_MOR2$aic,fitIPV_MOR3$aic)
colnames(AIC_IPV_MOR)<-c("1 lag","2 lags", "3 lags")
# UNEMP - MOR
UNEMP_MOR_v<-as.vector(UNEMP_MOR)
CV_MOR_v<-as.vector(CV_MOR)
UNEMP_MOR_v2<-cbind(UNEMP_MOR_v,CV_MOR_v)
colnames(UNEMP_MOR_v2)<-c("UNEMP_MOR","CV_MOR")
a<- lag(UNEMP_MOR_v,0)
x<- lag(UNEMP_MOR_v,1)
y<- lag(UNEMP_MOR_v,2)
z<- lag(UNEMP_MOR_v,3)
UNEMP_MOR_lags <- cbind(x,y,z)

fitUNEMP_MOR1 <- auto.arima(UNEMP_MOR_v2[4: 63,2], xreg=UNEMP_MOR_lags[4: 63,1], d=0)
fitUNEMP_MOR2 <- auto.arima(UNEMP_MOR_v2[4: 63,2], xreg=UNEMP_MOR_lags[4: 63,1:2], d=0)
fitUNEMP_MOR3 <- auto.arima(UNEMP_MOR_v2[4: 63,2], xreg=UNEMP_MOR_lags[4: 63,1:3], d=0)
AIC_UNEMP_MOR <- cbind(fitUNEMP_MOR1$aic,fitUNEMP_MOR2$aic,fitUNEMP_MOR3$aic)
colnames(AIC_UNEMP_MOR)<-c("1 lag","2 lags", "3 lags")
# REM - MOR
REM_MOR_v<-as.vector(REM_MOR)
CV_MOR_v<-as.vector(CV_MOR)
REM_MOR_v2<-cbind(REM_MOR_v,CV_MOR_v)
colnames(REM_MOR_v2)<-c("REM_MOR","CV_MOR")
a<- lag(REM_MOR_v,0)
x<- lag(REM_MOR_v,1)
y<- lag(REM_MOR_v,2)
z<- lag(REM_MOR_v,3)
REM_MOR_lags <- cbind(x,y,z)

fitREM_MOR1 <- auto.arima(REM_MOR_v2[4: 63,2], xreg=REM_MOR_lags[4: 63,1], d=0)
fitREM_MOR2 <- auto.arima(REM_MOR_v2[4: 63,2], xreg=REM_MOR_lags[4: 63,1:2], d=0)
fitREM_MOR3 <- auto.arima(REM_MOR_v2[4: 63,2], xreg=REM_MOR_lags[4: 63,1:3], d=0)
AIC_REM_MOR <- cbind(fitREM_MOR1$aic,fitREM_MOR2$aic,fitREM_MOR3$aic)
colnames(AIC_REM_MOR)<-c("1 lag","2 lags", "3 lags")
# GDP - MOR
GDP_MOR_v<-as.vector(GDP_MOR)
CV_MOR_v<-as.vector(CV_MOR)
GDP_MOR_v2<-cbind(GDP_MOR_v,CV_MOR_v)
colnames(GDP_MOR_v2)<-c("GDP_MOR","CV_MOR")
a<- lag(GDP_MOR_v,0)
x<- lag(GDP_MOR_v,1)
y<- lag(GDP_MOR_v,2)
z<- lag(GDP_MOR_v,3)
GDP_MOR_lags <- cbind(x,y,z)

fitGDP_MOR1 <- auto.arima(GDP_MOR_v2[4: 63,2], xreg=GDP_MOR_lags[4: 63,1], d=0)
fitGDP_MOR2 <- auto.arima(GDP_MOR_v2[4: 63,2], xreg=GDP_MOR_lags[4: 63,1:2], d=0)
fitGDP_MOR3 <- auto.arima(GDP_MOR_v2[4: 63,2], xreg=GDP_MOR_lags[4: 63,1:3], d=0)
AIC_GDP_MOR <- cbind(fitGDP_MOR1$aic,fitGDP_MOR2$aic,fitGDP_MOR3$aic)
colnames(AIC_GDP_MOR)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - MOR
INPC_SUB_MOR_v<-as.vector(INPC_SUB_MOR)
CV_MOR_v<-as.vector(CV_MOR)
INPC_SUB_MOR_v2<-cbind(INPC_SUB_MOR_v,CV_MOR_v)
colnames(INPC_SUB_MOR_v2)<-c("INPC_SUB_MOR","CV_MOR")
a<- lag(INPC_SUB_MOR_v,0)
x<- lag(INPC_SUB_MOR_v,1)
y<- lag(INPC_SUB_MOR_v,2)
z<- lag(INPC_SUB_MOR_v,3)
INPC_SUB_MOR_lags <- cbind(x,y,z)

fitINPC_SUB_MOR1 <- auto.arima(INPC_SUB_MOR_v2[4: 63,2], xreg=INPC_SUB_MOR_lags[4: 63,1], d=0)
fitINPC_SUB_MOR2 <- auto.arima(INPC_SUB_MOR_v2[4: 63,2], xreg=INPC_SUB_MOR_lags[4: 63,1:2], d=0)
fitINPC_SUB_MOR3 <- auto.arima(INPC_SUB_MOR_v2[4: 63,2], xreg=INPC_SUB_MOR_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_MOR <- cbind(fitINPC_SUB_MOR1$aic,fitINPC_SUB_MOR2$aic,fitINPC_SUB_MOR3$aic)
colnames(AIC_INPC_SUB_MOR)<-c("1 lag","2 lags", "3 lags")
# INPC_E - MOR
INPC_E_MOR_v<-as.vector(INPC_E_MOR)
CV_MOR_v<-as.vector(CV_MOR)
INPC_E_MOR_v2<-cbind(INPC_E_MOR_v,CV_MOR_v)
colnames(INPC_E_MOR_v2)<-c("INPC_E_MOR","CV_MOR")
a<- lag(INPC_E_MOR_v,0)
x<- lag(INPC_E_MOR_v,1)
y<- lag(INPC_E_MOR_v,2)
z<- lag(INPC_E_MOR_v,3)
INPC_E_MOR_lags <- cbind(x,y,z)

fitINPC_E_MOR1 <- auto.arima(INPC_E_MOR_v2[4: 63,2], xreg=INPC_E_MOR_lags[4: 63,1], d=0)
fitINPC_E_MOR2 <- auto.arima(INPC_E_MOR_v2[4: 63,2], xreg=INPC_E_MOR_lags[4: 63,1:2], d=0)
fitINPC_E_MOR3 <- auto.arima(INPC_E_MOR_v2[4: 63,2], xreg=INPC_E_MOR_lags[4: 63,1:3], d=0)
AIC_INPC_E_MOR <- cbind(fitINPC_E_MOR1$aic,fitINPC_E_MOR2$aic,fitINPC_E_MOR3$aic)
colnames(AIC_INPC_E_MOR)<-c("1 lag","2 lags", "3 lags")
# M1 - MOR
M1_MOR_v<-as.vector(M1_MOR)
CV_MOR_v<-as.vector(CV_MOR)
M1_MOR_v2<-cbind(M1_MOR_v,CV_MOR_v)
colnames(M1_MOR_v2)<-c("M1_MOR","CV_MOR")
a<- lag(M1_MOR_v,0)
x<- lag(M1_MOR_v,1)
y<- lag(M1_MOR_v,2)
z<- lag(M1_MOR_v,3)
M1_MOR_lags <- cbind(x,y,z)

fitM1_MOR1 <- auto.arima(M1_MOR_v2[4: 63,2], xreg=M1_MOR_lags[4: 63,1], d=0)
fitM1_MOR2 <- auto.arima(M1_MOR_v2[4: 63,2], xreg=M1_MOR_lags[4: 63,1:2], d=0)
fitM1_MOR3 <- auto.arima(M1_MOR_v2[4: 63,2], xreg=M1_MOR_lags[4: 63,1:3], d=0)
AIC_M1_MOR <- cbind(fitM1_MOR1$aic,fitM1_MOR2$aic,fitM1_MOR3$aic)
colnames(AIC_M1_MOR)<-c("1 lag","2 lags", "3 lags")
# CONF - MOR
CONF_MOR_v<-as.vector(CONF_MOR)
CV_MOR_v<-as.vector(CV_MOR)
CONF_MOR_v2<-cbind(CONF_MOR_v,CV_MOR_v)
colnames(CONF_MOR_v2)<-c("CONF_MOR","CV_MOR")
a<- lag(CONF_MOR_v,0)
x<- lag(CONF_MOR_v,1)
y<- lag(CONF_MOR_v,2)
z<- lag(CONF_MOR_v,3)
CONF_MOR_lags <- cbind(x,y,z)

fitCONF_MOR1 <- auto.arima(CONF_MOR_v2[4: 63,2], xreg=CONF_MOR_lags[4: 63,1], d=0)
fitCONF_MOR2 <- auto.arima(CONF_MOR_v2[4: 63,2], xreg=CONF_MOR_lags[4: 63,1:2], d=0)
fitCONF_MOR3 <- auto.arima(CONF_MOR_v2[4: 63,2], xreg=CONF_MOR_lags[4: 63,1:3], d=0)
AIC_CONF_MOR <- cbind(fitCONF_MOR1$aic,fitCONF_MOR2$aic,fitCONF_MOR3$aic)
colnames(AIC_CONF_MOR)<-c("1 lag","2 lags", "3 lags")

AICs_MOR<-rbind(AIC_IPV_MOR,AIC_UNEMP_MOR,AIC_REM_MOR,AIC_GDP_MOR,AIC_INPC_SUB_MOR,AIC_INPC_E_MOR,AIC_M1_MOR,AIC_CONF_MOR)
rownames(AICs_MOR)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_MOR
```

```{r}
# NAY
# IPV - NAY
IPV_NAY_v<-as.vector(IPV_NAY)
CV_NAY_v<-as.vector(CV_NAY)
IPV_NAY_v2<-cbind(IPV_NAY_v,CV_NAY_v)
colnames(IPV_NAY_v2)<-c("IPV_NAY","CV_NAY")
a<- lag(IPV_NAY_v,0)
x<- lag(IPV_NAY_v,1)
y<- lag(IPV_NAY_v,2)
z<- lag(IPV_NAY_v,3)
IPV_NAY_lags <- cbind(x,y,z)

fitIPV_NAY1 <- auto.arima(IPV_NAY_v2[4: 63,2], xreg=IPV_NAY_lags[4: 63,1], d=0)
fitIPV_NAY2 <- auto.arima(IPV_NAY_v2[4: 63,2], xreg=IPV_NAY_lags[4: 63,1:2], d=0)
fitIPV_NAY3 <- auto.arima(IPV_NAY_v2[4: 63,2], xreg=IPV_NAY_lags[4: 63,1:3], d=0)
AIC_IPV_NAY <- cbind(fitIPV_NAY1$aic,fitIPV_NAY2$aic,fitIPV_NAY3$aic)
colnames(AIC_IPV_NAY)<-c("1 lag","2 lags", "3 lags")
# UNEMP - NAY
UNEMP_NAY_v<-as.vector(UNEMP_NAY)
CV_NAY_v<-as.vector(CV_NAY)
UNEMP_NAY_v2<-cbind(UNEMP_NAY_v,CV_NAY_v)
colnames(UNEMP_NAY_v2)<-c("UNEMP_NAY","CV_NAY")
a<- lag(UNEMP_NAY_v,0)
x<- lag(UNEMP_NAY_v,1)
y<- lag(UNEMP_NAY_v,2)
z<- lag(UNEMP_NAY_v,3)
UNEMP_NAY_lags <- cbind(x,y,z)

fitUNEMP_NAY1 <- auto.arima(UNEMP_NAY_v2[4: 63,2], xreg=UNEMP_NAY_lags[4: 63,1], d=0)
fitUNEMP_NAY2 <- auto.arima(UNEMP_NAY_v2[4: 63,2], xreg=UNEMP_NAY_lags[4: 63,1:2], d=0)
fitUNEMP_NAY3 <- auto.arima(UNEMP_NAY_v2[4: 63,2], xreg=UNEMP_NAY_lags[4: 63,1:3], d=0)
AIC_UNEMP_NAY <- cbind(fitUNEMP_NAY1$aic,fitUNEMP_NAY2$aic,fitUNEMP_NAY3$aic)
colnames(AIC_UNEMP_NAY)<-c("1 lag","2 lags", "3 lags")
# REM - NAY
REM_NAY_v<-as.vector(REM_NAY)
CV_NAY_v<-as.vector(CV_NAY)
REM_NAY_v2<-cbind(REM_NAY_v,CV_NAY_v)
colnames(REM_NAY_v2)<-c("REM_NAY","CV_NAY")
a<- lag(REM_NAY_v,0)
x<- lag(REM_NAY_v,1)
y<- lag(REM_NAY_v,2)
z<- lag(REM_NAY_v,3)
REM_NAY_lags <- cbind(x,y,z)

fitREM_NAY1 <- auto.arima(REM_NAY_v2[4: 63,2], xreg=REM_NAY_lags[4: 63,1], d=0)
fitREM_NAY2 <- auto.arima(REM_NAY_v2[4: 63,2], xreg=REM_NAY_lags[4: 63,1:2], d=0)
fitREM_NAY3 <- auto.arima(REM_NAY_v2[4: 63,2], xreg=REM_NAY_lags[4: 63,1:3], d=0)
AIC_REM_NAY <- cbind(fitREM_NAY1$aic,fitREM_NAY2$aic,fitREM_NAY3$aic)
colnames(AIC_REM_NAY)<-c("1 lag","2 lags", "3 lags")
# GDP - NAY
GDP_NAY_v<-as.vector(GDP_NAY)
CV_NAY_v<-as.vector(CV_NAY)
GDP_NAY_v2<-cbind(GDP_NAY_v,CV_NAY_v)
colnames(GDP_NAY_v2)<-c("GDP_NAY","CV_NAY")
a<- lag(GDP_NAY_v,0)
x<- lag(GDP_NAY_v,1)
y<- lag(GDP_NAY_v,2)
z<- lag(GDP_NAY_v,3)
GDP_NAY_lags <- cbind(x,y,z)

fitGDP_NAY1 <- auto.arima(GDP_NAY_v2[4: 63,2], xreg=GDP_NAY_lags[4: 63,1], d=0)
fitGDP_NAY2 <- auto.arima(GDP_NAY_v2[4: 63,2], xreg=GDP_NAY_lags[4: 63,1:2], d=0)
fitGDP_NAY3 <- auto.arima(GDP_NAY_v2[4: 63,2], xreg=GDP_NAY_lags[4: 63,1:3], d=0)
AIC_GDP_NAY <- cbind(fitGDP_NAY1$aic,fitGDP_NAY2$aic,fitGDP_NAY3$aic)
colnames(AIC_GDP_NAY)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - NAY
INPC_SUB_NAY_v<-as.vector(INPC_SUB_NAY)
CV_NAY_v<-as.vector(CV_NAY)
INPC_SUB_NAY_v2<-cbind(INPC_SUB_NAY_v,CV_NAY_v)
colnames(INPC_SUB_NAY_v2)<-c("INPC_SUB_NAY","CV_NAY")
a<- lag(INPC_SUB_NAY_v,0)
x<- lag(INPC_SUB_NAY_v,1)
y<- lag(INPC_SUB_NAY_v,2)
z<- lag(INPC_SUB_NAY_v,3)
INPC_SUB_NAY_lags <- cbind(x,y,z)

fitINPC_SUB_NAY1 <- auto.arima(INPC_SUB_NAY_v2[4: 63,2], xreg=INPC_SUB_NAY_lags[4: 63,1], d=0)
fitINPC_SUB_NAY2 <- auto.arima(INPC_SUB_NAY_v2[4: 63,2], xreg=INPC_SUB_NAY_lags[4: 63,1:2], d=0)
fitINPC_SUB_NAY3 <- auto.arima(INPC_SUB_NAY_v2[4: 63,2], xreg=INPC_SUB_NAY_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_NAY <- cbind(fitINPC_SUB_NAY1$aic,fitINPC_SUB_NAY2$aic,fitINPC_SUB_NAY3$aic)
colnames(AIC_INPC_SUB_NAY)<-c("1 lag","2 lags", "3 lags")
# INPC_E - NAY
INPC_E_NAY_v<-as.vector(INPC_E_NAY)
CV_NAY_v<-as.vector(CV_NAY)
INPC_E_NAY_v2<-cbind(INPC_E_NAY_v,CV_NAY_v)
colnames(INPC_E_NAY_v2)<-c("INPC_E_NAY","CV_NAY")
a<- lag(INPC_E_NAY_v,0)
x<- lag(INPC_E_NAY_v,1)
y<- lag(INPC_E_NAY_v,2)
z<- lag(INPC_E_NAY_v,3)
INPC_E_NAY_lags <- cbind(x,y,z)

fitINPC_E_NAY1 <- auto.arima(INPC_E_NAY_v2[4: 63,2], xreg=INPC_E_NAY_lags[4: 63,1], d=0)
fitINPC_E_NAY2 <- auto.arima(INPC_E_NAY_v2[4: 63,2], xreg=INPC_E_NAY_lags[4: 63,1:2], d=0)
fitINPC_E_NAY3 <- auto.arima(INPC_E_NAY_v2[4: 63,2], xreg=INPC_E_NAY_lags[4: 63,1:3], d=0)
AIC_INPC_E_NAY <- cbind(fitINPC_E_NAY1$aic,fitINPC_E_NAY2$aic,fitINPC_E_NAY3$aic)
colnames(AIC_INPC_E_NAY)<-c("1 lag","2 lags", "3 lags")
# M1 - NAY
M1_NAY_v<-as.vector(M1_NAY)
CV_NAY_v<-as.vector(CV_NAY)
M1_NAY_v2<-cbind(M1_NAY_v,CV_NAY_v)
colnames(M1_NAY_v2)<-c("M1_NAY","CV_NAY")
a<- lag(M1_NAY_v,0)
x<- lag(M1_NAY_v,1)
y<- lag(M1_NAY_v,2)
z<- lag(M1_NAY_v,3)
M1_NAY_lags <- cbind(x,y,z)

fitM1_NAY1 <- auto.arima(M1_NAY_v2[4: 63,2], xreg=M1_NAY_lags[4: 63,1], d=0)
fitM1_NAY2 <- auto.arima(M1_NAY_v2[4: 63,2], xreg=M1_NAY_lags[4: 63,1:2], d=0)
fitM1_NAY3 <- auto.arima(M1_NAY_v2[4: 63,2], xreg=M1_NAY_lags[4: 63,1:3], d=0)
AIC_M1_NAY <- cbind(fitM1_NAY1$aic,fitM1_NAY2$aic,fitM1_NAY3$aic)
colnames(AIC_M1_NAY)<-c("1 lag","2 lags", "3 lags")
# CONF - NAY
CONF_NAY_v<-as.vector(CONF_NAY)
CV_NAY_v<-as.vector(CV_NAY)
CONF_NAY_v2<-cbind(CONF_NAY_v,CV_NAY_v)
colnames(CONF_NAY_v2)<-c("CONF_NAY","CV_NAY")
a<- lag(CONF_NAY_v,0)
x<- lag(CONF_NAY_v,1)
y<- lag(CONF_NAY_v,2)
z<- lag(CONF_NAY_v,3)
CONF_NAY_lags <- cbind(x,y,z)

fitCONF_NAY1 <- auto.arima(CONF_NAY_v2[4: 63,2], xreg=CONF_NAY_lags[4: 63,1], d=0)
fitCONF_NAY2 <- auto.arima(CONF_NAY_v2[4: 63,2], xreg=CONF_NAY_lags[4: 63,1:2], d=0)
fitCONF_NAY3 <- auto.arima(CONF_NAY_v2[4: 63,2], xreg=CONF_NAY_lags[4: 63,1:3], d=0)
AIC_CONF_NAY <- cbind(fitCONF_NAY1$aic,fitCONF_NAY2$aic,fitCONF_NAY3$aic)
colnames(AIC_CONF_NAY)<-c("1 lag","2 lags", "3 lags")

AICs_NAY<-rbind(AIC_IPV_NAY,AIC_UNEMP_NAY,AIC_REM_NAY,AIC_GDP_NAY,AIC_INPC_SUB_NAY,AIC_INPC_E_NAY,AIC_M1_NAY,AIC_CONF_NAY)
rownames(AICs_NAY)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_NAY
```

```{r}
# NL
# IPV - NL
IPV_NL_v<-as.vector(IPV_NL)
CV_NL_v<-as.vector(CV_NL)
IPV_NL_v2<-cbind(IPV_NL_v,CV_NL_v)
colnames(IPV_NL_v2)<-c("IPV_NL","CV_NL")
a<- lag(IPV_NL_v,0)
x<- lag(IPV_NL_v,1)
y<- lag(IPV_NL_v,2)
z<- lag(IPV_NL_v,3)
IPV_NL_lags <- cbind(x,y,z)

fitIPV_NL1 <- auto.arima(IPV_NL_v2[4: 63,2], xreg=IPV_NL_lags[4: 63,1], d=0)
fitIPV_NL2 <- auto.arima(IPV_NL_v2[4: 63,2], xreg=IPV_NL_lags[4: 63,1:2], d=0)
fitIPV_NL3 <- auto.arima(IPV_NL_v2[4: 63,2], xreg=IPV_NL_lags[4: 63,1:3], d=0)
AIC_IPV_NL <- cbind(fitIPV_NL1$aic,fitIPV_NL2$aic,fitIPV_NL3$aic)
colnames(AIC_IPV_NL)<-c("1 lag","2 lags", "3 lags")
# UNEMP - NL
UNEMP_NL_v<-as.vector(UNEMP_NL)
CV_NL_v<-as.vector(CV_NL)
UNEMP_NL_v2<-cbind(UNEMP_NL_v,CV_NL_v)
colnames(UNEMP_NL_v2)<-c("UNEMP_NL","CV_NL")
a<- lag(UNEMP_NL_v,0)
x<- lag(UNEMP_NL_v,1)
y<- lag(UNEMP_NL_v,2)
z<- lag(UNEMP_NL_v,3)
UNEMP_NL_lags <- cbind(x,y,z)

fitUNEMP_NL1 <- auto.arima(UNEMP_NL_v2[4: 63,2], xreg=UNEMP_NL_lags[4: 63,1], d=0)
fitUNEMP_NL2 <- auto.arima(UNEMP_NL_v2[4: 63,2], xreg=UNEMP_NL_lags[4: 63,1:2], d=0)
fitUNEMP_NL3 <- auto.arima(UNEMP_NL_v2[4: 63,2], xreg=UNEMP_NL_lags[4: 63,1:3], d=0)
AIC_UNEMP_NL <- cbind(fitUNEMP_NL1$aic,fitUNEMP_NL2$aic,fitUNEMP_NL3$aic)
colnames(AIC_UNEMP_NL)<-c("1 lag","2 lags", "3 lags")
# REM - NL
REM_NL_v<-as.vector(REM_NL)
CV_NL_v<-as.vector(CV_NL)
REM_NL_v2<-cbind(REM_NL_v,CV_NL_v)
colnames(REM_NL_v2)<-c("REM_NL","CV_NL")
a<- lag(REM_NL_v,0)
x<- lag(REM_NL_v,1)
y<- lag(REM_NL_v,2)
z<- lag(REM_NL_v,3)
REM_NL_lags <- cbind(x,y,z)

fitREM_NL1 <- auto.arima(REM_NL_v2[4: 63,2], xreg=REM_NL_lags[4: 63,1], d=0)
fitREM_NL2 <- auto.arima(REM_NL_v2[4: 63,2], xreg=REM_NL_lags[4: 63,1:2], d=0)
fitREM_NL3 <- auto.arima(REM_NL_v2[4: 63,2], xreg=REM_NL_lags[4: 63,1:3], d=0)
AIC_REM_NL <- cbind(fitREM_NL1$aic,fitREM_NL2$aic,fitREM_NL3$aic)
colnames(AIC_REM_NL)<-c("1 lag","2 lags", "3 lags")
# GDP - NL
GDP_NL_v<-as.vector(GDP_NL)
CV_NL_v<-as.vector(CV_NL)
GDP_NL_v2<-cbind(GDP_NL_v,CV_NL_v)
colnames(GDP_NL_v2)<-c("GDP_NL","CV_NL")
a<- lag(GDP_NL_v,0)
x<- lag(GDP_NL_v,1)
y<- lag(GDP_NL_v,2)
z<- lag(GDP_NL_v,3)
GDP_NL_lags <- cbind(x,y,z)

fitGDP_NL1 <- auto.arima(GDP_NL_v2[4: 63,2], xreg=GDP_NL_lags[4: 63,1], d=0)
fitGDP_NL2 <- auto.arima(GDP_NL_v2[4: 63,2], xreg=GDP_NL_lags[4: 63,1:2], d=0)
fitGDP_NL3 <- auto.arima(GDP_NL_v2[4: 63,2], xreg=GDP_NL_lags[4: 63,1:3], d=0)
AIC_GDP_NL <- cbind(fitGDP_NL1$aic,fitGDP_NL2$aic,fitGDP_NL3$aic)
colnames(AIC_GDP_NL)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - NL
INPC_SUB_NL_v<-as.vector(INPC_SUB_NL)
CV_NL_v<-as.vector(CV_NL)
INPC_SUB_NL_v2<-cbind(INPC_SUB_NL_v,CV_NL_v)
colnames(INPC_SUB_NL_v2)<-c("INPC_SUB_NL","CV_NL")
a<- lag(INPC_SUB_NL_v,0)
x<- lag(INPC_SUB_NL_v,1)
y<- lag(INPC_SUB_NL_v,2)
z<- lag(INPC_SUB_NL_v,3)
INPC_SUB_NL_lags <- cbind(x,y,z)

fitINPC_SUB_NL1 <- auto.arima(INPC_SUB_NL_v2[4: 63,2], xreg=INPC_SUB_NL_lags[4: 63,1], d=0)
fitINPC_SUB_NL2 <- auto.arima(INPC_SUB_NL_v2[4: 63,2], xreg=INPC_SUB_NL_lags[4: 63,1:2], d=0)
fitINPC_SUB_NL3 <- auto.arima(INPC_SUB_NL_v2[4: 63,2], xreg=INPC_SUB_NL_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_NL <- cbind(fitINPC_SUB_NL1$aic,fitINPC_SUB_NL2$aic,fitINPC_SUB_NL3$aic)
colnames(AIC_INPC_SUB_NL)<-c("1 lag","2 lags", "3 lags")
# INPC_E - NL
INPC_E_NL_v<-as.vector(INPC_E_NL)
CV_NL_v<-as.vector(CV_NL)
INPC_E_NL_v2<-cbind(INPC_E_NL_v,CV_NL_v)
colnames(INPC_E_NL_v2)<-c("INPC_E_NL","CV_NL")
a<- lag(INPC_E_NL_v,0)
x<- lag(INPC_E_NL_v,1)
y<- lag(INPC_E_NL_v,2)
z<- lag(INPC_E_NL_v,3)
INPC_E_NL_lags <- cbind(x,y,z)

fitINPC_E_NL1 <- auto.arima(INPC_E_NL_v2[4: 63,2], xreg=INPC_E_NL_lags[4: 63,1], d=0)
fitINPC_E_NL2 <- auto.arima(INPC_E_NL_v2[4: 63,2], xreg=INPC_E_NL_lags[4: 63,1:2], d=0)
fitINPC_E_NL3 <- auto.arima(INPC_E_NL_v2[4: 63,2], xreg=INPC_E_NL_lags[4: 63,1:3], d=0)
AIC_INPC_E_NL <- cbind(fitINPC_E_NL1$aic,fitINPC_E_NL2$aic,fitINPC_E_NL3$aic)
colnames(AIC_INPC_E_NL)<-c("1 lag","2 lags", "3 lags")
# M1 - NL
M1_NL_v<-as.vector(M1_NL)
CV_NL_v<-as.vector(CV_NL)
M1_NL_v2<-cbind(M1_NL_v,CV_NL_v)
colnames(M1_NL_v2)<-c("M1_NL","CV_NL")
a<- lag(M1_NL_v,0)
x<- lag(M1_NL_v,1)
y<- lag(M1_NL_v,2)
z<- lag(M1_NL_v,3)
M1_NL_lags <- cbind(x,y,z)

fitM1_NL1 <- auto.arima(M1_NL_v2[4: 63,2], xreg=M1_NL_lags[4: 63,1], d=0)
fitM1_NL2 <- auto.arima(M1_NL_v2[4: 63,2], xreg=M1_NL_lags[4: 63,1:2], d=0)
fitM1_NL3 <- auto.arima(M1_NL_v2[4: 63,2], xreg=M1_NL_lags[4: 63,1:3], d=0)
AIC_M1_NL <- cbind(fitM1_NL1$aic,fitM1_NL2$aic,fitM1_NL3$aic)
colnames(AIC_M1_NL)<-c("1 lag","2 lags", "3 lags")
# CONF - NL
CONF_NL_v<-as.vector(CONF_NL)
CV_NL_v<-as.vector(CV_NL)
CONF_NL_v2<-cbind(CONF_NL_v,CV_NL_v)
colnames(CONF_NL_v2)<-c("CONF_NL","CV_NL")
a<- lag(CONF_NL_v,0)
x<- lag(CONF_NL_v,1)
y<- lag(CONF_NL_v,2)
z<- lag(CONF_NL_v,3)
CONF_NL_lags <- cbind(x,y,z)

fitCONF_NL1 <- auto.arima(CONF_NL_v2[4: 63,2], xreg=CONF_NL_lags[4: 63,1], d=0)
fitCONF_NL2 <- auto.arima(CONF_NL_v2[4: 63,2], xreg=CONF_NL_lags[4: 63,1:2], d=0)
fitCONF_NL3 <- auto.arima(CONF_NL_v2[4: 63,2], xreg=CONF_NL_lags[4: 63,1:3], d=0)
AIC_CONF_NL <- cbind(fitCONF_NL1$aic,fitCONF_NL2$aic,fitCONF_NL3$aic)
colnames(AIC_CONF_NL)<-c("1 lag","2 lags", "3 lags")

AICs_NL<-rbind(AIC_IPV_NL,AIC_UNEMP_NL,AIC_REM_NL,AIC_GDP_NL,AIC_INPC_SUB_NL,AIC_INPC_E_NL,AIC_M1_NL,AIC_CONF_NL)
rownames(AICs_NL)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_NL
```

```{r}
# OAXACA
# IPV - OAXACA
IPV_OAXACA_v<-as.vector(IPV_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
IPV_OAXACA_v2<-cbind(IPV_OAXACA_v,CV_OAXACA_v)
colnames(IPV_OAXACA_v2)<-c("IPV_OAXACA","CV_OAXACA")
a<- lag(IPV_OAXACA_v,0)
x<- lag(IPV_OAXACA_v,1)
y<- lag(IPV_OAXACA_v,2)
z<- lag(IPV_OAXACA_v,3)
IPV_OAXACA_lags <- cbind(x,y,z)

fitIPV_OAXACA1 <- auto.arima(IPV_OAXACA_v2[4: 63,2], xreg=IPV_OAXACA_lags[4: 63,1], d=0)
fitIPV_OAXACA2 <- auto.arima(IPV_OAXACA_v2[4: 63,2], xreg=IPV_OAXACA_lags[4: 63,1:2], d=0)
fitIPV_OAXACA3 <- auto.arima(IPV_OAXACA_v2[4: 63,2], xreg=IPV_OAXACA_lags[4: 63,1:3], d=0)
AIC_IPV_OAXACA <- cbind(fitIPV_OAXACA1$aic,fitIPV_OAXACA2$aic,fitIPV_OAXACA3$aic)
colnames(AIC_IPV_OAXACA)<-c("1 lag","2 lags", "3 lags")
# UNEMP - OAXACA
UNEMP_OAXACA_v<-as.vector(UNEMP_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
UNEMP_OAXACA_v2<-cbind(UNEMP_OAXACA_v,CV_OAXACA_v)
colnames(UNEMP_OAXACA_v2)<-c("UNEMP_OAXACA","CV_OAXACA")
a<- lag(UNEMP_OAXACA_v,0)
x<- lag(UNEMP_OAXACA_v,1)
y<- lag(UNEMP_OAXACA_v,2)
z<- lag(UNEMP_OAXACA_v,3)
UNEMP_OAXACA_lags <- cbind(x,y,z)

fitUNEMP_OAXACA1 <- auto.arima(UNEMP_OAXACA_v2[4: 63,2], xreg=UNEMP_OAXACA_lags[4: 63,1], d=0)
fitUNEMP_OAXACA2 <- auto.arima(UNEMP_OAXACA_v2[4: 63,2], xreg=UNEMP_OAXACA_lags[4: 63,1:2], d=0)
fitUNEMP_OAXACA3 <- auto.arima(UNEMP_OAXACA_v2[4: 63,2], xreg=UNEMP_OAXACA_lags[4: 63,1:3], d=0)
AIC_UNEMP_OAXACA <- cbind(fitUNEMP_OAXACA1$aic,fitUNEMP_OAXACA2$aic,fitUNEMP_OAXACA3$aic)
colnames(AIC_UNEMP_OAXACA)<-c("1 lag","2 lags", "3 lags")
# REM - OAXACA
REM_OAXACA_v<-as.vector(REM_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
REM_OAXACA_v2<-cbind(REM_OAXACA_v,CV_OAXACA_v)
colnames(REM_OAXACA_v2)<-c("REM_OAXACA","CV_OAXACA")
a<- lag(REM_OAXACA_v,0)
x<- lag(REM_OAXACA_v,1)
y<- lag(REM_OAXACA_v,2)
z<- lag(REM_OAXACA_v,3)
REM_OAXACA_lags <- cbind(x,y,z)

fitREM_OAXACA1 <- auto.arima(REM_OAXACA_v2[4: 63,2], xreg=REM_OAXACA_lags[4: 63,1], d=0)
fitREM_OAXACA2 <- auto.arima(REM_OAXACA_v2[4: 63,2], xreg=REM_OAXACA_lags[4: 63,1:2], d=0)
fitREM_OAXACA3 <- auto.arima(REM_OAXACA_v2[4: 63,2], xreg=REM_OAXACA_lags[4: 63,1:3], d=0)
AIC_REM_OAXACA <- cbind(fitREM_OAXACA1$aic,fitREM_OAXACA2$aic,fitREM_OAXACA3$aic)
colnames(AIC_REM_OAXACA)<-c("1 lag","2 lags", "3 lags")
# GDP - OAXACA
GDP_OAXACA_v<-as.vector(GDP_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
GDP_OAXACA_v2<-cbind(GDP_OAXACA_v,CV_OAXACA_v)
colnames(GDP_OAXACA_v2)<-c("GDP_OAXACA","CV_OAXACA")
a<- lag(GDP_OAXACA_v,0)
x<- lag(GDP_OAXACA_v,1)
y<- lag(GDP_OAXACA_v,2)
z<- lag(GDP_OAXACA_v,3)
GDP_OAXACA_lags <- cbind(x,y,z)

fitGDP_OAXACA1 <- auto.arima(GDP_OAXACA_v2[4: 63,2], xreg=GDP_OAXACA_lags[4: 63,1], d=0)
fitGDP_OAXACA2 <- auto.arima(GDP_OAXACA_v2[4: 63,2], xreg=GDP_OAXACA_lags[4: 63,1:2], d=0)
fitGDP_OAXACA3 <- auto.arima(GDP_OAXACA_v2[4: 63,2], xreg=GDP_OAXACA_lags[4: 63,1:3], d=0)
AIC_GDP_OAXACA <- cbind(fitGDP_OAXACA1$aic,fitGDP_OAXACA2$aic,fitGDP_OAXACA3$aic)
colnames(AIC_GDP_OAXACA)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - OAXACA
INPC_SUB_OAXACA_v<-as.vector(INPC_SUB_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
INPC_SUB_OAXACA_v2<-cbind(INPC_SUB_OAXACA_v,CV_OAXACA_v)
colnames(INPC_SUB_OAXACA_v2)<-c("INPC_SUB_OAXACA","CV_OAXACA")
a<- lag(INPC_SUB_OAXACA_v,0)
x<- lag(INPC_SUB_OAXACA_v,1)
y<- lag(INPC_SUB_OAXACA_v,2)
z<- lag(INPC_SUB_OAXACA_v,3)
INPC_SUB_OAXACA_lags <- cbind(x,y,z)

fitINPC_SUB_OAXACA1 <- auto.arima(INPC_SUB_OAXACA_v2[4: 63,2], xreg=INPC_SUB_OAXACA_lags[4: 63,1], d=0)
fitINPC_SUB_OAXACA2 <- auto.arima(INPC_SUB_OAXACA_v2[4: 63,2], xreg=INPC_SUB_OAXACA_lags[4: 63,1:2], d=0)
fitINPC_SUB_OAXACA3 <- auto.arima(INPC_SUB_OAXACA_v2[4: 63,2], xreg=INPC_SUB_OAXACA_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_OAXACA <- cbind(fitINPC_SUB_OAXACA1$aic,fitINPC_SUB_OAXACA2$aic,fitINPC_SUB_OAXACA3$aic)
colnames(AIC_INPC_SUB_OAXACA)<-c("1 lag","2 lags", "3 lags")
# INPC_E - OAXACA
INPC_E_OAXACA_v<-as.vector(INPC_E_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
INPC_E_OAXACA_v2<-cbind(INPC_E_OAXACA_v,CV_OAXACA_v)
colnames(INPC_E_OAXACA_v2)<-c("INPC_E_OAXACA","CV_OAXACA")
a<- lag(INPC_E_OAXACA_v,0)
x<- lag(INPC_E_OAXACA_v,1)
y<- lag(INPC_E_OAXACA_v,2)
z<- lag(INPC_E_OAXACA_v,3)
INPC_E_OAXACA_lags <- cbind(x,y,z)

fitINPC_E_OAXACA1 <- auto.arima(INPC_E_OAXACA_v2[4: 63,2], xreg=INPC_E_OAXACA_lags[4: 63,1], d=0)
fitINPC_E_OAXACA2 <- auto.arima(INPC_E_OAXACA_v2[4: 63,2], xreg=INPC_E_OAXACA_lags[4: 63,1:2], d=0)
fitINPC_E_OAXACA3 <- auto.arima(INPC_E_OAXACA_v2[4: 63,2], xreg=INPC_E_OAXACA_lags[4: 63,1:3], d=0)
AIC_INPC_E_OAXACA <- cbind(fitINPC_E_OAXACA1$aic,fitINPC_E_OAXACA2$aic,fitINPC_E_OAXACA3$aic)
colnames(AIC_INPC_E_OAXACA)<-c("1 lag","2 lags", "3 lags")
# M1 - OAXACA
M1_OAXACA_v<-as.vector(M1_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
M1_OAXACA_v2<-cbind(M1_OAXACA_v,CV_OAXACA_v)
colnames(M1_OAXACA_v2)<-c("M1_OAXACA","CV_OAXACA")
a<- lag(M1_OAXACA_v,0)
x<- lag(M1_OAXACA_v,1)
y<- lag(M1_OAXACA_v,2)
z<- lag(M1_OAXACA_v,3)
M1_OAXACA_lags <- cbind(x,y,z)

fitM1_OAXACA1 <- auto.arima(M1_OAXACA_v2[4: 63,2], xreg=M1_OAXACA_lags[4: 63,1], d=0)
fitM1_OAXACA2 <- auto.arima(M1_OAXACA_v2[4: 63,2], xreg=M1_OAXACA_lags[4: 63,1:2], d=0)
fitM1_OAXACA3 <- auto.arima(M1_OAXACA_v2[4: 63,2], xreg=M1_OAXACA_lags[4: 63,1:3], d=0)
AIC_M1_OAXACA <- cbind(fitM1_OAXACA1$aic,fitM1_OAXACA2$aic,fitM1_OAXACA3$aic)
colnames(AIC_M1_OAXACA)<-c("1 lag","2 lags", "3 lags")
# CONF - OAXACA
CONF_OAXACA_v<-as.vector(CONF_OAXACA)
CV_OAXACA_v<-as.vector(CV_OAXACA)
CONF_OAXACA_v2<-cbind(CONF_OAXACA_v,CV_OAXACA_v)
colnames(CONF_OAXACA_v2)<-c("CONF_OAXACA","CV_OAXACA")
a<- lag(CONF_OAXACA_v,0)
x<- lag(CONF_OAXACA_v,1)
y<- lag(CONF_OAXACA_v,2)
z<- lag(CONF_OAXACA_v,3)
CONF_OAXACA_lags <- cbind(x,y,z)

fitCONF_OAXACA1 <- auto.arima(CONF_OAXACA_v2[4: 63,2], xreg=CONF_OAXACA_lags[4: 63,1], d=0)
fitCONF_OAXACA2 <- auto.arima(CONF_OAXACA_v2[4: 63,2], xreg=CONF_OAXACA_lags[4: 63,1:2], d=0)
fitCONF_OAXACA3 <- auto.arima(CONF_OAXACA_v2[4: 63,2], xreg=CONF_OAXACA_lags[4: 63,1:3], d=0)
AIC_CONF_OAXACA <- cbind(fitCONF_OAXACA1$aic,fitCONF_OAXACA2$aic,fitCONF_OAXACA3$aic)
colnames(AIC_CONF_OAXACA)<-c("1 lag","2 lags", "3 lags")

AICs_OAXACA<-rbind(AIC_IPV_OAXACA,AIC_UNEMP_OAXACA,AIC_REM_OAXACA,AIC_GDP_OAXACA,AIC_INPC_SUB_OAXACA,AIC_INPC_E_OAXACA,AIC_M1_OAXACA,AIC_CONF_OAXACA)
rownames(AICs_OAXACA)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_OAXACA
```

```{r}
# PUE
# IPV - PUE
IPV_PUE_v<-as.vector(IPV_PUE)
CV_PUE_v<-as.vector(CV_PUE)
IPV_PUE_v2<-cbind(IPV_PUE_v,CV_PUE_v)
colnames(IPV_PUE_v2)<-c("IPV_PUE","CV_PUE")
a<- lag(IPV_PUE_v,0)
x<- lag(IPV_PUE_v,1)
y<- lag(IPV_PUE_v,2)
z<- lag(IPV_PUE_v,3)
IPV_PUE_lags <- cbind(x,y,z)

fitIPV_PUE1 <- auto.arima(IPV_PUE_v2[4: 63,2], xreg=IPV_PUE_lags[4: 63,1], d=0)
fitIPV_PUE2 <- auto.arima(IPV_PUE_v2[4: 63,2], xreg=IPV_PUE_lags[4: 63,1:2], d=0)
fitIPV_PUE3 <- auto.arima(IPV_PUE_v2[4: 63,2], xreg=IPV_PUE_lags[4: 63,1:3], d=0)
AIC_IPV_PUE <- cbind(fitIPV_PUE1$aic,fitIPV_PUE2$aic,fitIPV_PUE3$aic)
colnames(AIC_IPV_PUE)<-c("1 lag","2 lags", "3 lags")
# UNEMP - PUE
UNEMP_PUE_v<-as.vector(UNEMP_PUE)
CV_PUE_v<-as.vector(CV_PUE)
UNEMP_PUE_v2<-cbind(UNEMP_PUE_v,CV_PUE_v)
colnames(UNEMP_PUE_v2)<-c("UNEMP_PUE","CV_PUE")
a<- lag(UNEMP_PUE_v,0)
x<- lag(UNEMP_PUE_v,1)
y<- lag(UNEMP_PUE_v,2)
z<- lag(UNEMP_PUE_v,3)
UNEMP_PUE_lags <- cbind(x,y,z)

fitUNEMP_PUE1 <- auto.arima(UNEMP_PUE_v2[4: 63,2], xreg=UNEMP_PUE_lags[4: 63,1], d=0)
fitUNEMP_PUE2 <- auto.arima(UNEMP_PUE_v2[4: 63,2], xreg=UNEMP_PUE_lags[4: 63,1:2], d=0)
fitUNEMP_PUE3 <- auto.arima(UNEMP_PUE_v2[4: 63,2], xreg=UNEMP_PUE_lags[4: 63,1:3], d=0)
AIC_UNEMP_PUE <- cbind(fitUNEMP_PUE1$aic,fitUNEMP_PUE2$aic,fitUNEMP_PUE3$aic)
colnames(AIC_UNEMP_PUE)<-c("1 lag","2 lags", "3 lags")
# REM - PUE
REM_PUE_v<-as.vector(REM_PUE)
CV_PUE_v<-as.vector(CV_PUE)
REM_PUE_v2<-cbind(REM_PUE_v,CV_PUE_v)
colnames(REM_PUE_v2)<-c("REM_PUE","CV_PUE")
a<- lag(REM_PUE_v,0)
x<- lag(REM_PUE_v,1)
y<- lag(REM_PUE_v,2)
z<- lag(REM_PUE_v,3)
REM_PUE_lags <- cbind(x,y,z)

fitREM_PUE1 <- auto.arima(REM_PUE_v2[4: 63,2], xreg=REM_PUE_lags[4: 63,1], d=0)
fitREM_PUE2 <- auto.arima(REM_PUE_v2[4: 63,2], xreg=REM_PUE_lags[4: 63,1:2], d=0)
fitREM_PUE3 <- auto.arima(REM_PUE_v2[4: 63,2], xreg=REM_PUE_lags[4: 63,1:3], d=0)
AIC_REM_PUE <- cbind(fitREM_PUE1$aic,fitREM_PUE2$aic,fitREM_PUE3$aic)
colnames(AIC_REM_PUE)<-c("1 lag","2 lags", "3 lags")
# GDP - PUE
GDP_PUE_v<-as.vector(GDP_PUE)
CV_PUE_v<-as.vector(CV_PUE)
GDP_PUE_v2<-cbind(GDP_PUE_v,CV_PUE_v)
colnames(GDP_PUE_v2)<-c("GDP_PUE","CV_PUE")
a<- lag(GDP_PUE_v,0)
x<- lag(GDP_PUE_v,1)
y<- lag(GDP_PUE_v,2)
z<- lag(GDP_PUE_v,3)
GDP_PUE_lags <- cbind(x,y,z)

fitGDP_PUE1 <- auto.arima(GDP_PUE_v2[4: 63,2], xreg=GDP_PUE_lags[4: 63,1], d=0)
fitGDP_PUE2 <- auto.arima(GDP_PUE_v2[4: 63,2], xreg=GDP_PUE_lags[4: 63,1:2], d=0)
fitGDP_PUE3 <- auto.arima(GDP_PUE_v2[4: 63,2], xreg=GDP_PUE_lags[4: 63,1:3], d=0)
AIC_GDP_PUE <- cbind(fitGDP_PUE1$aic,fitGDP_PUE2$aic,fitGDP_PUE3$aic)
colnames(AIC_GDP_PUE)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - PUE
INPC_SUB_PUE_v<-as.vector(INPC_SUB_PUE)
CV_PUE_v<-as.vector(CV_PUE)
INPC_SUB_PUE_v2<-cbind(INPC_SUB_PUE_v,CV_PUE_v)
colnames(INPC_SUB_PUE_v2)<-c("INPC_SUB_PUE","CV_PUE")
a<- lag(INPC_SUB_PUE_v,0)
x<- lag(INPC_SUB_PUE_v,1)
y<- lag(INPC_SUB_PUE_v,2)
z<- lag(INPC_SUB_PUE_v,3)
INPC_SUB_PUE_lags <- cbind(x,y,z)

fitINPC_SUB_PUE1 <- auto.arima(INPC_SUB_PUE_v2[4: 63,2], xreg=INPC_SUB_PUE_lags[4: 63,1], d=0)
fitINPC_SUB_PUE2 <- auto.arima(INPC_SUB_PUE_v2[4: 63,2], xreg=INPC_SUB_PUE_lags[4: 63,1:2], d=0)
fitINPC_SUB_PUE3 <- auto.arima(INPC_SUB_PUE_v2[4: 63,2], xreg=INPC_SUB_PUE_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_PUE <- cbind(fitINPC_SUB_PUE1$aic,fitINPC_SUB_PUE2$aic,fitINPC_SUB_PUE3$aic)
colnames(AIC_INPC_SUB_PUE)<-c("1 lag","2 lags", "3 lags")
# INPC_E - PUE
INPC_E_PUE_v<-as.vector(INPC_E_PUE)
CV_PUE_v<-as.vector(CV_PUE)
INPC_E_PUE_v2<-cbind(INPC_E_PUE_v,CV_PUE_v)
colnames(INPC_E_PUE_v2)<-c("INPC_E_PUE","CV_PUE")
a<- lag(INPC_E_PUE_v,0)
x<- lag(INPC_E_PUE_v,1)
y<- lag(INPC_E_PUE_v,2)
z<- lag(INPC_E_PUE_v,3)
INPC_E_PUE_lags <- cbind(x,y,z)

fitINPC_E_PUE1 <- auto.arima(INPC_E_PUE_v2[4: 63,2], xreg=INPC_E_PUE_lags[4: 63,1], d=0)
fitINPC_E_PUE2 <- auto.arima(INPC_E_PUE_v2[4: 63,2], xreg=INPC_E_PUE_lags[4: 63,1:2], d=0)
fitINPC_E_PUE3 <- auto.arima(INPC_E_PUE_v2[4: 63,2], xreg=INPC_E_PUE_lags[4: 63,1:3], d=0)
AIC_INPC_E_PUE <- cbind(fitINPC_E_PUE1$aic,fitINPC_E_PUE2$aic,fitINPC_E_PUE3$aic)
colnames(AIC_INPC_E_PUE)<-c("1 lag","2 lags", "3 lags")
# M1 - PUE
M1_PUE_v<-as.vector(M1_PUE)
CV_PUE_v<-as.vector(CV_PUE)
M1_PUE_v2<-cbind(M1_PUE_v,CV_PUE_v)
colnames(M1_PUE_v2)<-c("M1_PUE","CV_PUE")
a<- lag(M1_PUE_v,0)
x<- lag(M1_PUE_v,1)
y<- lag(M1_PUE_v,2)
z<- lag(M1_PUE_v,3)
M1_PUE_lags <- cbind(x,y,z)

fitM1_PUE1 <- auto.arima(M1_PUE_v2[4: 63,2], xreg=M1_PUE_lags[4: 63,1], d=0)
fitM1_PUE2 <- auto.arima(M1_PUE_v2[4: 63,2], xreg=M1_PUE_lags[4: 63,1:2], d=0)
fitM1_PUE3 <- auto.arima(M1_PUE_v2[4: 63,2], xreg=M1_PUE_lags[4: 63,1:3], d=0)
AIC_M1_PUE <- cbind(fitM1_PUE1$aic,fitM1_PUE2$aic,fitM1_PUE3$aic)
colnames(AIC_M1_PUE)<-c("1 lag","2 lags", "3 lags")
# CONF - PUE
CONF_PUE_v<-as.vector(CONF_PUE)
CV_PUE_v<-as.vector(CV_PUE)
CONF_PUE_v2<-cbind(CONF_PUE_v,CV_PUE_v)
colnames(CONF_PUE_v2)<-c("CONF_PUE","CV_PUE")
a<- lag(CONF_PUE_v,0)
x<- lag(CONF_PUE_v,1)
y<- lag(CONF_PUE_v,2)
z<- lag(CONF_PUE_v,3)
CONF_PUE_lags <- cbind(x,y,z)

fitCONF_PUE1 <- auto.arima(CONF_PUE_v2[4: 63,2], xreg=CONF_PUE_lags[4: 63,1], d=0)
fitCONF_PUE2 <- auto.arima(CONF_PUE_v2[4: 63,2], xreg=CONF_PUE_lags[4: 63,1:2], d=0)
fitCONF_PUE3 <- auto.arima(CONF_PUE_v2[4: 63,2], xreg=CONF_PUE_lags[4: 63,1:3], d=0)
AIC_CONF_PUE <- cbind(fitCONF_PUE1$aic,fitCONF_PUE2$aic,fitCONF_PUE3$aic)
colnames(AIC_CONF_PUE)<-c("1 lag","2 lags", "3 lags")

AICs_PUE<-rbind(AIC_IPV_PUE,AIC_UNEMP_PUE,AIC_REM_PUE,AIC_GDP_PUE,AIC_INPC_SUB_PUE,AIC_INPC_E_PUE,AIC_M1_PUE,AIC_CONF_PUE)
rownames(AICs_PUE)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_PUE
```

```{r}
# Q_ROO
# IPV - Q_ROO
IPV_Q_ROO_v<-as.vector(IPV_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
IPV_Q_ROO_v2<-cbind(IPV_Q_ROO_v,CV_Q_ROO_v)
colnames(IPV_Q_ROO_v2)<-c("IPV_Q_ROO","CV_Q_ROO")
a<- lag(IPV_Q_ROO_v,0)
x<- lag(IPV_Q_ROO_v,1)
y<- lag(IPV_Q_ROO_v,2)
z<- lag(IPV_Q_ROO_v,3)
IPV_Q_ROO_lags <- cbind(x,y,z)

fitIPV_Q_ROO1 <- auto.arima(IPV_Q_ROO_v2[4: 63,2], xreg=IPV_Q_ROO_lags[4: 63,1], d=0)
fitIPV_Q_ROO2 <- auto.arima(IPV_Q_ROO_v2[4: 63,2], xreg=IPV_Q_ROO_lags[4: 63,1:2], d=0)
fitIPV_Q_ROO3 <- auto.arima(IPV_Q_ROO_v2[4: 63,2], xreg=IPV_Q_ROO_lags[4: 63,1:3], d=0)
AIC_IPV_Q_ROO <- cbind(fitIPV_Q_ROO1$aic,fitIPV_Q_ROO2$aic,fitIPV_Q_ROO3$aic)
colnames(AIC_IPV_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - Q_ROO
UNEMP_Q_ROO_v<-as.vector(UNEMP_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
UNEMP_Q_ROO_v2<-cbind(UNEMP_Q_ROO_v,CV_Q_ROO_v)
colnames(UNEMP_Q_ROO_v2)<-c("UNEMP_Q_ROO","CV_Q_ROO")
a<- lag(UNEMP_Q_ROO_v,0)
x<- lag(UNEMP_Q_ROO_v,1)
y<- lag(UNEMP_Q_ROO_v,2)
z<- lag(UNEMP_Q_ROO_v,3)
UNEMP_Q_ROO_lags <- cbind(x,y,z)

fitUNEMP_Q_ROO1 <- auto.arima(UNEMP_Q_ROO_v2[4: 63,2], xreg=UNEMP_Q_ROO_lags[4: 63,1], d=0)
fitUNEMP_Q_ROO2 <- auto.arima(UNEMP_Q_ROO_v2[4: 63,2], xreg=UNEMP_Q_ROO_lags[4: 63,1:2], d=0)
fitUNEMP_Q_ROO3 <- auto.arima(UNEMP_Q_ROO_v2[4: 63,2], xreg=UNEMP_Q_ROO_lags[4: 63,1:3], d=0)
AIC_UNEMP_Q_ROO <- cbind(fitUNEMP_Q_ROO1$aic,fitUNEMP_Q_ROO2$aic,fitUNEMP_Q_ROO3$aic)
colnames(AIC_UNEMP_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# REM - Q_ROO
REM_Q_ROO_v<-as.vector(REM_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
REM_Q_ROO_v2<-cbind(REM_Q_ROO_v,CV_Q_ROO_v)
colnames(REM_Q_ROO_v2)<-c("REM_Q_ROO","CV_Q_ROO")
a<- lag(REM_Q_ROO_v,0)
x<- lag(REM_Q_ROO_v,1)
y<- lag(REM_Q_ROO_v,2)
z<- lag(REM_Q_ROO_v,3)
REM_Q_ROO_lags <- cbind(x,y,z)

fitREM_Q_ROO1 <- auto.arima(REM_Q_ROO_v2[4: 63,2], xreg=REM_Q_ROO_lags[4: 63,1], d=0)
fitREM_Q_ROO2 <- auto.arima(REM_Q_ROO_v2[4: 63,2], xreg=REM_Q_ROO_lags[4: 63,1:2], d=0)
fitREM_Q_ROO3 <- auto.arima(REM_Q_ROO_v2[4: 63,2], xreg=REM_Q_ROO_lags[4: 63,1:3], d=0)
AIC_REM_Q_ROO <- cbind(fitREM_Q_ROO1$aic,fitREM_Q_ROO2$aic,fitREM_Q_ROO3$aic)
colnames(AIC_REM_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# GDP - Q_ROO
GDP_Q_ROO_v<-as.vector(GDP_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
GDP_Q_ROO_v2<-cbind(GDP_Q_ROO_v,CV_Q_ROO_v)
colnames(GDP_Q_ROO_v2)<-c("GDP_Q_ROO","CV_Q_ROO")
a<- lag(GDP_Q_ROO_v,0)
x<- lag(GDP_Q_ROO_v,1)
y<- lag(GDP_Q_ROO_v,2)
z<- lag(GDP_Q_ROO_v,3)
GDP_Q_ROO_lags <- cbind(x,y,z)

fitGDP_Q_ROO1 <- auto.arima(GDP_Q_ROO_v2[4: 63,2], xreg=GDP_Q_ROO_lags[4: 63,1], d=0)
fitGDP_Q_ROO2 <- auto.arima(GDP_Q_ROO_v2[4: 63,2], xreg=GDP_Q_ROO_lags[4: 63,1:2], d=0)
fitGDP_Q_ROO3 <- auto.arima(GDP_Q_ROO_v2[4: 63,2], xreg=GDP_Q_ROO_lags[4: 63,1:3], d=0)
AIC_GDP_Q_ROO <- cbind(fitGDP_Q_ROO1$aic,fitGDP_Q_ROO2$aic,fitGDP_Q_ROO3$aic)
colnames(AIC_GDP_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - Q_ROO
INPC_SUB_Q_ROO_v<-as.vector(INPC_SUB_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
INPC_SUB_Q_ROO_v2<-cbind(INPC_SUB_Q_ROO_v,CV_Q_ROO_v)
colnames(INPC_SUB_Q_ROO_v2)<-c("INPC_SUB_Q_ROO","CV_Q_ROO")
a<- lag(INPC_SUB_Q_ROO_v,0)
x<- lag(INPC_SUB_Q_ROO_v,1)
y<- lag(INPC_SUB_Q_ROO_v,2)
z<- lag(INPC_SUB_Q_ROO_v,3)
INPC_SUB_Q_ROO_lags <- cbind(x,y,z)

fitINPC_SUB_Q_ROO1 <- auto.arima(INPC_SUB_Q_ROO_v2[4: 63,2], xreg=INPC_SUB_Q_ROO_lags[4: 63,1], d=0)
fitINPC_SUB_Q_ROO2 <- auto.arima(INPC_SUB_Q_ROO_v2[4: 63,2], xreg=INPC_SUB_Q_ROO_lags[4: 63,1:2], d=0)
fitINPC_SUB_Q_ROO3 <- auto.arima(INPC_SUB_Q_ROO_v2[4: 63,2], xreg=INPC_SUB_Q_ROO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_Q_ROO <- cbind(fitINPC_SUB_Q_ROO1$aic,fitINPC_SUB_Q_ROO2$aic,fitINPC_SUB_Q_ROO3$aic)
colnames(AIC_INPC_SUB_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - Q_ROO
INPC_E_Q_ROO_v<-as.vector(INPC_E_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
INPC_E_Q_ROO_v2<-cbind(INPC_E_Q_ROO_v,CV_Q_ROO_v)
colnames(INPC_E_Q_ROO_v2)<-c("INPC_E_Q_ROO","CV_Q_ROO")
a<- lag(INPC_E_Q_ROO_v,0)
x<- lag(INPC_E_Q_ROO_v,1)
y<- lag(INPC_E_Q_ROO_v,2)
z<- lag(INPC_E_Q_ROO_v,3)
INPC_E_Q_ROO_lags <- cbind(x,y,z)

fitINPC_E_Q_ROO1 <- auto.arima(INPC_E_Q_ROO_v2[4: 63,2], xreg=INPC_E_Q_ROO_lags[4: 63,1], d=0)
fitINPC_E_Q_ROO2 <- auto.arima(INPC_E_Q_ROO_v2[4: 63,2], xreg=INPC_E_Q_ROO_lags[4: 63,1:2], d=0)
fitINPC_E_Q_ROO3 <- auto.arima(INPC_E_Q_ROO_v2[4: 63,2], xreg=INPC_E_Q_ROO_lags[4: 63,1:3], d=0)
AIC_INPC_E_Q_ROO <- cbind(fitINPC_E_Q_ROO1$aic,fitINPC_E_Q_ROO2$aic,fitINPC_E_Q_ROO3$aic)
colnames(AIC_INPC_E_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# M1 - Q_ROO
M1_Q_ROO_v<-as.vector(M1_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
M1_Q_ROO_v2<-cbind(M1_Q_ROO_v,CV_Q_ROO_v)
colnames(M1_Q_ROO_v2)<-c("M1_Q_ROO","CV_Q_ROO")
a<- lag(M1_Q_ROO_v,0)
x<- lag(M1_Q_ROO_v,1)
y<- lag(M1_Q_ROO_v,2)
z<- lag(M1_Q_ROO_v,3)
M1_Q_ROO_lags <- cbind(x,y,z)

fitM1_Q_ROO1 <- auto.arima(M1_Q_ROO_v2[4: 63,2], xreg=M1_Q_ROO_lags[4: 63,1], d=0)
fitM1_Q_ROO2 <- auto.arima(M1_Q_ROO_v2[4: 63,2], xreg=M1_Q_ROO_lags[4: 63,1:2], d=0)
fitM1_Q_ROO3 <- auto.arima(M1_Q_ROO_v2[4: 63,2], xreg=M1_Q_ROO_lags[4: 63,1:3], d=0)
AIC_M1_Q_ROO <- cbind(fitM1_Q_ROO1$aic,fitM1_Q_ROO2$aic,fitM1_Q_ROO3$aic)
colnames(AIC_M1_Q_ROO)<-c("1 lag","2 lags", "3 lags")
# CONF - Q_ROO
CONF_Q_ROO_v<-as.vector(CONF_Q_ROO)
CV_Q_ROO_v<-as.vector(CV_Q_ROO)
CONF_Q_ROO_v2<-cbind(CONF_Q_ROO_v,CV_Q_ROO_v)
colnames(CONF_Q_ROO_v2)<-c("CONF_Q_ROO","CV_Q_ROO")
a<- lag(CONF_Q_ROO_v,0)
x<- lag(CONF_Q_ROO_v,1)
y<- lag(CONF_Q_ROO_v,2)
z<- lag(CONF_Q_ROO_v,3)
CONF_Q_ROO_lags <- cbind(x,y,z)

fitCONF_Q_ROO1 <- auto.arima(CONF_Q_ROO_v2[4: 63,2], xreg=CONF_Q_ROO_lags[4: 63,1], d=0)
fitCONF_Q_ROO2 <- auto.arima(CONF_Q_ROO_v2[4: 63,2], xreg=CONF_Q_ROO_lags[4: 63,1:2], d=0)
fitCONF_Q_ROO3 <- auto.arima(CONF_Q_ROO_v2[4: 63,2], xreg=CONF_Q_ROO_lags[4: 63,1:3], d=0)
AIC_CONF_Q_ROO <- cbind(fitCONF_Q_ROO1$aic,fitCONF_Q_ROO2$aic,fitCONF_Q_ROO3$aic)
colnames(AIC_CONF_Q_ROO)<-c("1 lag","2 lags", "3 lags")

AICs_Q_ROO<-rbind(AIC_IPV_Q_ROO,AIC_UNEMP_Q_ROO,AIC_REM_Q_ROO,AIC_GDP_Q_ROO,AIC_INPC_SUB_Q_ROO,AIC_INPC_E_Q_ROO,AIC_M1_Q_ROO,AIC_CONF_Q_ROO)
rownames(AICs_Q_ROO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_Q_ROO
```

```{r}
# QRO
# IPV - QRO
IPV_QRO_v<-as.vector(IPV_QRO)
CV_QRO_v<-as.vector(CV_QRO)
IPV_QRO_v2<-cbind(IPV_QRO_v,CV_QRO_v)
colnames(IPV_QRO_v2)<-c("IPV_QRO","CV_QRO")
a<- lag(IPV_QRO_v,0)
x<- lag(IPV_QRO_v,1)
y<- lag(IPV_QRO_v,2)
z<- lag(IPV_QRO_v,3)
IPV_QRO_lags <- cbind(x,y,z)

fitIPV_QRO1 <- auto.arima(IPV_QRO_v2[4: 63,2], xreg=IPV_QRO_lags[4: 63,1], d=0)
fitIPV_QRO2 <- auto.arima(IPV_QRO_v2[4: 63,2], xreg=IPV_QRO_lags[4: 63,1:2], d=0)
fitIPV_QRO3 <- auto.arima(IPV_QRO_v2[4: 63,2], xreg=IPV_QRO_lags[4: 63,1:3], d=0)
AIC_IPV_QRO <- cbind(fitIPV_QRO1$aic,fitIPV_QRO2$aic,fitIPV_QRO3$aic)
colnames(AIC_IPV_QRO)<-c("1 lag","2 lags", "3 lags")
# UNEMP - QRO
UNEMP_QRO_v<-as.vector(UNEMP_QRO)
CV_QRO_v<-as.vector(CV_QRO)
UNEMP_QRO_v2<-cbind(UNEMP_QRO_v,CV_QRO_v)
colnames(UNEMP_QRO_v2)<-c("UNEMP_QRO","CV_QRO")
a<- lag(UNEMP_QRO_v,0)
x<- lag(UNEMP_QRO_v,1)
y<- lag(UNEMP_QRO_v,2)
z<- lag(UNEMP_QRO_v,3)
UNEMP_QRO_lags <- cbind(x,y,z)

fitUNEMP_QRO1 <- auto.arima(UNEMP_QRO_v2[4: 63,2], xreg=UNEMP_QRO_lags[4: 63,1], d=0)
fitUNEMP_QRO2 <- auto.arima(UNEMP_QRO_v2[4: 63,2], xreg=UNEMP_QRO_lags[4: 63,1:2], d=0)
fitUNEMP_QRO3 <- auto.arima(UNEMP_QRO_v2[4: 63,2], xreg=UNEMP_QRO_lags[4: 63,1:3], d=0)
AIC_UNEMP_QRO <- cbind(fitUNEMP_QRO1$aic,fitUNEMP_QRO2$aic,fitUNEMP_QRO3$aic)
colnames(AIC_UNEMP_QRO)<-c("1 lag","2 lags", "3 lags")
# REM - QRO
REM_QRO_v<-as.vector(REM_QRO)
CV_QRO_v<-as.vector(CV_QRO)
REM_QRO_v2<-cbind(REM_QRO_v,CV_QRO_v)
colnames(REM_QRO_v2)<-c("REM_QRO","CV_QRO")
a<- lag(REM_QRO_v,0)
x<- lag(REM_QRO_v,1)
y<- lag(REM_QRO_v,2)
z<- lag(REM_QRO_v,3)
REM_QRO_lags <- cbind(x,y,z)

fitREM_QRO1 <- auto.arima(REM_QRO_v2[4: 63,2], xreg=REM_QRO_lags[4: 63,1], d=0)
fitREM_QRO2 <- auto.arima(REM_QRO_v2[4: 63,2], xreg=REM_QRO_lags[4: 63,1:2], d=0)
fitREM_QRO3 <- auto.arima(REM_QRO_v2[4: 63,2], xreg=REM_QRO_lags[4: 63,1:3], d=0)
AIC_REM_QRO <- cbind(fitREM_QRO1$aic,fitREM_QRO2$aic,fitREM_QRO3$aic)
colnames(AIC_REM_QRO)<-c("1 lag","2 lags", "3 lags")
# GDP - QRO
GDP_QRO_v<-as.vector(GDP_QRO)
CV_QRO_v<-as.vector(CV_QRO)
GDP_QRO_v2<-cbind(GDP_QRO_v,CV_QRO_v)
colnames(GDP_QRO_v2)<-c("GDP_QRO","CV_QRO")
a<- lag(GDP_QRO_v,0)
x<- lag(GDP_QRO_v,1)
y<- lag(GDP_QRO_v,2)
z<- lag(GDP_QRO_v,3)
GDP_QRO_lags <- cbind(x,y,z)

fitGDP_QRO1 <- auto.arima(GDP_QRO_v2[4: 63,2], xreg=GDP_QRO_lags[4: 63,1], d=0)
fitGDP_QRO2 <- auto.arima(GDP_QRO_v2[4: 63,2], xreg=GDP_QRO_lags[4: 63,1:2], d=0)
fitGDP_QRO3 <- auto.arima(GDP_QRO_v2[4: 63,2], xreg=GDP_QRO_lags[4: 63,1:3], d=0)
AIC_GDP_QRO <- cbind(fitGDP_QRO1$aic,fitGDP_QRO2$aic,fitGDP_QRO3$aic)
colnames(AIC_GDP_QRO)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - QRO
INPC_SUB_QRO_v<-as.vector(INPC_SUB_QRO)
CV_QRO_v<-as.vector(CV_QRO)
INPC_SUB_QRO_v2<-cbind(INPC_SUB_QRO_v,CV_QRO_v)
colnames(INPC_SUB_QRO_v2)<-c("INPC_SUB_QRO","CV_QRO")
a<- lag(INPC_SUB_QRO_v,0)
x<- lag(INPC_SUB_QRO_v,1)
y<- lag(INPC_SUB_QRO_v,2)
z<- lag(INPC_SUB_QRO_v,3)
INPC_SUB_QRO_lags <- cbind(x,y,z)

fitINPC_SUB_QRO1 <- auto.arima(INPC_SUB_QRO_v2[4: 63,2], xreg=INPC_SUB_QRO_lags[4: 63,1], d=0)
fitINPC_SUB_QRO2 <- auto.arima(INPC_SUB_QRO_v2[4: 63,2], xreg=INPC_SUB_QRO_lags[4: 63,1:2], d=0)
fitINPC_SUB_QRO3 <- auto.arima(INPC_SUB_QRO_v2[4: 63,2], xreg=INPC_SUB_QRO_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_QRO <- cbind(fitINPC_SUB_QRO1$aic,fitINPC_SUB_QRO2$aic,fitINPC_SUB_QRO3$aic)
colnames(AIC_INPC_SUB_QRO)<-c("1 lag","2 lags", "3 lags")
# INPC_E - QRO
INPC_E_QRO_v<-as.vector(INPC_E_QRO)
CV_QRO_v<-as.vector(CV_QRO)
INPC_E_QRO_v2<-cbind(INPC_E_QRO_v,CV_QRO_v)
colnames(INPC_E_QRO_v2)<-c("INPC_E_QRO","CV_QRO")
a<- lag(INPC_E_QRO_v,0)
x<- lag(INPC_E_QRO_v,1)
y<- lag(INPC_E_QRO_v,2)
z<- lag(INPC_E_QRO_v,3)
INPC_E_QRO_lags <- cbind(x,y,z)

fitINPC_E_QRO1 <- auto.arima(INPC_E_QRO_v2[4: 63,2], xreg=INPC_E_QRO_lags[4: 63,1], d=0)
fitINPC_E_QRO2 <- auto.arima(INPC_E_QRO_v2[4: 63,2], xreg=INPC_E_QRO_lags[4: 63,1:2], d=0)
fitINPC_E_QRO3 <- auto.arima(INPC_E_QRO_v2[4: 63,2], xreg=INPC_E_QRO_lags[4: 63,1:3], d=0)
AIC_INPC_E_QRO <- cbind(fitINPC_E_QRO1$aic,fitINPC_E_QRO2$aic,fitINPC_E_QRO3$aic)
colnames(AIC_INPC_E_QRO)<-c("1 lag","2 lags", "3 lags")
# M1 - QRO
M1_QRO_v<-as.vector(M1_QRO)
CV_QRO_v<-as.vector(CV_QRO)
M1_QRO_v2<-cbind(M1_QRO_v,CV_QRO_v)
colnames(M1_QRO_v2)<-c("M1_QRO","CV_QRO")
a<- lag(M1_QRO_v,0)
x<- lag(M1_QRO_v,1)
y<- lag(M1_QRO_v,2)
z<- lag(M1_QRO_v,3)
M1_QRO_lags <- cbind(x,y,z)

fitM1_QRO1 <- auto.arima(M1_QRO_v2[4: 63,2], xreg=M1_QRO_lags[4: 63,1], d=0)
fitM1_QRO2 <- auto.arima(M1_QRO_v2[4: 63,2], xreg=M1_QRO_lags[4: 63,1:2], d=0)
fitM1_QRO3 <- auto.arima(M1_QRO_v2[4: 63,2], xreg=M1_QRO_lags[4: 63,1:3], d=0)
AIC_M1_QRO <- cbind(fitM1_QRO1$aic,fitM1_QRO2$aic,fitM1_QRO3$aic)
colnames(AIC_M1_QRO)<-c("1 lag","2 lags", "3 lags")
# CONF - QRO
CONF_QRO_v<-as.vector(CONF_QRO)
CV_QRO_v<-as.vector(CV_QRO)
CONF_QRO_v2<-cbind(CONF_QRO_v,CV_QRO_v)
colnames(CONF_QRO_v2)<-c("CONF_QRO","CV_QRO")
a<- lag(CONF_QRO_v,0)
x<- lag(CONF_QRO_v,1)
y<- lag(CONF_QRO_v,2)
z<- lag(CONF_QRO_v,3)
CONF_QRO_lags <- cbind(x,y,z)

fitCONF_QRO1 <- auto.arima(CONF_QRO_v2[4: 63,2], xreg=CONF_QRO_lags[4: 63,1], d=0)
fitCONF_QRO2 <- auto.arima(CONF_QRO_v2[4: 63,2], xreg=CONF_QRO_lags[4: 63,1:2], d=0)
fitCONF_QRO3 <- auto.arima(CONF_QRO_v2[4: 63,2], xreg=CONF_QRO_lags[4: 63,1:3], d=0)
AIC_CONF_QRO <- cbind(fitCONF_QRO1$aic,fitCONF_QRO2$aic,fitCONF_QRO3$aic)
colnames(AIC_CONF_QRO)<-c("1 lag","2 lags", "3 lags")

AICs_QRO<-rbind(AIC_IPV_QRO,AIC_UNEMP_QRO,AIC_REM_QRO,AIC_GDP_QRO,AIC_INPC_SUB_QRO,AIC_INPC_E_QRO,AIC_M1_QRO,AIC_CONF_QRO)
rownames(AICs_QRO)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_QRO
```

```{r}
# SIN
# IPV - SIN
IPV_SIN_v<-as.vector(IPV_SIN)
CV_SIN_v<-as.vector(CV_SIN)
IPV_SIN_v2<-cbind(IPV_SIN_v,CV_SIN_v)
colnames(IPV_SIN_v2)<-c("IPV_SIN","CV_SIN")
a<- lag(IPV_SIN_v,0)
x<- lag(IPV_SIN_v,1)
y<- lag(IPV_SIN_v,2)
z<- lag(IPV_SIN_v,3)
IPV_SIN_lags <- cbind(x,y,z)

fitIPV_SIN1 <- auto.arima(IPV_SIN_v2[4: 63,2], xreg=IPV_SIN_lags[4: 63,1], d=0)
fitIPV_SIN2 <- auto.arima(IPV_SIN_v2[4: 63,2], xreg=IPV_SIN_lags[4: 63,1:2], d=0)
fitIPV_SIN3 <- auto.arima(IPV_SIN_v2[4: 63,2], xreg=IPV_SIN_lags[4: 63,1:3], d=0)
AIC_IPV_SIN <- cbind(fitIPV_SIN1$aic,fitIPV_SIN2$aic,fitIPV_SIN3$aic)
colnames(AIC_IPV_SIN)<-c("1 lag","2 lags", "3 lags")
# UNEMP - SIN
UNEMP_SIN_v<-as.vector(UNEMP_SIN)
CV_SIN_v<-as.vector(CV_SIN)
UNEMP_SIN_v2<-cbind(UNEMP_SIN_v,CV_SIN_v)
colnames(UNEMP_SIN_v2)<-c("UNEMP_SIN","CV_SIN")
a<- lag(UNEMP_SIN_v,0)
x<- lag(UNEMP_SIN_v,1)
y<- lag(UNEMP_SIN_v,2)
z<- lag(UNEMP_SIN_v,3)
UNEMP_SIN_lags <- cbind(x,y,z)

fitUNEMP_SIN1 <- auto.arima(UNEMP_SIN_v2[4: 63,2], xreg=UNEMP_SIN_lags[4: 63,1], d=0)
fitUNEMP_SIN2 <- auto.arima(UNEMP_SIN_v2[4: 63,2], xreg=UNEMP_SIN_lags[4: 63,1:2], d=0)
fitUNEMP_SIN3 <- auto.arima(UNEMP_SIN_v2[4: 63,2], xreg=UNEMP_SIN_lags[4: 63,1:3], d=0)
AIC_UNEMP_SIN <- cbind(fitUNEMP_SIN1$aic,fitUNEMP_SIN2$aic,fitUNEMP_SIN3$aic)
colnames(AIC_UNEMP_SIN)<-c("1 lag","2 lags", "3 lags")
# REM - SIN
REM_SIN_v<-as.vector(REM_SIN)
CV_SIN_v<-as.vector(CV_SIN)
REM_SIN_v2<-cbind(REM_SIN_v,CV_SIN_v)
colnames(REM_SIN_v2)<-c("REM_SIN","CV_SIN")
a<- lag(REM_SIN_v,0)
x<- lag(REM_SIN_v,1)
y<- lag(REM_SIN_v,2)
z<- lag(REM_SIN_v,3)
REM_SIN_lags <- cbind(x,y,z)

fitREM_SIN1 <- auto.arima(REM_SIN_v2[4: 63,2], xreg=REM_SIN_lags[4: 63,1], d=0)
fitREM_SIN2 <- auto.arima(REM_SIN_v2[4: 63,2], xreg=REM_SIN_lags[4: 63,1:2], d=0)
fitREM_SIN3 <- auto.arima(REM_SIN_v2[4: 63,2], xreg=REM_SIN_lags[4: 63,1:3], d=0)
AIC_REM_SIN <- cbind(fitREM_SIN1$aic,fitREM_SIN2$aic,fitREM_SIN3$aic)
colnames(AIC_REM_SIN)<-c("1 lag","2 lags", "3 lags")
# GDP - SIN
GDP_SIN_v<-as.vector(GDP_SIN)
CV_SIN_v<-as.vector(CV_SIN)
GDP_SIN_v2<-cbind(GDP_SIN_v,CV_SIN_v)
colnames(GDP_SIN_v2)<-c("GDP_SIN","CV_SIN")
a<- lag(GDP_SIN_v,0)
x<- lag(GDP_SIN_v,1)
y<- lag(GDP_SIN_v,2)
z<- lag(GDP_SIN_v,3)
GDP_SIN_lags <- cbind(x,y,z)

fitGDP_SIN1 <- auto.arima(GDP_SIN_v2[4: 63,2], xreg=GDP_SIN_lags[4: 63,1], d=0)
fitGDP_SIN2 <- auto.arima(GDP_SIN_v2[4: 63,2], xreg=GDP_SIN_lags[4: 63,1:2], d=0)
fitGDP_SIN3 <- auto.arima(GDP_SIN_v2[4: 63,2], xreg=GDP_SIN_lags[4: 63,1:3], d=0)
AIC_GDP_SIN <- cbind(fitGDP_SIN1$aic,fitGDP_SIN2$aic,fitGDP_SIN3$aic)
colnames(AIC_GDP_SIN)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - SIN
INPC_SUB_SIN_v<-as.vector(INPC_SUB_SIN)
CV_SIN_v<-as.vector(CV_SIN)
INPC_SUB_SIN_v2<-cbind(INPC_SUB_SIN_v,CV_SIN_v)
colnames(INPC_SUB_SIN_v2)<-c("INPC_SUB_SIN","CV_SIN")
a<- lag(INPC_SUB_SIN_v,0)
x<- lag(INPC_SUB_SIN_v,1)
y<- lag(INPC_SUB_SIN_v,2)
z<- lag(INPC_SUB_SIN_v,3)
INPC_SUB_SIN_lags <- cbind(x,y,z)

fitINPC_SUB_SIN1 <- auto.arima(INPC_SUB_SIN_v2[4: 63,2], xreg=INPC_SUB_SIN_lags[4: 63,1], d=0)
fitINPC_SUB_SIN2 <- auto.arima(INPC_SUB_SIN_v2[4: 63,2], xreg=INPC_SUB_SIN_lags[4: 63,1:2], d=0)
fitINPC_SUB_SIN3 <- auto.arima(INPC_SUB_SIN_v2[4: 63,2], xreg=INPC_SUB_SIN_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_SIN <- cbind(fitINPC_SUB_SIN1$aic,fitINPC_SUB_SIN2$aic,fitINPC_SUB_SIN3$aic)
colnames(AIC_INPC_SUB_SIN)<-c("1 lag","2 lags", "3 lags")
# INPC_E - SIN
INPC_E_SIN_v<-as.vector(INPC_E_SIN)
CV_SIN_v<-as.vector(CV_SIN)
INPC_E_SIN_v2<-cbind(INPC_E_SIN_v,CV_SIN_v)
colnames(INPC_E_SIN_v2)<-c("INPC_E_SIN","CV_SIN")
a<- lag(INPC_E_SIN_v,0)
x<- lag(INPC_E_SIN_v,1)
y<- lag(INPC_E_SIN_v,2)
z<- lag(INPC_E_SIN_v,3)
INPC_E_SIN_lags <- cbind(x,y,z)

fitINPC_E_SIN1 <- auto.arima(INPC_E_SIN_v2[4: 63,2], xreg=INPC_E_SIN_lags[4: 63,1], d=0)
fitINPC_E_SIN2 <- auto.arima(INPC_E_SIN_v2[4: 63,2], xreg=INPC_E_SIN_lags[4: 63,1:2], d=0)
fitINPC_E_SIN3 <- auto.arima(INPC_E_SIN_v2[4: 63,2], xreg=INPC_E_SIN_lags[4: 63,1:3], d=0)
AIC_INPC_E_SIN <- cbind(fitINPC_E_SIN1$aic,fitINPC_E_SIN2$aic,fitINPC_E_SIN3$aic)
colnames(AIC_INPC_E_SIN)<-c("1 lag","2 lags", "3 lags")
# M1 - SIN
M1_SIN_v<-as.vector(M1_SIN)
CV_SIN_v<-as.vector(CV_SIN)
M1_SIN_v2<-cbind(M1_SIN_v,CV_SIN_v)
colnames(M1_SIN_v2)<-c("M1_SIN","CV_SIN")
a<- lag(M1_SIN_v,0)
x<- lag(M1_SIN_v,1)
y<- lag(M1_SIN_v,2)
z<- lag(M1_SIN_v,3)
M1_SIN_lags <- cbind(x,y,z)

fitM1_SIN1 <- auto.arima(M1_SIN_v2[4: 63,2], xreg=M1_SIN_lags[4: 63,1], d=0)
fitM1_SIN2 <- auto.arima(M1_SIN_v2[4: 63,2], xreg=M1_SIN_lags[4: 63,1:2], d=0)
fitM1_SIN3 <- auto.arima(M1_SIN_v2[4: 63,2], xreg=M1_SIN_lags[4: 63,1:3], d=0)
AIC_M1_SIN <- cbind(fitM1_SIN1$aic,fitM1_SIN2$aic,fitM1_SIN3$aic)
colnames(AIC_M1_SIN)<-c("1 lag","2 lags", "3 lags")
# CONF - SIN
CONF_SIN_v<-as.vector(CONF_SIN)
CV_SIN_v<-as.vector(CV_SIN)
CONF_SIN_v2<-cbind(CONF_SIN_v,CV_SIN_v)
colnames(CONF_SIN_v2)<-c("CONF_SIN","CV_SIN")
a<- lag(CONF_SIN_v,0)
x<- lag(CONF_SIN_v,1)
y<- lag(CONF_SIN_v,2)
z<- lag(CONF_SIN_v,3)
CONF_SIN_lags <- cbind(x,y,z)

fitCONF_SIN1 <- auto.arima(CONF_SIN_v2[4: 63,2], xreg=CONF_SIN_lags[4: 63,1], d=0)
fitCONF_SIN2 <- auto.arima(CONF_SIN_v2[4: 63,2], xreg=CONF_SIN_lags[4: 63,1:2], d=0)
fitCONF_SIN3 <- auto.arima(CONF_SIN_v2[4: 63,2], xreg=CONF_SIN_lags[4: 63,1:3], d=0)
AIC_CONF_SIN <- cbind(fitCONF_SIN1$aic,fitCONF_SIN2$aic,fitCONF_SIN3$aic)
colnames(AIC_CONF_SIN)<-c("1 lag","2 lags", "3 lags")

AICs_SIN<-rbind(AIC_IPV_SIN,AIC_UNEMP_SIN,AIC_REM_SIN,AIC_GDP_SIN,AIC_INPC_SUB_SIN,AIC_INPC_E_SIN,AIC_M1_SIN,AIC_CONF_SIN)
rownames(AICs_SIN)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_SIN
```

```{r}
# SLP
# IPV - SLP
IPV_SLP_v<-as.vector(IPV_SLP)
CV_SLP_v<-as.vector(CV_SLP)
IPV_SLP_v2<-cbind(IPV_SLP_v,CV_SLP_v)
colnames(IPV_SLP_v2)<-c("IPV_SLP","CV_SLP")
a<- lag(IPV_SLP_v,0)
x<- lag(IPV_SLP_v,1)
y<- lag(IPV_SLP_v,2)
z<- lag(IPV_SLP_v,3)
IPV_SLP_lags <- cbind(x,y,z)

fitIPV_SLP1 <- auto.arima(IPV_SLP_v2[4: 63,2], xreg=IPV_SLP_lags[4: 63,1], d=0)
fitIPV_SLP2 <- auto.arima(IPV_SLP_v2[4: 63,2], xreg=IPV_SLP_lags[4: 63,1:2], d=0)
fitIPV_SLP3 <- auto.arima(IPV_SLP_v2[4: 63,2], xreg=IPV_SLP_lags[4: 63,1:3], d=0)
AIC_IPV_SLP <- cbind(fitIPV_SLP1$aic,fitIPV_SLP2$aic,fitIPV_SLP3$aic)
colnames(AIC_IPV_SLP)<-c("1 lag","2 lags", "3 lags")
# UNEMP - SLP
UNEMP_SLP_v<-as.vector(UNEMP_SLP)
CV_SLP_v<-as.vector(CV_SLP)
UNEMP_SLP_v2<-cbind(UNEMP_SLP_v,CV_SLP_v)
colnames(UNEMP_SLP_v2)<-c("UNEMP_SLP","CV_SLP")
a<- lag(UNEMP_SLP_v,0)
x<- lag(UNEMP_SLP_v,1)
y<- lag(UNEMP_SLP_v,2)
z<- lag(UNEMP_SLP_v,3)
UNEMP_SLP_lags <- cbind(x,y,z)

fitUNEMP_SLP1 <- auto.arima(UNEMP_SLP_v2[4: 63,2], xreg=UNEMP_SLP_lags[4: 63,1], d=0)
fitUNEMP_SLP2 <- auto.arima(UNEMP_SLP_v2[4: 63,2], xreg=UNEMP_SLP_lags[4: 63,1:2], d=0)
fitUNEMP_SLP3 <- auto.arima(UNEMP_SLP_v2[4: 63,2], xreg=UNEMP_SLP_lags[4: 63,1:3], d=0)
AIC_UNEMP_SLP <- cbind(fitUNEMP_SLP1$aic,fitUNEMP_SLP2$aic,fitUNEMP_SLP3$aic)
colnames(AIC_UNEMP_SLP)<-c("1 lag","2 lags", "3 lags")
# REM - SLP
REM_SLP_v<-as.vector(REM_SLP)
CV_SLP_v<-as.vector(CV_SLP)
REM_SLP_v2<-cbind(REM_SLP_v,CV_SLP_v)
colnames(REM_SLP_v2)<-c("REM_SLP","CV_SLP")
a<- lag(REM_SLP_v,0)
x<- lag(REM_SLP_v,1)
y<- lag(REM_SLP_v,2)
z<- lag(REM_SLP_v,3)
REM_SLP_lags <- cbind(x,y,z)

fitREM_SLP1 <- auto.arima(REM_SLP_v2[4: 63,2], xreg=REM_SLP_lags[4: 63,1], d=0)
fitREM_SLP2 <- auto.arima(REM_SLP_v2[4: 63,2], xreg=REM_SLP_lags[4: 63,1:2], d=0)
fitREM_SLP3 <- auto.arima(REM_SLP_v2[4: 63,2], xreg=REM_SLP_lags[4: 63,1:3], d=0)
AIC_REM_SLP <- cbind(fitREM_SLP1$aic,fitREM_SLP2$aic,fitREM_SLP3$aic)
colnames(AIC_REM_SLP)<-c("1 lag","2 lags", "3 lags")
# GDP - SLP
GDP_SLP_v<-as.vector(GDP_SLP)
CV_SLP_v<-as.vector(CV_SLP)
GDP_SLP_v2<-cbind(GDP_SLP_v,CV_SLP_v)
colnames(GDP_SLP_v2)<-c("GDP_SLP","CV_SLP")
a<- lag(GDP_SLP_v,0)
x<- lag(GDP_SLP_v,1)
y<- lag(GDP_SLP_v,2)
z<- lag(GDP_SLP_v,3)
GDP_SLP_lags <- cbind(x,y,z)

fitGDP_SLP1 <- auto.arima(GDP_SLP_v2[4: 63,2], xreg=GDP_SLP_lags[4: 63,1], d=0)
fitGDP_SLP2 <- auto.arima(GDP_SLP_v2[4: 63,2], xreg=GDP_SLP_lags[4: 63,1:2], d=0)
fitGDP_SLP3 <- auto.arima(GDP_SLP_v2[4: 63,2], xreg=GDP_SLP_lags[4: 63,1:3], d=0)
AIC_GDP_SLP <- cbind(fitGDP_SLP1$aic,fitGDP_SLP2$aic,fitGDP_SLP3$aic)
colnames(AIC_GDP_SLP)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - SLP
INPC_SUB_SLP_v<-as.vector(INPC_SUB_SLP)
CV_SLP_v<-as.vector(CV_SLP)
INPC_SUB_SLP_v2<-cbind(INPC_SUB_SLP_v,CV_SLP_v)
colnames(INPC_SUB_SLP_v2)<-c("INPC_SUB_SLP","CV_SLP")
a<- lag(INPC_SUB_SLP_v,0)
x<- lag(INPC_SUB_SLP_v,1)
y<- lag(INPC_SUB_SLP_v,2)
z<- lag(INPC_SUB_SLP_v,3)
INPC_SUB_SLP_lags <- cbind(x,y,z)

fitINPC_SUB_SLP1 <- auto.arima(INPC_SUB_SLP_v2[4: 63,2], xreg=INPC_SUB_SLP_lags[4: 63,1], d=0)
fitINPC_SUB_SLP2 <- auto.arima(INPC_SUB_SLP_v2[4: 63,2], xreg=INPC_SUB_SLP_lags[4: 63,1:2], d=0)
fitINPC_SUB_SLP3 <- auto.arima(INPC_SUB_SLP_v2[4: 63,2], xreg=INPC_SUB_SLP_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_SLP <- cbind(fitINPC_SUB_SLP1$aic,fitINPC_SUB_SLP2$aic,fitINPC_SUB_SLP3$aic)
colnames(AIC_INPC_SUB_SLP)<-c("1 lag","2 lags", "3 lags")
# INPC_E - SLP
INPC_E_SLP_v<-as.vector(INPC_E_SLP)
CV_SLP_v<-as.vector(CV_SLP)
INPC_E_SLP_v2<-cbind(INPC_E_SLP_v,CV_SLP_v)
colnames(INPC_E_SLP_v2)<-c("INPC_E_SLP","CV_SLP")
a<- lag(INPC_E_SLP_v,0)
x<- lag(INPC_E_SLP_v,1)
y<- lag(INPC_E_SLP_v,2)
z<- lag(INPC_E_SLP_v,3)
INPC_E_SLP_lags <- cbind(x,y,z)

fitINPC_E_SLP1 <- auto.arima(INPC_E_SLP_v2[4: 63,2], xreg=INPC_E_SLP_lags[4: 63,1], d=0)
fitINPC_E_SLP2 <- auto.arima(INPC_E_SLP_v2[4: 63,2], xreg=INPC_E_SLP_lags[4: 63,1:2], d=0)
fitINPC_E_SLP3 <- auto.arima(INPC_E_SLP_v2[4: 63,2], xreg=INPC_E_SLP_lags[4: 63,1:3], d=0)
AIC_INPC_E_SLP <- cbind(fitINPC_E_SLP1$aic,fitINPC_E_SLP2$aic,fitINPC_E_SLP3$aic)
colnames(AIC_INPC_E_SLP)<-c("1 lag","2 lags", "3 lags")
# M1 - SLP
M1_SLP_v<-as.vector(M1_SLP)
CV_SLP_v<-as.vector(CV_SLP)
M1_SLP_v2<-cbind(M1_SLP_v,CV_SLP_v)
colnames(M1_SLP_v2)<-c("M1_SLP","CV_SLP")
a<- lag(M1_SLP_v,0)
x<- lag(M1_SLP_v,1)
y<- lag(M1_SLP_v,2)
z<- lag(M1_SLP_v,3)
M1_SLP_lags <- cbind(x,y,z)

fitM1_SLP1 <- auto.arima(M1_SLP_v2[4: 63,2], xreg=M1_SLP_lags[4: 63,1], d=0)
fitM1_SLP2 <- auto.arima(M1_SLP_v2[4: 63,2], xreg=M1_SLP_lags[4: 63,1:2], d=0)
fitM1_SLP3 <- auto.arima(M1_SLP_v2[4: 63,2], xreg=M1_SLP_lags[4: 63,1:3], d=0)
AIC_M1_SLP <- cbind(fitM1_SLP1$aic,fitM1_SLP2$aic,fitM1_SLP3$aic)
colnames(AIC_M1_SLP)<-c("1 lag","2 lags", "3 lags")
# CONF - SLP
CONF_SLP_v<-as.vector(CONF_SLP)
CV_SLP_v<-as.vector(CV_SLP)
CONF_SLP_v2<-cbind(CONF_SLP_v,CV_SLP_v)
colnames(CONF_SLP_v2)<-c("CONF_SLP","CV_SLP")
a<- lag(CONF_SLP_v,0)
x<- lag(CONF_SLP_v,1)
y<- lag(CONF_SLP_v,2)
z<- lag(CONF_SLP_v,3)
CONF_SLP_lags <- cbind(x,y,z)

fitCONF_SLP1 <- auto.arima(CONF_SLP_v2[4: 63,2], xreg=CONF_SLP_lags[4: 63,1], d=0)
fitCONF_SLP2 <- auto.arima(CONF_SLP_v2[4: 63,2], xreg=CONF_SLP_lags[4: 63,1:2], d=0)
fitCONF_SLP3 <- auto.arima(CONF_SLP_v2[4: 63,2], xreg=CONF_SLP_lags[4: 63,1:3], d=0)
AIC_CONF_SLP <- cbind(fitCONF_SLP1$aic,fitCONF_SLP2$aic,fitCONF_SLP3$aic)
colnames(AIC_CONF_SLP)<-c("1 lag","2 lags", "3 lags")

AICs_SLP<-rbind(AIC_IPV_SLP,AIC_UNEMP_SLP,AIC_REM_SLP,AIC_GDP_SLP,AIC_INPC_SUB_SLP,AIC_INPC_E_SLP,AIC_M1_SLP,AIC_CONF_SLP)
rownames(AICs_SLP)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_SLP
```

```{r}
# SON
# IPV - SON
IPV_SON_v<-as.vector(IPV_SON)
CV_SON_v<-as.vector(CV_SON)
IPV_SON_v2<-cbind(IPV_SON_v,CV_SON_v)
colnames(IPV_SON_v2)<-c("IPV_SON","CV_SON")
a<- lag(IPV_SON_v,0)
x<- lag(IPV_SON_v,1)
y<- lag(IPV_SON_v,2)
z<- lag(IPV_SON_v,3)
IPV_SON_lags <- cbind(x,y,z)

fitIPV_SON1 <- auto.arima(IPV_SON_v2[4: 63,2], xreg=IPV_SON_lags[4: 63,1], d=0)
fitIPV_SON2 <- auto.arima(IPV_SON_v2[4: 63,2], xreg=IPV_SON_lags[4: 63,1:2], d=0)
fitIPV_SON3 <- auto.arima(IPV_SON_v2[4: 63,2], xreg=IPV_SON_lags[4: 63,1:3], d=0)
AIC_IPV_SON <- cbind(fitIPV_SON1$aic,fitIPV_SON2$aic,fitIPV_SON3$aic)
colnames(AIC_IPV_SON)<-c("1 lag","2 lags", "3 lags")
# UNEMP - SON
UNEMP_SON_v<-as.vector(UNEMP_SON)
CV_SON_v<-as.vector(CV_SON)
UNEMP_SON_v2<-cbind(UNEMP_SON_v,CV_SON_v)
colnames(UNEMP_SON_v2)<-c("UNEMP_SON","CV_SON")
a<- lag(UNEMP_SON_v,0)
x<- lag(UNEMP_SON_v,1)
y<- lag(UNEMP_SON_v,2)
z<- lag(UNEMP_SON_v,3)
UNEMP_SON_lags <- cbind(x,y,z)

fitUNEMP_SON1 <- auto.arima(UNEMP_SON_v2[4: 63,2], xreg=UNEMP_SON_lags[4: 63,1], d=0)
fitUNEMP_SON2 <- auto.arima(UNEMP_SON_v2[4: 63,2], xreg=UNEMP_SON_lags[4: 63,1:2], d=0)
fitUNEMP_SON3 <- auto.arima(UNEMP_SON_v2[4: 63,2], xreg=UNEMP_SON_lags[4: 63,1:3], d=0)
AIC_UNEMP_SON <- cbind(fitUNEMP_SON1$aic,fitUNEMP_SON2$aic,fitUNEMP_SON3$aic)
colnames(AIC_UNEMP_SON)<-c("1 lag","2 lags", "3 lags")
# REM - SON
REM_SON_v<-as.vector(REM_SON)
CV_SON_v<-as.vector(CV_SON)
REM_SON_v2<-cbind(REM_SON_v,CV_SON_v)
colnames(REM_SON_v2)<-c("REM_SON","CV_SON")
a<- lag(REM_SON_v,0)
x<- lag(REM_SON_v,1)
y<- lag(REM_SON_v,2)
z<- lag(REM_SON_v,3)
REM_SON_lags <- cbind(x,y,z)

fitREM_SON1 <- auto.arima(REM_SON_v2[4: 63,2], xreg=REM_SON_lags[4: 63,1], d=0)
fitREM_SON2 <- auto.arima(REM_SON_v2[4: 63,2], xreg=REM_SON_lags[4: 63,1:2], d=0)
fitREM_SON3 <- auto.arima(REM_SON_v2[4: 63,2], xreg=REM_SON_lags[4: 63,1:3], d=0)
AIC_REM_SON <- cbind(fitREM_SON1$aic,fitREM_SON2$aic,fitREM_SON3$aic)
colnames(AIC_REM_SON)<-c("1 lag","2 lags", "3 lags")
# GDP - SON
GDP_SON_v<-as.vector(GDP_SON)
CV_SON_v<-as.vector(CV_SON)
GDP_SON_v2<-cbind(GDP_SON_v,CV_SON_v)
colnames(GDP_SON_v2)<-c("GDP_SON","CV_SON")
a<- lag(GDP_SON_v,0)
x<- lag(GDP_SON_v,1)
y<- lag(GDP_SON_v,2)
z<- lag(GDP_SON_v,3)
GDP_SON_lags <- cbind(x,y,z)

fitGDP_SON1 <- auto.arima(GDP_SON_v2[4: 63,2], xreg=GDP_SON_lags[4: 63,1], d=0)
fitGDP_SON2 <- auto.arima(GDP_SON_v2[4: 63,2], xreg=GDP_SON_lags[4: 63,1:2], d=0)
fitGDP_SON3 <- auto.arima(GDP_SON_v2[4: 63,2], xreg=GDP_SON_lags[4: 63,1:3], d=0)
AIC_GDP_SON <- cbind(fitGDP_SON1$aic,fitGDP_SON2$aic,fitGDP_SON3$aic)
colnames(AIC_GDP_SON)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - SON
INPC_SUB_SON_v<-as.vector(INPC_SUB_SON)
CV_SON_v<-as.vector(CV_SON)
INPC_SUB_SON_v2<-cbind(INPC_SUB_SON_v,CV_SON_v)
colnames(INPC_SUB_SON_v2)<-c("INPC_SUB_SON","CV_SON")
a<- lag(INPC_SUB_SON_v,0)
x<- lag(INPC_SUB_SON_v,1)
y<- lag(INPC_SUB_SON_v,2)
z<- lag(INPC_SUB_SON_v,3)
INPC_SUB_SON_lags <- cbind(x,y,z)

fitINPC_SUB_SON1 <- auto.arima(INPC_SUB_SON_v2[4: 63,2], xreg=INPC_SUB_SON_lags[4: 63,1], d=0)
fitINPC_SUB_SON2 <- auto.arima(INPC_SUB_SON_v2[4: 63,2], xreg=INPC_SUB_SON_lags[4: 63,1:2], d=0)
fitINPC_SUB_SON3 <- auto.arima(INPC_SUB_SON_v2[4: 63,2], xreg=INPC_SUB_SON_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_SON <- cbind(fitINPC_SUB_SON1$aic,fitINPC_SUB_SON2$aic,fitINPC_SUB_SON3$aic)
colnames(AIC_INPC_SUB_SON)<-c("1 lag","2 lags", "3 lags")
# INPC_E - SON
INPC_E_SON_v<-as.vector(INPC_E_SON)
CV_SON_v<-as.vector(CV_SON)
INPC_E_SON_v2<-cbind(INPC_E_SON_v,CV_SON_v)
colnames(INPC_E_SON_v2)<-c("INPC_E_SON","CV_SON")
a<- lag(INPC_E_SON_v,0)
x<- lag(INPC_E_SON_v,1)
y<- lag(INPC_E_SON_v,2)
z<- lag(INPC_E_SON_v,3)
INPC_E_SON_lags <- cbind(x,y,z)

fitINPC_E_SON1 <- auto.arima(INPC_E_SON_v2[4: 63,2], xreg=INPC_E_SON_lags[4: 63,1], d=0)
fitINPC_E_SON2 <- auto.arima(INPC_E_SON_v2[4: 63,2], xreg=INPC_E_SON_lags[4: 63,1:2], d=0)
fitINPC_E_SON3 <- auto.arima(INPC_E_SON_v2[4: 63,2], xreg=INPC_E_SON_lags[4: 63,1:3], d=0)
AIC_INPC_E_SON <- cbind(fitINPC_E_SON1$aic,fitINPC_E_SON2$aic,fitINPC_E_SON3$aic)
colnames(AIC_INPC_E_SON)<-c("1 lag","2 lags", "3 lags")
# M1 - SON
M1_SON_v<-as.vector(M1_SON)
CV_SON_v<-as.vector(CV_SON)
M1_SON_v2<-cbind(M1_SON_v,CV_SON_v)
colnames(M1_SON_v2)<-c("M1_SON","CV_SON")
a<- lag(M1_SON_v,0)
x<- lag(M1_SON_v,1)
y<- lag(M1_SON_v,2)
z<- lag(M1_SON_v,3)
M1_SON_lags <- cbind(x,y,z)

fitM1_SON1 <- auto.arima(M1_SON_v2[4: 63,2], xreg=M1_SON_lags[4: 63,1], d=0)
fitM1_SON2 <- auto.arima(M1_SON_v2[4: 63,2], xreg=M1_SON_lags[4: 63,1:2], d=0)
fitM1_SON3 <- auto.arima(M1_SON_v2[4: 63,2], xreg=M1_SON_lags[4: 63,1:3], d=0)
AIC_M1_SON <- cbind(fitM1_SON1$aic,fitM1_SON2$aic,fitM1_SON3$aic)
colnames(AIC_M1_SON)<-c("1 lag","2 lags", "3 lags")
# CONF - SON
CONF_SON_v<-as.vector(CONF_SON)
CV_SON_v<-as.vector(CV_SON)
CONF_SON_v2<-cbind(CONF_SON_v,CV_SON_v)
colnames(CONF_SON_v2)<-c("CONF_SON","CV_SON")
a<- lag(CONF_SON_v,0)
x<- lag(CONF_SON_v,1)
y<- lag(CONF_SON_v,2)
z<- lag(CONF_SON_v,3)
CONF_SON_lags <- cbind(x,y,z)

fitCONF_SON1 <- auto.arima(CONF_SON_v2[4: 63,2], xreg=CONF_SON_lags[4: 63,1], d=0)
fitCONF_SON2 <- auto.arima(CONF_SON_v2[4: 63,2], xreg=CONF_SON_lags[4: 63,1:2], d=0)
fitCONF_SON3 <- auto.arima(CONF_SON_v2[4: 63,2], xreg=CONF_SON_lags[4: 63,1:3], d=0)
AIC_CONF_SON <- cbind(fitCONF_SON1$aic,fitCONF_SON2$aic,fitCONF_SON3$aic)
colnames(AIC_CONF_SON)<-c("1 lag","2 lags", "3 lags")

AICs_SON<-rbind(AIC_IPV_SON,AIC_UNEMP_SON,AIC_REM_SON,AIC_GDP_SON,AIC_INPC_SUB_SON,AIC_INPC_E_SON,AIC_M1_SON,AIC_CONF_SON)
rownames(AICs_SON)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_SON
```

```{r}
# TAB
# IPV - TAB
IPV_TAB_v<-as.vector(IPV_TAB)
CV_TAB_v<-as.vector(CV_TAB)
IPV_TAB_v2<-cbind(IPV_TAB_v,CV_TAB_v)
colnames(IPV_TAB_v2)<-c("IPV_TAB","CV_TAB")
a<- lag(IPV_TAB_v,0)
x<- lag(IPV_TAB_v,1)
y<- lag(IPV_TAB_v,2)
z<- lag(IPV_TAB_v,3)
IPV_TAB_lags <- cbind(x,y,z)

fitIPV_TAB1 <- auto.arima(IPV_TAB_v2[4: 63,2], xreg=IPV_TAB_lags[4: 63,1], d=0)
fitIPV_TAB2 <- auto.arima(IPV_TAB_v2[4: 63,2], xreg=IPV_TAB_lags[4: 63,1:2], d=0)
fitIPV_TAB3 <- auto.arima(IPV_TAB_v2[4: 63,2], xreg=IPV_TAB_lags[4: 63,1:3], d=0)
AIC_IPV_TAB <- cbind(fitIPV_TAB1$aic,fitIPV_TAB2$aic,fitIPV_TAB3$aic)
colnames(AIC_IPV_TAB)<-c("1 lag","2 lags", "3 lags")
# UNEMP - TAB
UNEMP_TAB_v<-as.vector(UNEMP_TAB)
CV_TAB_v<-as.vector(CV_TAB)
UNEMP_TAB_v2<-cbind(UNEMP_TAB_v,CV_TAB_v)
colnames(UNEMP_TAB_v2)<-c("UNEMP_TAB","CV_TAB")
a<- lag(UNEMP_TAB_v,0)
x<- lag(UNEMP_TAB_v,1)
y<- lag(UNEMP_TAB_v,2)
z<- lag(UNEMP_TAB_v,3)
UNEMP_TAB_lags <- cbind(x,y,z)

fitUNEMP_TAB1 <- auto.arima(UNEMP_TAB_v2[4: 63,2], xreg=UNEMP_TAB_lags[4: 63,1], d=0)
fitUNEMP_TAB2 <- auto.arima(UNEMP_TAB_v2[4: 63,2], xreg=UNEMP_TAB_lags[4: 63,1:2], d=0)
fitUNEMP_TAB3 <- auto.arima(UNEMP_TAB_v2[4: 63,2], xreg=UNEMP_TAB_lags[4: 63,1:3], d=0)
AIC_UNEMP_TAB <- cbind(fitUNEMP_TAB1$aic,fitUNEMP_TAB2$aic,fitUNEMP_TAB3$aic)
colnames(AIC_UNEMP_TAB)<-c("1 lag","2 lags", "3 lags")
# REM - TAB
REM_TAB_v<-as.vector(REM_TAB)
CV_TAB_v<-as.vector(CV_TAB)
REM_TAB_v2<-cbind(REM_TAB_v,CV_TAB_v)
colnames(REM_TAB_v2)<-c("REM_TAB","CV_TAB")
a<- lag(REM_TAB_v,0)
x<- lag(REM_TAB_v,1)
y<- lag(REM_TAB_v,2)
z<- lag(REM_TAB_v,3)
REM_TAB_lags <- cbind(x,y,z)

fitREM_TAB1 <- auto.arima(REM_TAB_v2[4: 63,2], xreg=REM_TAB_lags[4: 63,1], d=0)
fitREM_TAB2 <- auto.arima(REM_TAB_v2[4: 63,2], xreg=REM_TAB_lags[4: 63,1:2], d=0)
fitREM_TAB3 <- auto.arima(REM_TAB_v2[4: 63,2], xreg=REM_TAB_lags[4: 63,1:3], d=0)
AIC_REM_TAB <- cbind(fitREM_TAB1$aic,fitREM_TAB2$aic,fitREM_TAB3$aic)
colnames(AIC_REM_TAB)<-c("1 lag","2 lags", "3 lags")
# GDP - TAB
GDP_TAB_v<-as.vector(GDP_TAB)
CV_TAB_v<-as.vector(CV_TAB)
GDP_TAB_v2<-cbind(GDP_TAB_v,CV_TAB_v)
colnames(GDP_TAB_v2)<-c("GDP_TAB","CV_TAB")
a<- lag(GDP_TAB_v,0)
x<- lag(GDP_TAB_v,1)
y<- lag(GDP_TAB_v,2)
z<- lag(GDP_TAB_v,3)
GDP_TAB_lags <- cbind(x,y,z)

fitGDP_TAB1 <- auto.arima(GDP_TAB_v2[4: 63,2], xreg=GDP_TAB_lags[4: 63,1], d=0)
fitGDP_TAB2 <- auto.arima(GDP_TAB_v2[4: 63,2], xreg=GDP_TAB_lags[4: 63,1:2], d=0)
fitGDP_TAB3 <- auto.arima(GDP_TAB_v2[4: 63,2], xreg=GDP_TAB_lags[4: 63,1:3], d=0)
AIC_GDP_TAB <- cbind(fitGDP_TAB1$aic,fitGDP_TAB2$aic,fitGDP_TAB3$aic)
colnames(AIC_GDP_TAB)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - TAB
INPC_SUB_TAB_v<-as.vector(INPC_SUB_TAB)
CV_TAB_v<-as.vector(CV_TAB)
INPC_SUB_TAB_v2<-cbind(INPC_SUB_TAB_v,CV_TAB_v)
colnames(INPC_SUB_TAB_v2)<-c("INPC_SUB_TAB","CV_TAB")
a<- lag(INPC_SUB_TAB_v,0)
x<- lag(INPC_SUB_TAB_v,1)
y<- lag(INPC_SUB_TAB_v,2)
z<- lag(INPC_SUB_TAB_v,3)
INPC_SUB_TAB_lags <- cbind(x,y,z)

fitINPC_SUB_TAB1 <- auto.arima(INPC_SUB_TAB_v2[4: 63,2], xreg=INPC_SUB_TAB_lags[4: 63,1], d=0)
fitINPC_SUB_TAB2 <- auto.arima(INPC_SUB_TAB_v2[4: 63,2], xreg=INPC_SUB_TAB_lags[4: 63,1:2], d=0)
fitINPC_SUB_TAB3 <- auto.arima(INPC_SUB_TAB_v2[4: 63,2], xreg=INPC_SUB_TAB_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_TAB <- cbind(fitINPC_SUB_TAB1$aic,fitINPC_SUB_TAB2$aic,fitINPC_SUB_TAB3$aic)
colnames(AIC_INPC_SUB_TAB)<-c("1 lag","2 lags", "3 lags")
# INPC_E - TAB
INPC_E_TAB_v<-as.vector(INPC_E_TAB)
CV_TAB_v<-as.vector(CV_TAB)
INPC_E_TAB_v2<-cbind(INPC_E_TAB_v,CV_TAB_v)
colnames(INPC_E_TAB_v2)<-c("INPC_E_TAB","CV_TAB")
a<- lag(INPC_E_TAB_v,0)
x<- lag(INPC_E_TAB_v,1)
y<- lag(INPC_E_TAB_v,2)
z<- lag(INPC_E_TAB_v,3)
INPC_E_TAB_lags <- cbind(x,y,z)

fitINPC_E_TAB1 <- auto.arima(INPC_E_TAB_v2[4: 63,2], xreg=INPC_E_TAB_lags[4: 63,1], d=0)
fitINPC_E_TAB2 <- auto.arima(INPC_E_TAB_v2[4: 63,2], xreg=INPC_E_TAB_lags[4: 63,1:2], d=0)
fitINPC_E_TAB3 <- auto.arima(INPC_E_TAB_v2[4: 63,2], xreg=INPC_E_TAB_lags[4: 63,1:3], d=0)
AIC_INPC_E_TAB <- cbind(fitINPC_E_TAB1$aic,fitINPC_E_TAB2$aic,fitINPC_E_TAB3$aic)
colnames(AIC_INPC_E_TAB)<-c("1 lag","2 lags", "3 lags")
# M1 - TAB
M1_TAB_v<-as.vector(M1_TAB)
CV_TAB_v<-as.vector(CV_TAB)
M1_TAB_v2<-cbind(M1_TAB_v,CV_TAB_v)
colnames(M1_TAB_v2)<-c("M1_TAB","CV_TAB")
a<- lag(M1_TAB_v,0)
x<- lag(M1_TAB_v,1)
y<- lag(M1_TAB_v,2)
z<- lag(M1_TAB_v,3)
M1_TAB_lags <- cbind(x,y,z)

fitM1_TAB1 <- auto.arima(M1_TAB_v2[4: 63,2], xreg=M1_TAB_lags[4: 63,1], d=0)
fitM1_TAB2 <- auto.arima(M1_TAB_v2[4: 63,2], xreg=M1_TAB_lags[4: 63,1:2], d=0)
fitM1_TAB3 <- auto.arima(M1_TAB_v2[4: 63,2], xreg=M1_TAB_lags[4: 63,1:3], d=0)
AIC_M1_TAB <- cbind(fitM1_TAB1$aic,fitM1_TAB2$aic,fitM1_TAB3$aic)
colnames(AIC_M1_TAB)<-c("1 lag","2 lags", "3 lags")
# CONF - TAB
CONF_TAB_v<-as.vector(CONF_TAB)
CV_TAB_v<-as.vector(CV_TAB)
CONF_TAB_v2<-cbind(CONF_TAB_v,CV_TAB_v)
colnames(CONF_TAB_v2)<-c("CONF_TAB","CV_TAB")
a<- lag(CONF_TAB_v,0)
x<- lag(CONF_TAB_v,1)
y<- lag(CONF_TAB_v,2)
z<- lag(CONF_TAB_v,3)
CONF_TAB_lags <- cbind(x,y,z)

fitCONF_TAB1 <- auto.arima(CONF_TAB_v2[4: 63,2], xreg=CONF_TAB_lags[4: 63,1], d=0)
fitCONF_TAB2 <- auto.arima(CONF_TAB_v2[4: 63,2], xreg=CONF_TAB_lags[4: 63,1:2], d=0)
fitCONF_TAB3 <- auto.arima(CONF_TAB_v2[4: 63,2], xreg=CONF_TAB_lags[4: 63,1:3], d=0)
AIC_CONF_TAB <- cbind(fitCONF_TAB1$aic,fitCONF_TAB2$aic,fitCONF_TAB3$aic)
colnames(AIC_CONF_TAB)<-c("1 lag","2 lags", "3 lags")

AICs_TAB<-rbind(AIC_IPV_TAB,AIC_UNEMP_TAB,AIC_REM_TAB,AIC_GDP_TAB,AIC_INPC_SUB_TAB,AIC_INPC_E_TAB,AIC_M1_TAB,AIC_CONF_TAB)
rownames(AICs_TAB)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_TAB
```

```{r}
# TAMPS
# IPV - TAMPS
IPV_TAMPS_v<-as.vector(IPV_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
IPV_TAMPS_v2<-cbind(IPV_TAMPS_v,CV_TAMPS_v)
colnames(IPV_TAMPS_v2)<-c("IPV_TAMPS","CV_TAMPS")
a<- lag(IPV_TAMPS_v,0)
x<- lag(IPV_TAMPS_v,1)
y<- lag(IPV_TAMPS_v,2)
z<- lag(IPV_TAMPS_v,3)
IPV_TAMPS_lags <- cbind(x,y,z)

fitIPV_TAMPS1 <- auto.arima(IPV_TAMPS_v2[4: 63,2], xreg=IPV_TAMPS_lags[4: 63,1], d=0)
fitIPV_TAMPS2 <- auto.arima(IPV_TAMPS_v2[4: 63,2], xreg=IPV_TAMPS_lags[4: 63,1:2], d=0)
fitIPV_TAMPS3 <- auto.arima(IPV_TAMPS_v2[4: 63,2], xreg=IPV_TAMPS_lags[4: 63,1:3], d=0)
AIC_IPV_TAMPS <- cbind(fitIPV_TAMPS1$aic,fitIPV_TAMPS2$aic,fitIPV_TAMPS3$aic)
colnames(AIC_IPV_TAMPS)<-c("1 lag","2 lags", "3 lags")
# UNEMP - TAMPS
UNEMP_TAMPS_v<-as.vector(UNEMP_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
UNEMP_TAMPS_v2<-cbind(UNEMP_TAMPS_v,CV_TAMPS_v)
colnames(UNEMP_TAMPS_v2)<-c("UNEMP_TAMPS","CV_TAMPS")
a<- lag(UNEMP_TAMPS_v,0)
x<- lag(UNEMP_TAMPS_v,1)
y<- lag(UNEMP_TAMPS_v,2)
z<- lag(UNEMP_TAMPS_v,3)
UNEMP_TAMPS_lags <- cbind(x,y,z)

fitUNEMP_TAMPS1 <- auto.arima(UNEMP_TAMPS_v2[4: 63,2], xreg=UNEMP_TAMPS_lags[4: 63,1], d=0)
fitUNEMP_TAMPS2 <- auto.arima(UNEMP_TAMPS_v2[4: 63,2], xreg=UNEMP_TAMPS_lags[4: 63,1:2], d=0)
fitUNEMP_TAMPS3 <- auto.arima(UNEMP_TAMPS_v2[4: 63,2], xreg=UNEMP_TAMPS_lags[4: 63,1:3], d=0)
AIC_UNEMP_TAMPS <- cbind(fitUNEMP_TAMPS1$aic,fitUNEMP_TAMPS2$aic,fitUNEMP_TAMPS3$aic)
colnames(AIC_UNEMP_TAMPS)<-c("1 lag","2 lags", "3 lags")
# REM - TAMPS
REM_TAMPS_v<-as.vector(REM_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
REM_TAMPS_v2<-cbind(REM_TAMPS_v,CV_TAMPS_v)
colnames(REM_TAMPS_v2)<-c("REM_TAMPS","CV_TAMPS")
a<- lag(REM_TAMPS_v,0)
x<- lag(REM_TAMPS_v,1)
y<- lag(REM_TAMPS_v,2)
z<- lag(REM_TAMPS_v,3)
REM_TAMPS_lags <- cbind(x,y,z)

fitREM_TAMPS1 <- auto.arima(REM_TAMPS_v2[4: 63,2], xreg=REM_TAMPS_lags[4: 63,1], d=0)
fitREM_TAMPS2 <- auto.arima(REM_TAMPS_v2[4: 63,2], xreg=REM_TAMPS_lags[4: 63,1:2], d=0)
fitREM_TAMPS3 <- auto.arima(REM_TAMPS_v2[4: 63,2], xreg=REM_TAMPS_lags[4: 63,1:3], d=0)
AIC_REM_TAMPS <- cbind(fitREM_TAMPS1$aic,fitREM_TAMPS2$aic,fitREM_TAMPS3$aic)
colnames(AIC_REM_TAMPS)<-c("1 lag","2 lags", "3 lags")
# GDP - TAMPS
GDP_TAMPS_v<-as.vector(GDP_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
GDP_TAMPS_v2<-cbind(GDP_TAMPS_v,CV_TAMPS_v)
colnames(GDP_TAMPS_v2)<-c("GDP_TAMPS","CV_TAMPS")
a<- lag(GDP_TAMPS_v,0)
x<- lag(GDP_TAMPS_v,1)
y<- lag(GDP_TAMPS_v,2)
z<- lag(GDP_TAMPS_v,3)
GDP_TAMPS_lags <- cbind(x,y,z)

fitGDP_TAMPS1 <- auto.arima(GDP_TAMPS_v2[4: 63,2], xreg=GDP_TAMPS_lags[4: 63,1], d=0)
fitGDP_TAMPS2 <- auto.arima(GDP_TAMPS_v2[4: 63,2], xreg=GDP_TAMPS_lags[4: 63,1:2], d=0)
fitGDP_TAMPS3 <- auto.arima(GDP_TAMPS_v2[4: 63,2], xreg=GDP_TAMPS_lags[4: 63,1:3], d=0)
AIC_GDP_TAMPS <- cbind(fitGDP_TAMPS1$aic,fitGDP_TAMPS2$aic,fitGDP_TAMPS3$aic)
colnames(AIC_GDP_TAMPS)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - TAMPS
INPC_SUB_TAMPS_v<-as.vector(INPC_SUB_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
INPC_SUB_TAMPS_v2<-cbind(INPC_SUB_TAMPS_v,CV_TAMPS_v)
colnames(INPC_SUB_TAMPS_v2)<-c("INPC_SUB_TAMPS","CV_TAMPS")
a<- lag(INPC_SUB_TAMPS_v,0)
x<- lag(INPC_SUB_TAMPS_v,1)
y<- lag(INPC_SUB_TAMPS_v,2)
z<- lag(INPC_SUB_TAMPS_v,3)
INPC_SUB_TAMPS_lags <- cbind(x,y,z)

fitINPC_SUB_TAMPS1 <- auto.arima(INPC_SUB_TAMPS_v2[4: 63,2], xreg=INPC_SUB_TAMPS_lags[4: 63,1], d=0)
fitINPC_SUB_TAMPS2 <- auto.arima(INPC_SUB_TAMPS_v2[4: 63,2], xreg=INPC_SUB_TAMPS_lags[4: 63,1:2], d=0)
fitINPC_SUB_TAMPS3 <- auto.arima(INPC_SUB_TAMPS_v2[4: 63,2], xreg=INPC_SUB_TAMPS_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_TAMPS <- cbind(fitINPC_SUB_TAMPS1$aic,fitINPC_SUB_TAMPS2$aic,fitINPC_SUB_TAMPS3$aic)
colnames(AIC_INPC_SUB_TAMPS)<-c("1 lag","2 lags", "3 lags")
# INPC_E - TAMPS
INPC_E_TAMPS_v<-as.vector(INPC_E_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
INPC_E_TAMPS_v2<-cbind(INPC_E_TAMPS_v,CV_TAMPS_v)
colnames(INPC_E_TAMPS_v2)<-c("INPC_E_TAMPS","CV_TAMPS")
a<- lag(INPC_E_TAMPS_v,0)
x<- lag(INPC_E_TAMPS_v,1)
y<- lag(INPC_E_TAMPS_v,2)
z<- lag(INPC_E_TAMPS_v,3)
INPC_E_TAMPS_lags <- cbind(x,y,z)

fitINPC_E_TAMPS1 <- auto.arima(INPC_E_TAMPS_v2[4: 63,2], xreg=INPC_E_TAMPS_lags[4: 63,1], d=0)
fitINPC_E_TAMPS2 <- auto.arima(INPC_E_TAMPS_v2[4: 63,2], xreg=INPC_E_TAMPS_lags[4: 63,1:2], d=0)
fitINPC_E_TAMPS3 <- auto.arima(INPC_E_TAMPS_v2[4: 63,2], xreg=INPC_E_TAMPS_lags[4: 63,1:3], d=0)
AIC_INPC_E_TAMPS <- cbind(fitINPC_E_TAMPS1$aic,fitINPC_E_TAMPS2$aic,fitINPC_E_TAMPS3$aic)
colnames(AIC_INPC_E_TAMPS)<-c("1 lag","2 lags", "3 lags")
# M1 - TAMPS
M1_TAMPS_v<-as.vector(M1_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
M1_TAMPS_v2<-cbind(M1_TAMPS_v,CV_TAMPS_v)
colnames(M1_TAMPS_v2)<-c("M1_TAMPS","CV_TAMPS")
a<- lag(M1_TAMPS_v,0)
x<- lag(M1_TAMPS_v,1)
y<- lag(M1_TAMPS_v,2)
z<- lag(M1_TAMPS_v,3)
M1_TAMPS_lags <- cbind(x,y,z)

fitM1_TAMPS1 <- auto.arima(M1_TAMPS_v2[4: 63,2], xreg=M1_TAMPS_lags[4: 63,1], d=0)
fitM1_TAMPS2 <- auto.arima(M1_TAMPS_v2[4: 63,2], xreg=M1_TAMPS_lags[4: 63,1:2], d=0)
fitM1_TAMPS3 <- auto.arima(M1_TAMPS_v2[4: 63,2], xreg=M1_TAMPS_lags[4: 63,1:3], d=0)
AIC_M1_TAMPS <- cbind(fitM1_TAMPS1$aic,fitM1_TAMPS2$aic,fitM1_TAMPS3$aic)
colnames(AIC_M1_TAMPS)<-c("1 lag","2 lags", "3 lags")
# CONF - TAMPS
CONF_TAMPS_v<-as.vector(CONF_TAMPS)
CV_TAMPS_v<-as.vector(CV_TAMPS)
CONF_TAMPS_v2<-cbind(CONF_TAMPS_v,CV_TAMPS_v)
colnames(CONF_TAMPS_v2)<-c("CONF_TAMPS","CV_TAMPS")
a<- lag(CONF_TAMPS_v,0)
x<- lag(CONF_TAMPS_v,1)
y<- lag(CONF_TAMPS_v,2)
z<- lag(CONF_TAMPS_v,3)
CONF_TAMPS_lags <- cbind(x,y,z)

fitCONF_TAMPS1 <- auto.arima(CONF_TAMPS_v2[4: 63,2], xreg=CONF_TAMPS_lags[4: 63,1], d=0)
fitCONF_TAMPS2 <- auto.arima(CONF_TAMPS_v2[4: 63,2], xreg=CONF_TAMPS_lags[4: 63,1:2], d=0)
fitCONF_TAMPS3 <- auto.arima(CONF_TAMPS_v2[4: 63,2], xreg=CONF_TAMPS_lags[4: 63,1:3], d=0)
AIC_CONF_TAMPS <- cbind(fitCONF_TAMPS1$aic,fitCONF_TAMPS2$aic,fitCONF_TAMPS3$aic)
colnames(AIC_CONF_TAMPS)<-c("1 lag","2 lags", "3 lags")

AICs_TAMPS<-rbind(AIC_IPV_TAMPS,AIC_UNEMP_TAMPS,AIC_REM_TAMPS,AIC_GDP_TAMPS,AIC_INPC_SUB_TAMPS,AIC_INPC_E_TAMPS,AIC_M1_TAMPS,AIC_CONF_TAMPS)
rownames(AICs_TAMPS)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_TAMPS
```

```{r}
# TLAX
# IPV - TLAX
IPV_TLAX_v<-as.vector(IPV_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
IPV_TLAX_v2<-cbind(IPV_TLAX_v,CV_TLAX_v)
colnames(IPV_TLAX_v2)<-c("IPV_TLAX","CV_TLAX")
a<- lag(IPV_TLAX_v,0)
x<- lag(IPV_TLAX_v,1)
y<- lag(IPV_TLAX_v,2)
z<- lag(IPV_TLAX_v,3)
IPV_TLAX_lags <- cbind(x,y,z)

fitIPV_TLAX1 <- auto.arima(IPV_TLAX_v2[4: 63,2], xreg=IPV_TLAX_lags[4: 63,1], d=0)
fitIPV_TLAX2 <- auto.arima(IPV_TLAX_v2[4: 63,2], xreg=IPV_TLAX_lags[4: 63,1:2], d=0)
fitIPV_TLAX3 <- auto.arima(IPV_TLAX_v2[4: 63,2], xreg=IPV_TLAX_lags[4: 63,1:3], d=0)
AIC_IPV_TLAX <- cbind(fitIPV_TLAX1$aic,fitIPV_TLAX2$aic,fitIPV_TLAX3$aic)
colnames(AIC_IPV_TLAX)<-c("1 lag","2 lags", "3 lags")
# UNEMP - TLAX
UNEMP_TLAX_v<-as.vector(UNEMP_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
UNEMP_TLAX_v2<-cbind(UNEMP_TLAX_v,CV_TLAX_v)
colnames(UNEMP_TLAX_v2)<-c("UNEMP_TLAX","CV_TLAX")
a<- lag(UNEMP_TLAX_v,0)
x<- lag(UNEMP_TLAX_v,1)
y<- lag(UNEMP_TLAX_v,2)
z<- lag(UNEMP_TLAX_v,3)
UNEMP_TLAX_lags <- cbind(x,y,z)

fitUNEMP_TLAX1 <- auto.arima(UNEMP_TLAX_v2[4: 63,2], xreg=UNEMP_TLAX_lags[4: 63,1], d=0)
fitUNEMP_TLAX2 <- auto.arima(UNEMP_TLAX_v2[4: 63,2], xreg=UNEMP_TLAX_lags[4: 63,1:2], d=0)
fitUNEMP_TLAX3 <- auto.arima(UNEMP_TLAX_v2[4: 63,2], xreg=UNEMP_TLAX_lags[4: 63,1:3], d=0)
AIC_UNEMP_TLAX <- cbind(fitUNEMP_TLAX1$aic,fitUNEMP_TLAX2$aic,fitUNEMP_TLAX3$aic)
colnames(AIC_UNEMP_TLAX)<-c("1 lag","2 lags", "3 lags")
# REM - TLAX
REM_TLAX_v<-as.vector(REM_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
REM_TLAX_v2<-cbind(REM_TLAX_v,CV_TLAX_v)
colnames(REM_TLAX_v2)<-c("REM_TLAX","CV_TLAX")
a<- lag(REM_TLAX_v,0)
x<- lag(REM_TLAX_v,1)
y<- lag(REM_TLAX_v,2)
z<- lag(REM_TLAX_v,3)
REM_TLAX_lags <- cbind(x,y,z)

fitREM_TLAX1 <- auto.arima(REM_TLAX_v2[4: 63,2], xreg=REM_TLAX_lags[4: 63,1], d=0)
fitREM_TLAX2 <- auto.arima(REM_TLAX_v2[4: 63,2], xreg=REM_TLAX_lags[4: 63,1:2], d=0)
fitREM_TLAX3 <- auto.arima(REM_TLAX_v2[4: 63,2], xreg=REM_TLAX_lags[4: 63,1:3], d=0)
AIC_REM_TLAX <- cbind(fitREM_TLAX1$aic,fitREM_TLAX2$aic,fitREM_TLAX3$aic)
colnames(AIC_REM_TLAX)<-c("1 lag","2 lags", "3 lags")
# GDP - TLAX
GDP_TLAX_v<-as.vector(GDP_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
GDP_TLAX_v2<-cbind(GDP_TLAX_v,CV_TLAX_v)
colnames(GDP_TLAX_v2)<-c("GDP_TLAX","CV_TLAX")
a<- lag(GDP_TLAX_v,0)
x<- lag(GDP_TLAX_v,1)
y<- lag(GDP_TLAX_v,2)
z<- lag(GDP_TLAX_v,3)
GDP_TLAX_lags <- cbind(x,y,z)

fitGDP_TLAX1 <- auto.arima(GDP_TLAX_v2[4: 63,2], xreg=GDP_TLAX_lags[4: 63,1], d=0)
fitGDP_TLAX2 <- auto.arima(GDP_TLAX_v2[4: 63,2], xreg=GDP_TLAX_lags[4: 63,1:2], d=0)
fitGDP_TLAX3 <- auto.arima(GDP_TLAX_v2[4: 63,2], xreg=GDP_TLAX_lags[4: 63,1:3], d=0)
AIC_GDP_TLAX <- cbind(fitGDP_TLAX1$aic,fitGDP_TLAX2$aic,fitGDP_TLAX3$aic)
colnames(AIC_GDP_TLAX)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - TLAX
INPC_SUB_TLAX_v<-as.vector(INPC_SUB_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
INPC_SUB_TLAX_v2<-cbind(INPC_SUB_TLAX_v,CV_TLAX_v)
colnames(INPC_SUB_TLAX_v2)<-c("INPC_SUB_TLAX","CV_TLAX")
a<- lag(INPC_SUB_TLAX_v,0)
x<- lag(INPC_SUB_TLAX_v,1)
y<- lag(INPC_SUB_TLAX_v,2)
z<- lag(INPC_SUB_TLAX_v,3)
INPC_SUB_TLAX_lags <- cbind(x,y,z)

fitINPC_SUB_TLAX1 <- auto.arima(INPC_SUB_TLAX_v2[4: 63,2], xreg=INPC_SUB_TLAX_lags[4: 63,1], d=0)
fitINPC_SUB_TLAX2 <- auto.arima(INPC_SUB_TLAX_v2[4: 63,2], xreg=INPC_SUB_TLAX_lags[4: 63,1:2], d=0)
fitINPC_SUB_TLAX3 <- auto.arima(INPC_SUB_TLAX_v2[4: 63,2], xreg=INPC_SUB_TLAX_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_TLAX <- cbind(fitINPC_SUB_TLAX1$aic,fitINPC_SUB_TLAX2$aic,fitINPC_SUB_TLAX3$aic)
colnames(AIC_INPC_SUB_TLAX)<-c("1 lag","2 lags", "3 lags")
# INPC_E - TLAX
INPC_E_TLAX_v<-as.vector(INPC_E_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
INPC_E_TLAX_v2<-cbind(INPC_E_TLAX_v,CV_TLAX_v)
colnames(INPC_E_TLAX_v2)<-c("INPC_E_TLAX","CV_TLAX")
a<- lag(INPC_E_TLAX_v,0)
x<- lag(INPC_E_TLAX_v,1)
y<- lag(INPC_E_TLAX_v,2)
z<- lag(INPC_E_TLAX_v,3)
INPC_E_TLAX_lags <- cbind(x,y,z)

fitINPC_E_TLAX1 <- auto.arima(INPC_E_TLAX_v2[4: 63,2], xreg=INPC_E_TLAX_lags[4: 63,1], d=0)
fitINPC_E_TLAX2 <- auto.arima(INPC_E_TLAX_v2[4: 63,2], xreg=INPC_E_TLAX_lags[4: 63,1:2], d=0)
fitINPC_E_TLAX3 <- auto.arima(INPC_E_TLAX_v2[4: 63,2], xreg=INPC_E_TLAX_lags[4: 63,1:3], d=0)
AIC_INPC_E_TLAX <- cbind(fitINPC_E_TLAX1$aic,fitINPC_E_TLAX2$aic,fitINPC_E_TLAX3$aic)
colnames(AIC_INPC_E_TLAX)<-c("1 lag","2 lags", "3 lags")
# M1 - TLAX
M1_TLAX_v<-as.vector(M1_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
M1_TLAX_v2<-cbind(M1_TLAX_v,CV_TLAX_v)
colnames(M1_TLAX_v2)<-c("M1_TLAX","CV_TLAX")
a<- lag(M1_TLAX_v,0)
x<- lag(M1_TLAX_v,1)
y<- lag(M1_TLAX_v,2)
z<- lag(M1_TLAX_v,3)
M1_TLAX_lags <- cbind(x,y,z)

fitM1_TLAX1 <- auto.arima(M1_TLAX_v2[4: 63,2], xreg=M1_TLAX_lags[4: 63,1], d=0)
fitM1_TLAX2 <- auto.arima(M1_TLAX_v2[4: 63,2], xreg=M1_TLAX_lags[4: 63,1:2], d=0)
fitM1_TLAX3 <- auto.arima(M1_TLAX_v2[4: 63,2], xreg=M1_TLAX_lags[4: 63,1:3], d=0)
AIC_M1_TLAX <- cbind(fitM1_TLAX1$aic,fitM1_TLAX2$aic,fitM1_TLAX3$aic)
colnames(AIC_M1_TLAX)<-c("1 lag","2 lags", "3 lags")
# CONF - TLAX
CONF_TLAX_v<-as.vector(CONF_TLAX)
CV_TLAX_v<-as.vector(CV_TLAX)
CONF_TLAX_v2<-cbind(CONF_TLAX_v,CV_TLAX_v)
colnames(CONF_TLAX_v2)<-c("CONF_TLAX","CV_TLAX")
a<- lag(CONF_TLAX_v,0)
x<- lag(CONF_TLAX_v,1)
y<- lag(CONF_TLAX_v,2)
z<- lag(CONF_TLAX_v,3)
CONF_TLAX_lags <- cbind(x,y,z)

fitCONF_TLAX1 <- auto.arima(CONF_TLAX_v2[4: 63,2], xreg=CONF_TLAX_lags[4: 63,1], d=0)
fitCONF_TLAX2 <- auto.arima(CONF_TLAX_v2[4: 63,2], xreg=CONF_TLAX_lags[4: 63,1:2], d=0)
fitCONF_TLAX3 <- auto.arima(CONF_TLAX_v2[4: 63,2], xreg=CONF_TLAX_lags[4: 63,1:3], d=0)
AIC_CONF_TLAX <- cbind(fitCONF_TLAX1$aic,fitCONF_TLAX2$aic,fitCONF_TLAX3$aic)
colnames(AIC_CONF_TLAX)<-c("1 lag","2 lags", "3 lags")

AICs_TLAX<-rbind(AIC_IPV_TLAX,AIC_UNEMP_TLAX,AIC_REM_TLAX,AIC_GDP_TLAX,AIC_INPC_SUB_TLAX,AIC_INPC_E_TLAX,AIC_M1_TLAX,AIC_CONF_TLAX)
rownames(AICs_TLAX)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_TLAX
```

```{r}
# VER
# IPV - VER
IPV_VER_v<-as.vector(IPV_VER)
CV_VER_v<-as.vector(CV_VER)
IPV_VER_v2<-cbind(IPV_VER_v,CV_VER_v)
colnames(IPV_VER_v2)<-c("IPV_VER","CV_VER")
a<- lag(IPV_VER_v,0)
x<- lag(IPV_VER_v,1)
y<- lag(IPV_VER_v,2)
z<- lag(IPV_VER_v,3)
IPV_VER_lags <- cbind(x,y,z)

fitIPV_VER1 <- auto.arima(IPV_VER_v2[4: 63,2], xreg=IPV_VER_lags[4: 63,1], d=0)
fitIPV_VER2 <- auto.arima(IPV_VER_v2[4: 63,2], xreg=IPV_VER_lags[4: 63,1:2], d=0)
fitIPV_VER3 <- auto.arima(IPV_VER_v2[4: 63,2], xreg=IPV_VER_lags[4: 63,1:3], d=0)
AIC_IPV_VER <- cbind(fitIPV_VER1$aic,fitIPV_VER2$aic,fitIPV_VER3$aic)
colnames(AIC_IPV_VER)<-c("1 lag","2 lags", "3 lags")
# UNEMP - VER
UNEMP_VER_v<-as.vector(UNEMP_VER)
CV_VER_v<-as.vector(CV_VER)
UNEMP_VER_v2<-cbind(UNEMP_VER_v,CV_VER_v)
colnames(UNEMP_VER_v2)<-c("UNEMP_VER","CV_VER")
a<- lag(UNEMP_VER_v,0)
x<- lag(UNEMP_VER_v,1)
y<- lag(UNEMP_VER_v,2)
z<- lag(UNEMP_VER_v,3)
UNEMP_VER_lags <- cbind(x,y,z)

fitUNEMP_VER1 <- auto.arima(UNEMP_VER_v2[4: 63,2], xreg=UNEMP_VER_lags[4: 63,1], d=0)
fitUNEMP_VER2 <- auto.arima(UNEMP_VER_v2[4: 63,2], xreg=UNEMP_VER_lags[4: 63,1:2], d=0)
fitUNEMP_VER3 <- auto.arima(UNEMP_VER_v2[4: 63,2], xreg=UNEMP_VER_lags[4: 63,1:3], d=0)
AIC_UNEMP_VER <- cbind(fitUNEMP_VER1$aic,fitUNEMP_VER2$aic,fitUNEMP_VER3$aic)
colnames(AIC_UNEMP_VER)<-c("1 lag","2 lags", "3 lags")
# REM - VER
REM_VER_v<-as.vector(REM_VER)
CV_VER_v<-as.vector(CV_VER)
REM_VER_v2<-cbind(REM_VER_v,CV_VER_v)
colnames(REM_VER_v2)<-c("REM_VER","CV_VER")
a<- lag(REM_VER_v,0)
x<- lag(REM_VER_v,1)
y<- lag(REM_VER_v,2)
z<- lag(REM_VER_v,3)
REM_VER_lags <- cbind(x,y,z)

fitREM_VER1 <- auto.arima(REM_VER_v2[4: 63,2], xreg=REM_VER_lags[4: 63,1], d=0)
fitREM_VER2 <- auto.arima(REM_VER_v2[4: 63,2], xreg=REM_VER_lags[4: 63,1:2], d=0)
fitREM_VER3 <- auto.arima(REM_VER_v2[4: 63,2], xreg=REM_VER_lags[4: 63,1:3], d=0)
AIC_REM_VER <- cbind(fitREM_VER1$aic,fitREM_VER2$aic,fitREM_VER3$aic)
colnames(AIC_REM_VER)<-c("1 lag","2 lags", "3 lags")
# GDP - VER
GDP_VER_v<-as.vector(GDP_VER)
CV_VER_v<-as.vector(CV_VER)
GDP_VER_v2<-cbind(GDP_VER_v,CV_VER_v)
colnames(GDP_VER_v2)<-c("GDP_VER","CV_VER")
a<- lag(GDP_VER_v,0)
x<- lag(GDP_VER_v,1)
y<- lag(GDP_VER_v,2)
z<- lag(GDP_VER_v,3)
GDP_VER_lags <- cbind(x,y,z)

fitGDP_VER1 <- auto.arima(GDP_VER_v2[4: 63,2], xreg=GDP_VER_lags[4: 63,1], d=0)
fitGDP_VER2 <- auto.arima(GDP_VER_v2[4: 63,2], xreg=GDP_VER_lags[4: 63,1:2], d=0)
fitGDP_VER3 <- auto.arima(GDP_VER_v2[4: 63,2], xreg=GDP_VER_lags[4: 63,1:3], d=0)
AIC_GDP_VER <- cbind(fitGDP_VER1$aic,fitGDP_VER2$aic,fitGDP_VER3$aic)
colnames(AIC_GDP_VER)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - VER
INPC_SUB_VER_v<-as.vector(INPC_SUB_VER)
CV_VER_v<-as.vector(CV_VER)
INPC_SUB_VER_v2<-cbind(INPC_SUB_VER_v,CV_VER_v)
colnames(INPC_SUB_VER_v2)<-c("INPC_SUB_VER","CV_VER")
a<- lag(INPC_SUB_VER_v,0)
x<- lag(INPC_SUB_VER_v,1)
y<- lag(INPC_SUB_VER_v,2)
z<- lag(INPC_SUB_VER_v,3)
INPC_SUB_VER_lags <- cbind(x,y,z)

fitINPC_SUB_VER1 <- auto.arima(INPC_SUB_VER_v2[4: 63,2], xreg=INPC_SUB_VER_lags[4: 63,1], d=0)
fitINPC_SUB_VER2 <- auto.arima(INPC_SUB_VER_v2[4: 63,2], xreg=INPC_SUB_VER_lags[4: 63,1:2], d=0)
fitINPC_SUB_VER3 <- auto.arima(INPC_SUB_VER_v2[4: 63,2], xreg=INPC_SUB_VER_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_VER <- cbind(fitINPC_SUB_VER1$aic,fitINPC_SUB_VER2$aic,fitINPC_SUB_VER3$aic)
colnames(AIC_INPC_SUB_VER)<-c("1 lag","2 lags", "3 lags")
# INPC_E - VER
INPC_E_VER_v<-as.vector(INPC_E_VER)
CV_VER_v<-as.vector(CV_VER)
INPC_E_VER_v2<-cbind(INPC_E_VER_v,CV_VER_v)
colnames(INPC_E_VER_v2)<-c("INPC_E_VER","CV_VER")
a<- lag(INPC_E_VER_v,0)
x<- lag(INPC_E_VER_v,1)
y<- lag(INPC_E_VER_v,2)
z<- lag(INPC_E_VER_v,3)
INPC_E_VER_lags <- cbind(x,y,z)

fitINPC_E_VER1 <- auto.arima(INPC_E_VER_v2[4: 63,2], xreg=INPC_E_VER_lags[4: 63,1], d=0)
fitINPC_E_VER2 <- auto.arima(INPC_E_VER_v2[4: 63,2], xreg=INPC_E_VER_lags[4: 63,1:2], d=0)
fitINPC_E_VER3 <- auto.arima(INPC_E_VER_v2[4: 63,2], xreg=INPC_E_VER_lags[4: 63,1:3], d=0)
AIC_INPC_E_VER <- cbind(fitINPC_E_VER1$aic,fitINPC_E_VER2$aic,fitINPC_E_VER3$aic)
colnames(AIC_INPC_E_VER)<-c("1 lag","2 lags", "3 lags")
# M1 - VER
M1_VER_v<-as.vector(M1_VER)
CV_VER_v<-as.vector(CV_VER)
M1_VER_v2<-cbind(M1_VER_v,CV_VER_v)
colnames(M1_VER_v2)<-c("M1_VER","CV_VER")
a<- lag(M1_VER_v,0)
x<- lag(M1_VER_v,1)
y<- lag(M1_VER_v,2)
z<- lag(M1_VER_v,3)
M1_VER_lags <- cbind(x,y,z)

fitM1_VER1 <- auto.arima(M1_VER_v2[4: 63,2], xreg=M1_VER_lags[4: 63,1], d=0)
fitM1_VER2 <- auto.arima(M1_VER_v2[4: 63,2], xreg=M1_VER_lags[4: 63,1:2], d=0)
fitM1_VER3 <- auto.arima(M1_VER_v2[4: 63,2], xreg=M1_VER_lags[4: 63,1:3], d=0)
AIC_M1_VER <- cbind(fitM1_VER1$aic,fitM1_VER2$aic,fitM1_VER3$aic)
colnames(AIC_M1_VER)<-c("1 lag","2 lags", "3 lags")
# CONF - VER
CONF_VER_v<-as.vector(CONF_VER)
CV_VER_v<-as.vector(CV_VER)
CONF_VER_v2<-cbind(CONF_VER_v,CV_VER_v)
colnames(CONF_VER_v2)<-c("CONF_VER","CV_VER")
a<- lag(CONF_VER_v,0)
x<- lag(CONF_VER_v,1)
y<- lag(CONF_VER_v,2)
z<- lag(CONF_VER_v,3)
CONF_VER_lags <- cbind(x,y,z)

fitCONF_VER1 <- auto.arima(CONF_VER_v2[4: 63,2], xreg=CONF_VER_lags[4: 63,1], d=0)
fitCONF_VER2 <- auto.arima(CONF_VER_v2[4: 63,2], xreg=CONF_VER_lags[4: 63,1:2], d=0)
fitCONF_VER3 <- auto.arima(CONF_VER_v2[4: 63,2], xreg=CONF_VER_lags[4: 63,1:3], d=0)
AIC_CONF_VER <- cbind(fitCONF_VER1$aic,fitCONF_VER2$aic,fitCONF_VER3$aic)
colnames(AIC_CONF_VER)<-c("1 lag","2 lags", "3 lags")

AICs_VER<-rbind(AIC_IPV_VER,AIC_UNEMP_VER,AIC_REM_VER,AIC_GDP_VER,AIC_INPC_SUB_VER,AIC_INPC_E_VER,AIC_M1_VER,AIC_CONF_VER)
rownames(AICs_VER)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_VER
```

```{r}
# YUC
# IPV - YUC
IPV_YUC_v<-as.vector(IPV_YUC)
CV_YUC_v<-as.vector(CV_YUC)
IPV_YUC_v2<-cbind(IPV_YUC_v,CV_YUC_v)
colnames(IPV_YUC_v2)<-c("IPV_YUC","CV_YUC")
a<- lag(IPV_YUC_v,0)
x<- lag(IPV_YUC_v,1)
y<- lag(IPV_YUC_v,2)
z<- lag(IPV_YUC_v,3)
IPV_YUC_lags <- cbind(x,y,z)

fitIPV_YUC1 <- auto.arima(IPV_YUC_v2[4: 63,2], xreg=IPV_YUC_lags[4: 63,1], d=0)
fitIPV_YUC2 <- auto.arima(IPV_YUC_v2[4: 63,2], xreg=IPV_YUC_lags[4: 63,1:2], d=0)
fitIPV_YUC3 <- auto.arima(IPV_YUC_v2[4: 63,2], xreg=IPV_YUC_lags[4: 63,1:3], d=0)
AIC_IPV_YUC <- cbind(fitIPV_YUC1$aic,fitIPV_YUC2$aic,fitIPV_YUC3$aic)
colnames(AIC_IPV_YUC)<-c("1 lag","2 lags", "3 lags")
# UNEMP - YUC
UNEMP_YUC_v<-as.vector(UNEMP_YUC)
CV_YUC_v<-as.vector(CV_YUC)
UNEMP_YUC_v2<-cbind(UNEMP_YUC_v,CV_YUC_v)
colnames(UNEMP_YUC_v2)<-c("UNEMP_YUC","CV_YUC")
a<- lag(UNEMP_YUC_v,0)
x<- lag(UNEMP_YUC_v,1)
y<- lag(UNEMP_YUC_v,2)
z<- lag(UNEMP_YUC_v,3)
UNEMP_YUC_lags <- cbind(x,y,z)

fitUNEMP_YUC1 <- auto.arima(UNEMP_YUC_v2[4: 63,2], xreg=UNEMP_YUC_lags[4: 63,1], d=0)
fitUNEMP_YUC2 <- auto.arima(UNEMP_YUC_v2[4: 63,2], xreg=UNEMP_YUC_lags[4: 63,1:2], d=0)
fitUNEMP_YUC3 <- auto.arima(UNEMP_YUC_v2[4: 63,2], xreg=UNEMP_YUC_lags[4: 63,1:3], d=0)
AIC_UNEMP_YUC <- cbind(fitUNEMP_YUC1$aic,fitUNEMP_YUC2$aic,fitUNEMP_YUC3$aic)
colnames(AIC_UNEMP_YUC)<-c("1 lag","2 lags", "3 lags")
# REM - YUC
REM_YUC_v<-as.vector(REM_YUC)
CV_YUC_v<-as.vector(CV_YUC)
REM_YUC_v2<-cbind(REM_YUC_v,CV_YUC_v)
colnames(REM_YUC_v2)<-c("REM_YUC","CV_YUC")
a<- lag(REM_YUC_v,0)
x<- lag(REM_YUC_v,1)
y<- lag(REM_YUC_v,2)
z<- lag(REM_YUC_v,3)
REM_YUC_lags <- cbind(x,y,z)

fitREM_YUC1 <- auto.arima(REM_YUC_v2[4: 63,2], xreg=REM_YUC_lags[4: 63,1], d=0)
fitREM_YUC2 <- auto.arima(REM_YUC_v2[4: 63,2], xreg=REM_YUC_lags[4: 63,1:2], d=0)
fitREM_YUC3 <- auto.arima(REM_YUC_v2[4: 63,2], xreg=REM_YUC_lags[4: 63,1:3], d=0)
AIC_REM_YUC <- cbind(fitREM_YUC1$aic,fitREM_YUC2$aic,fitREM_YUC3$aic)
colnames(AIC_REM_YUC)<-c("1 lag","2 lags", "3 lags")
# GDP - YUC
GDP_YUC_v<-as.vector(GDP_YUC)
CV_YUC_v<-as.vector(CV_YUC)
GDP_YUC_v2<-cbind(GDP_YUC_v,CV_YUC_v)
colnames(GDP_YUC_v2)<-c("GDP_YUC","CV_YUC")
a<- lag(GDP_YUC_v,0)
x<- lag(GDP_YUC_v,1)
y<- lag(GDP_YUC_v,2)
z<- lag(GDP_YUC_v,3)
GDP_YUC_lags <- cbind(x,y,z)

fitGDP_YUC1 <- auto.arima(GDP_YUC_v2[4: 63,2], xreg=GDP_YUC_lags[4: 63,1], d=0)
fitGDP_YUC2 <- auto.arima(GDP_YUC_v2[4: 63,2], xreg=GDP_YUC_lags[4: 63,1:2], d=0)
fitGDP_YUC3 <- auto.arima(GDP_YUC_v2[4: 63,2], xreg=GDP_YUC_lags[4: 63,1:3], d=0)
AIC_GDP_YUC <- cbind(fitGDP_YUC1$aic,fitGDP_YUC2$aic,fitGDP_YUC3$aic)
colnames(AIC_GDP_YUC)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - YUC
INPC_SUB_YUC_v<-as.vector(INPC_SUB_YUC)
CV_YUC_v<-as.vector(CV_YUC)
INPC_SUB_YUC_v2<-cbind(INPC_SUB_YUC_v,CV_YUC_v)
colnames(INPC_SUB_YUC_v2)<-c("INPC_SUB_YUC","CV_YUC")
a<- lag(INPC_SUB_YUC_v,0)
x<- lag(INPC_SUB_YUC_v,1)
y<- lag(INPC_SUB_YUC_v,2)
z<- lag(INPC_SUB_YUC_v,3)
INPC_SUB_YUC_lags <- cbind(x,y,z)

fitINPC_SUB_YUC1 <- auto.arima(INPC_SUB_YUC_v2[4: 63,2], xreg=INPC_SUB_YUC_lags[4: 63,1], d=0)
fitINPC_SUB_YUC2 <- auto.arima(INPC_SUB_YUC_v2[4: 63,2], xreg=INPC_SUB_YUC_lags[4: 63,1:2], d=0)
fitINPC_SUB_YUC3 <- auto.arima(INPC_SUB_YUC_v2[4: 63,2], xreg=INPC_SUB_YUC_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_YUC <- cbind(fitINPC_SUB_YUC1$aic,fitINPC_SUB_YUC2$aic,fitINPC_SUB_YUC3$aic)
colnames(AIC_INPC_SUB_YUC)<-c("1 lag","2 lags", "3 lags")
# INPC_E - YUC
INPC_E_YUC_v<-as.vector(INPC_E_YUC)
CV_YUC_v<-as.vector(CV_YUC)
INPC_E_YUC_v2<-cbind(INPC_E_YUC_v,CV_YUC_v)
colnames(INPC_E_YUC_v2)<-c("INPC_E_YUC","CV_YUC")
a<- lag(INPC_E_YUC_v,0)
x<- lag(INPC_E_YUC_v,1)
y<- lag(INPC_E_YUC_v,2)
z<- lag(INPC_E_YUC_v,3)
INPC_E_YUC_lags <- cbind(x,y,z)

fitINPC_E_YUC1 <- auto.arima(INPC_E_YUC_v2[4: 63,2], xreg=INPC_E_YUC_lags[4: 63,1], d=0)
fitINPC_E_YUC2 <- auto.arima(INPC_E_YUC_v2[4: 63,2], xreg=INPC_E_YUC_lags[4: 63,1:2], d=0)
fitINPC_E_YUC3 <- auto.arima(INPC_E_YUC_v2[4: 63,2], xreg=INPC_E_YUC_lags[4: 63,1:3], d=0)
AIC_INPC_E_YUC <- cbind(fitINPC_E_YUC1$aic,fitINPC_E_YUC2$aic,fitINPC_E_YUC3$aic)
colnames(AIC_INPC_E_YUC)<-c("1 lag","2 lags", "3 lags")
# M1 - YUC
M1_YUC_v<-as.vector(M1_YUC)
CV_YUC_v<-as.vector(CV_YUC)
M1_YUC_v2<-cbind(M1_YUC_v,CV_YUC_v)
colnames(M1_YUC_v2)<-c("M1_YUC","CV_YUC")
a<- lag(M1_YUC_v,0)
x<- lag(M1_YUC_v,1)
y<- lag(M1_YUC_v,2)
z<- lag(M1_YUC_v,3)
M1_YUC_lags <- cbind(x,y,z)

fitM1_YUC1 <- auto.arima(M1_YUC_v2[4: 63,2], xreg=M1_YUC_lags[4: 63,1], d=0)
fitM1_YUC2 <- auto.arima(M1_YUC_v2[4: 63,2], xreg=M1_YUC_lags[4: 63,1:2], d=0)
fitM1_YUC3 <- auto.arima(M1_YUC_v2[4: 63,2], xreg=M1_YUC_lags[4: 63,1:3], d=0)
AIC_M1_YUC <- cbind(fitM1_YUC1$aic,fitM1_YUC2$aic,fitM1_YUC3$aic)
colnames(AIC_M1_YUC)<-c("1 lag","2 lags", "3 lags")
# CONF - YUC
CONF_YUC_v<-as.vector(CONF_YUC)
CV_YUC_v<-as.vector(CV_YUC)
CONF_YUC_v2<-cbind(CONF_YUC_v,CV_YUC_v)
colnames(CONF_YUC_v2)<-c("CONF_YUC","CV_YUC")
a<- lag(CONF_YUC_v,0)
x<- lag(CONF_YUC_v,1)
y<- lag(CONF_YUC_v,2)
z<- lag(CONF_YUC_v,3)
CONF_YUC_lags <- cbind(x,y,z)

fitCONF_YUC1 <- auto.arima(CONF_YUC_v2[4: 63,2], xreg=CONF_YUC_lags[4: 63,1], d=0)
fitCONF_YUC2 <- auto.arima(CONF_YUC_v2[4: 63,2], xreg=CONF_YUC_lags[4: 63,1:2], d=0)
fitCONF_YUC3 <- auto.arima(CONF_YUC_v2[4: 63,2], xreg=CONF_YUC_lags[4: 63,1:3], d=0)
AIC_CONF_YUC <- cbind(fitCONF_YUC1$aic,fitCONF_YUC2$aic,fitCONF_YUC3$aic)
colnames(AIC_CONF_YUC)<-c("1 lag","2 lags", "3 lags")

AICs_YUC<-rbind(AIC_IPV_YUC,AIC_UNEMP_YUC,AIC_REM_YUC,AIC_GDP_YUC,AIC_INPC_SUB_YUC,AIC_INPC_E_YUC,AIC_M1_YUC,AIC_CONF_YUC)
rownames(AICs_YUC)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_YUC
```

```{r}
# ZAC
# IPV - ZAC
IPV_ZAC_v<-as.vector(IPV_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
IPV_ZAC_v2<-cbind(IPV_ZAC_v,CV_ZAC_v)
colnames(IPV_ZAC_v2)<-c("IPV_ZAC","CV_ZAC")
a<- lag(IPV_ZAC_v,0)
x<- lag(IPV_ZAC_v,1)
y<- lag(IPV_ZAC_v,2)
z<- lag(IPV_ZAC_v,3)
IPV_ZAC_lags <- cbind(x,y,z)

fitIPV_ZAC1 <- auto.arima(IPV_ZAC_v2[4: 63,2], xreg=IPV_ZAC_lags[4: 63,1], d=0)
fitIPV_ZAC2 <- auto.arima(IPV_ZAC_v2[4: 63,2], xreg=IPV_ZAC_lags[4: 63,1:2], d=0)
fitIPV_ZAC3 <- auto.arima(IPV_ZAC_v2[4: 63,2], xreg=IPV_ZAC_lags[4: 63,1:3], d=0)
AIC_IPV_ZAC <- cbind(fitIPV_ZAC1$aic,fitIPV_ZAC2$aic,fitIPV_ZAC3$aic)
colnames(AIC_IPV_ZAC)<-c("1 lag","2 lags", "3 lags")
# UNEMP - ZAC
UNEMP_ZAC_v<-as.vector(UNEMP_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
UNEMP_ZAC_v2<-cbind(UNEMP_ZAC_v,CV_ZAC_v)
colnames(UNEMP_ZAC_v2)<-c("UNEMP_ZAC","CV_ZAC")
a<- lag(UNEMP_ZAC_v,0)
x<- lag(UNEMP_ZAC_v,1)
y<- lag(UNEMP_ZAC_v,2)
z<- lag(UNEMP_ZAC_v,3)
UNEMP_ZAC_lags <- cbind(x,y,z)

fitUNEMP_ZAC1 <- auto.arima(UNEMP_ZAC_v2[4: 63,2], xreg=UNEMP_ZAC_lags[4: 63,1], d=0)
fitUNEMP_ZAC2 <- auto.arima(UNEMP_ZAC_v2[4: 63,2], xreg=UNEMP_ZAC_lags[4: 63,1:2], d=0)
fitUNEMP_ZAC3 <- auto.arima(UNEMP_ZAC_v2[4: 63,2], xreg=UNEMP_ZAC_lags[4: 63,1:3], d=0)
AIC_UNEMP_ZAC <- cbind(fitUNEMP_ZAC1$aic,fitUNEMP_ZAC2$aic,fitUNEMP_ZAC3$aic)
colnames(AIC_UNEMP_ZAC)<-c("1 lag","2 lags", "3 lags")
# REM - ZAC
REM_ZAC_v<-as.vector(REM_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
REM_ZAC_v2<-cbind(REM_ZAC_v,CV_ZAC_v)
colnames(REM_ZAC_v2)<-c("REM_ZAC","CV_ZAC")
a<- lag(REM_ZAC_v,0)
x<- lag(REM_ZAC_v,1)
y<- lag(REM_ZAC_v,2)
z<- lag(REM_ZAC_v,3)
REM_ZAC_lags <- cbind(x,y,z)

fitREM_ZAC1 <- auto.arima(REM_ZAC_v2[4: 63,2], xreg=REM_ZAC_lags[4: 63,1], d=0)
fitREM_ZAC2 <- auto.arima(REM_ZAC_v2[4: 63,2], xreg=REM_ZAC_lags[4: 63,1:2], d=0)
fitREM_ZAC3 <- auto.arima(REM_ZAC_v2[4: 63,2], xreg=REM_ZAC_lags[4: 63,1:3], d=0)
AIC_REM_ZAC <- cbind(fitREM_ZAC1$aic,fitREM_ZAC2$aic,fitREM_ZAC3$aic)
colnames(AIC_REM_ZAC)<-c("1 lag","2 lags", "3 lags")
# GDP - ZAC
GDP_ZAC_v<-as.vector(GDP_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
GDP_ZAC_v2<-cbind(GDP_ZAC_v,CV_ZAC_v)
colnames(GDP_ZAC_v2)<-c("GDP_ZAC","CV_ZAC")
a<- lag(GDP_ZAC_v,0)
x<- lag(GDP_ZAC_v,1)
y<- lag(GDP_ZAC_v,2)
z<- lag(GDP_ZAC_v,3)
GDP_ZAC_lags <- cbind(x,y,z)

fitGDP_ZAC1 <- auto.arima(GDP_ZAC_v2[4: 63,2], xreg=GDP_ZAC_lags[4: 63,1], d=0)
fitGDP_ZAC2 <- auto.arima(GDP_ZAC_v2[4: 63,2], xreg=GDP_ZAC_lags[4: 63,1:2], d=0)
fitGDP_ZAC3 <- auto.arima(GDP_ZAC_v2[4: 63,2], xreg=GDP_ZAC_lags[4: 63,1:3], d=0)
AIC_GDP_ZAC <- cbind(fitGDP_ZAC1$aic,fitGDP_ZAC2$aic,fitGDP_ZAC3$aic)
colnames(AIC_GDP_ZAC)<-c("1 lag","2 lags", "3 lags")
# INPC_SUB - ZAC
INPC_SUB_ZAC_v<-as.vector(INPC_SUB_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
INPC_SUB_ZAC_v2<-cbind(INPC_SUB_ZAC_v,CV_ZAC_v)
colnames(INPC_SUB_ZAC_v2)<-c("INPC_SUB_ZAC","CV_ZAC")
a<- lag(INPC_SUB_ZAC_v,0)
x<- lag(INPC_SUB_ZAC_v,1)
y<- lag(INPC_SUB_ZAC_v,2)
z<- lag(INPC_SUB_ZAC_v,3)
INPC_SUB_ZAC_lags <- cbind(x,y,z)

fitINPC_SUB_ZAC1 <- auto.arima(INPC_SUB_ZAC_v2[4: 63,2], xreg=INPC_SUB_ZAC_lags[4: 63,1], d=0)
fitINPC_SUB_ZAC2 <- auto.arima(INPC_SUB_ZAC_v2[4: 63,2], xreg=INPC_SUB_ZAC_lags[4: 63,1:2], d=0)
fitINPC_SUB_ZAC3 <- auto.arima(INPC_SUB_ZAC_v2[4: 63,2], xreg=INPC_SUB_ZAC_lags[4: 63,1:3], d=0)
AIC_INPC_SUB_ZAC <- cbind(fitINPC_SUB_ZAC1$aic,fitINPC_SUB_ZAC2$aic,fitINPC_SUB_ZAC3$aic)
colnames(AIC_INPC_SUB_ZAC)<-c("1 lag","2 lags", "3 lags")
# INPC_E - ZAC
INPC_E_ZAC_v<-as.vector(INPC_E_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
INPC_E_ZAC_v2<-cbind(INPC_E_ZAC_v,CV_ZAC_v)
colnames(INPC_E_ZAC_v2)<-c("INPC_E_ZAC","CV_ZAC")
a<- lag(INPC_E_ZAC_v,0)
x<- lag(INPC_E_ZAC_v,1)
y<- lag(INPC_E_ZAC_v,2)
z<- lag(INPC_E_ZAC_v,3)
INPC_E_ZAC_lags <- cbind(x,y,z)

fitINPC_E_ZAC1 <- auto.arima(INPC_E_ZAC_v2[4: 63,2], xreg=INPC_E_ZAC_lags[4: 63,1], d=0)
fitINPC_E_ZAC2 <- auto.arima(INPC_E_ZAC_v2[4: 63,2], xreg=INPC_E_ZAC_lags[4: 63,1:2], d=0)
fitINPC_E_ZAC3 <- auto.arima(INPC_E_ZAC_v2[4: 63,2], xreg=INPC_E_ZAC_lags[4: 63,1:3], d=0)
AIC_INPC_E_ZAC <- cbind(fitINPC_E_ZAC1$aic,fitINPC_E_ZAC2$aic,fitINPC_E_ZAC3$aic)
colnames(AIC_INPC_E_ZAC)<-c("1 lag","2 lags", "3 lags")
# M1 - ZAC
M1_ZAC_v<-as.vector(M1_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
M1_ZAC_v2<-cbind(M1_ZAC_v,CV_ZAC_v)
colnames(M1_ZAC_v2)<-c("M1_ZAC","CV_ZAC")
a<- lag(M1_ZAC_v,0)
x<- lag(M1_ZAC_v,1)
y<- lag(M1_ZAC_v,2)
z<- lag(M1_ZAC_v,3)
M1_ZAC_lags <- cbind(x,y,z)

fitM1_ZAC1 <- auto.arima(M1_ZAC_v2[4: 63,2], xreg=M1_ZAC_lags[4: 63,1], d=0)
fitM1_ZAC2 <- auto.arima(M1_ZAC_v2[4: 63,2], xreg=M1_ZAC_lags[4: 63,1:2], d=0)
fitM1_ZAC3 <- auto.arima(M1_ZAC_v2[4: 63,2], xreg=M1_ZAC_lags[4: 63,1:3], d=0)
AIC_M1_ZAC <- cbind(fitM1_ZAC1$aic,fitM1_ZAC2$aic,fitM1_ZAC3$aic)
colnames(AIC_M1_ZAC)<-c("1 lag","2 lags", "3 lags")
# CONF - ZAC
CONF_ZAC_v<-as.vector(CONF_ZAC)
CV_ZAC_v<-as.vector(CV_ZAC)
CONF_ZAC_v2<-cbind(CONF_ZAC_v,CV_ZAC_v)
colnames(CONF_ZAC_v2)<-c("CONF_ZAC","CV_ZAC")
a<- lag(CONF_ZAC_v,0)
x<- lag(CONF_ZAC_v,1)
y<- lag(CONF_ZAC_v,2)
z<- lag(CONF_ZAC_v,3)
CONF_ZAC_lags <- cbind(x,y,z)

fitCONF_ZAC1 <- auto.arima(CONF_ZAC_v2[4: 63,2], xreg=CONF_ZAC_lags[4: 63,1], d=0)
fitCONF_ZAC2 <- auto.arima(CONF_ZAC_v2[4: 63,2], xreg=CONF_ZAC_lags[4: 63,1:2], d=0)
fitCONF_ZAC3 <- auto.arima(CONF_ZAC_v2[4: 63,2], xreg=CONF_ZAC_lags[4: 63,1:3], d=0)
AIC_CONF_ZAC <- cbind(fitCONF_ZAC1$aic,fitCONF_ZAC2$aic,fitCONF_ZAC3$aic)
colnames(AIC_CONF_ZAC)<-c("1 lag","2 lags", "3 lags")

AICs_ZAC<-rbind(AIC_IPV_ZAC,AIC_UNEMP_ZAC,AIC_REM_ZAC,AIC_GDP_ZAC,AIC_INPC_SUB_ZAC,AIC_INPC_E_ZAC,AIC_M1_ZAC,AIC_CONF_ZAC)
rownames(AICs_ZAC)<-c("IPV", "DESEMPLEO", "REMESAS","PIB","INPC_SUB","INPC_E", "M1", "CONF")
AICs_ZAC
```

# MODELOS ESTATALES
```{r}
AGS_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 1)), start=c(2005,2), end=c(2020,4),  frequency=4)
BC_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 2)), start=c(2005,2), end=c(2020,4),   frequency=4)
BCS_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 3)), start=c(2005,2), end=c(2020,4),   frequency=4)
CAMP_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 4)), start=c(2005,2), end=c(2020,4),   frequency=4)
CDMX_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 5)), start=c(2005,2), end=c(2020,4),   frequency=4)
CHIH_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 6)), start=c(2005,2), end=c(2020,4),   frequency=4)
CHIS_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 7)), start=c(2005,2), end=c(2020,4),   frequency=4)
COAH_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 8)), start=c(2005,2), end=c(2020,4),   frequency=4)
COL_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 9)), start=c(2005,2), end=c(2020,4),   frequency=4)
DGO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 10)), start=c(2005,2), end=c(2020,4),   frequency=4)
GRO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 11)), start=c(2005,2), end=c(2020,4),   frequency=4)
GTO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 12)), start=c(2005,2), end=c(2020,4),   frequency=4)
HGO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 13)), start=c(2005,2), end=c(2020,4),   frequency=4)
JAL_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 14)), start=c(2005,2), end=c(2020,4),   frequency=4)
MEX_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 15)), start=c(2005,2), end=c(2020,4),   frequency=4)
MICH_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 16)), start=c(2005,2), end=c(2020,4),   frequency=4)
MOR_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 17)), start=c(2005,2), end=c(2020,4),   frequency=4)
NAY_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 18)), start=c(2005,2), end=c(2020,4),   frequency=4)
NL_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 19)), start=c(2005,2),  end=c(2020,4),  frequency=4)
OAXACA_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 20)), start=c(2005,2), end=c(2020,4),   frequency=4)
PUE_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 21)), start=c(2005,2), end=c(2020,4),   frequency=4)
Q_ROO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 22)), start=c(2005,2), end=c(2020,4),   frequency=4)
QRO_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 23)), start=c(2005,2), end=c(2020,4),   frequency=4)
SIN_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 24)), start=c(2005,2), end=c(2020,4),   frequency=4)
SLP_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 25)), start=c(2005,2), end=c(2020,4),   frequency=4)
SON_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 26)), start=c(2005,2), end=c(2020,4),   frequency=4)
TAB_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 27)), start=c(2005,2), end=c(2020,4),   frequency=4)
TAMPS_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 28)), start=c(2005,2), end=c(2020,4),    frequency=4)
TLAX_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 29)), start=c(2005,2), end=c(2020,4),   frequency=4)
VER_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 30)), start=c(2005,2), end=c(2020,4),   frequency=4)
YUC_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 31)), start=c(2005,2), end=c(2020,4),   frequency=4)
ZAC_LAGS<-ts(data=(read_excel("ESTADOS LAGS.xlsx", sheet = 32)), start=c(2005,2), end=c(2020,4),   frequency=4)
```

```{r}
training_set_AGS<-ts(AGS_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_BC<-ts(BC_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_BCS<-ts(BCS_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_CAMP<-ts(CAMP_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_CDMX<-ts(CDMX_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_CHIH<-ts(CHIH_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_CHIS<-ts(CHIS_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_COAH<-ts(COAH_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_COL<-ts(COL_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_DGO<-ts(DGO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_GRO<-ts(GRO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_GTO<-ts(GTO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_HGO<-ts(HGO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_JAL<-ts(JAL_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_MEX<-ts(MEX_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_MICH<-ts(MICH_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_MOR<-ts(MOR_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_NAY<-ts(NAY_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_NL<-ts(NL_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_OAXACA<-ts(OAXACA_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_PUE<-ts(PUE_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_Q_ROO<-ts(Q_ROO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_QRO<-ts(QRO_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_SIN<-ts(SIN_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_SLP<-ts(SLP_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_SON<-ts(SON_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_TAB<-ts(TAB_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_TAMPS<-ts(TAMPS_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_TLAX<-ts(TLAX_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_VER<-ts(VER_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_YUC<-ts(YUC_LAGS[1:59,],start = c(2006,1),frequency=4)
training_set_ZAC<-ts(ZAC_LAGS[1:59,],start = c(2006,1),frequency=4)
```

```{r}
# MODELOS

# AGS

modelo_AGS <- auto.arima(training_set_AGS[,"CV"],
                         xreg=training_set_AGS[,-c(1)])
# BC

modelo_BC <- auto.arima(training_set_BC[,"CV"],
                         xreg=training_set_BC[,-c(1)])
# BCS

modelo_BCS <- auto.arima(training_set_BCS[,"CV"],
                         xreg=training_set_BCS[,-c(1)])
# CAMP

modelo_CAMP <- auto.arima(training_set_CAMP[,"CV"],
                         xreg=training_set_CAMP[,-c(1)])
# CDMX

modelo_CDMX <- auto.arima(training_set_CDMX[,"CV"],
                         xreg=training_set_CDMX[,-c(1)])
# CHIH

modelo_CHIH <- auto.arima(training_set_CHIH[,"CV"],
                         xreg=training_set_CHIH[,-c(1)])
# CHIS

modelo_CHIS <- auto.arima(training_set_CHIS[,"CV"],
                         xreg=training_set_CHIS[,-c(1)])
# COAH

modelo_COAH <- auto.arima(training_set_COAH[,"CV"],
                         xreg=training_set_COAH[,-c(1)])
# COL

modelo_COL <- auto.arima(training_set_COL[,"CV"],
                         xreg=training_set_COL[,-c(1)])
# DGO

modelo_DGO <- auto.arima(training_set_DGO[,"CV"],
                         xreg=training_set_DGO[,-c(1)])
# GRO

modelo_GRO <- auto.arima(training_set_GRO[,"CV"],
                         xreg=training_set_GRO[,-c(1)])
# GTO

modelo_GTO <- auto.arima(training_set_GTO[,"CV"],
                         xreg=training_set_GTO[,-c(1)])
# HGO

modelo_HGO <- auto.arima(training_set_HGO[,"CV"],
                         xreg=training_set_HGO[,-c(1)])
# JAL

modelo_JAL <- auto.arima(training_set_JAL[,"CV"],
                         xreg=training_set_JAL[,-c(1)])
# MEX

modelo_MEX <- auto.arima(training_set_MEX[,"CV"],
                         xreg=training_set_MEX[,-c(1)])
# MICH

modelo_MICH <- auto.arima(training_set_MICH[,"CV"],
                         xreg=training_set_MICH[,-c(1)])
# MOR

modelo_MOR <- auto.arima(training_set_MOR[,"CV"],
                         xreg=training_set_MOR[,-c(1)])
# NAY

modelo_NAY <- auto.arima(training_set_NAY[,"CV"],
                         xreg=training_set_NAY[,-c(1)])
# NL

modelo_NL <- auto.arima(training_set_NL[,"CV"],
                         xreg=training_set_NL[,-c(1)])
# OAXACA

modelo_OAXACA <- auto.arima(training_set_OAXACA[,"CV"],
                         xreg=training_set_OAXACA[,-c(1)])
# PUE

modelo_PUE <- auto.arima(training_set_PUE[,"CV"],
                         xreg=training_set_PUE[,-c(1)])
# Q_ROO

modelo_Q_ROO <- auto.arima(training_set_Q_ROO[,"CV"],
                         xreg=training_set_Q_ROO[,-c(1)])
# QRO

modelo_QRO <- auto.arima(training_set_QRO[,"CV"],
                         xreg=training_set_QRO[,-c(1)])
# SIN

modelo_SIN <- auto.arima(training_set_SIN[,"CV"],
                         xreg=training_set_SIN[,-c(1)])
# SLP

modelo_SLP <- auto.arima(training_set_SLP[,"CV"],
                         xreg=training_set_SLP[,-c(1)])
# SON

modelo_SON <- auto.arima(training_set_SON[,"CV"],
                         xreg=training_set_SON[,-c(1)])
# TAB

modelo_TAB <- auto.arima(training_set_TAB[,"CV"],
                         xreg=training_set_TAB[,-c(1)])
# TAMPS

modelo_TAMPS <- auto.arima(training_set_TAMPS[,"CV"],
                         xreg=training_set_TAMPS[,-c(1)])
# TLAX

modelo_TLAX <- auto.arima(training_set_TLAX[,"CV"],
                         xreg=training_set_TLAX[,-c(1)])
# VER

modelo_VER <- auto.arima(training_set_VER[,"CV"],
                         xreg=training_set_VER[,-c(1)])
# YUC

modelo_YUC <- auto.arima(training_set_YUC[,"CV"],
                         xreg=training_set_YUC[,-c(1)])
# ZAC

modelo_ZAC <- auto.arima(training_set_ZAC[,"CV"],
                         xreg=training_set_ZAC[,-c(1)])
```

```{r}

AIC_MODELOS_ESTATALES <- rbind(modelo_AGS$aic,modelo_BC$aic,modelo_BCS$aic,modelo_CAMP$aic,modelo_CDMX$aic,modelo_CHIH$aic,modelo_CHIS$aic,modelo_COAH$aic,modelo_COL$aic,modelo_DGO$aic,modelo_GRO$aic,modelo_GTO$aic,modelo_HGO$aic,modelo_JAL$aic,modelo_MEX$aic,modelo_MICH$aic,modelo_MOR$aic,modelo_NAY$aic,modelo_NL$aic,modelo_OAXACA$aic,modelo_PUE$aic,modelo_Q_ROO$aic,modelo_QRO$aic,modelo_SIN$aic,modelo_SLP$aic,modelo_SON$aic,modelo_TAB$aic,modelo_TAMPS$aic,modelo_TLAX$aic,modelo_VER$aic,modelo_YUC$aic,modelo_ZAC$aic)

AIC_MODELOS_ESTATALES

```
